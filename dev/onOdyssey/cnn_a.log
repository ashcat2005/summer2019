Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:229: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-20 22:28:08.432356: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-10-20 22:28:08.438000: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-10-20 22:28:08.438131: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55ea6bb8acf0 executing computations on platform Host. Devices:
2019-10-20 22:28:08.438152: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Train on 1000 samples, validate on 1000 samples
Epoch 1/25

1000/1000 [==============================] - 163s 163ms/step - loss: 1.6100 - acc: 0.1690 - val_loss: 1.5694 - val_acc: 0.2570
Epoch 2/25

1000/1000 [==============================] - 148s 148ms/step - loss: 1.5265 - acc: 0.3470 - val_loss: 1.5139 - val_acc: 0.3010
Epoch 3/25

1000/1000 [==============================] - 149s 149ms/step - loss: 1.4047 - acc: 0.5160 - val_loss: 1.4687 - val_acc: 0.2670
Epoch 4/25

1000/1000 [==============================] - 149s 149ms/step - loss: 1.2918 - acc: 0.4370 - val_loss: 1.4518 - val_acc: 0.3830
Epoch 5/25

1000/1000 [==============================] - 149s 149ms/step - loss: 1.2028 - acc: 0.5500 - val_loss: 1.4278 - val_acc: 0.4070
Epoch 6/25

1000/1000 [==============================] - 150s 150ms/step - loss: 1.1192 - acc: 0.7430 - val_loss: 1.3997 - val_acc: 0.3750
Epoch 7/25

1000/1000 [==============================] - 150s 150ms/step - loss: 1.0473 - acc: 0.6910 - val_loss: 1.4104 - val_acc: 0.3900
Epoch 8/25

1000/1000 [==============================] - 150s 150ms/step - loss: 0.9799 - acc: 0.6630 - val_loss: 1.4190 - val_acc: 0.4390
Epoch 9/25

1000/1000 [==============================] - 150s 150ms/step - loss: 0.9413 - acc: 0.7930 - val_loss: 1.4258 - val_acc: 0.3720
Epoch 10/25

1000/1000 [==============================] - 153s 153ms/step - loss: 0.8826 - acc: 0.6590 - val_loss: 1.3816 - val_acc: 0.4370
Epoch 11/25

1000/1000 [==============================] - 161s 161ms/step - loss: 0.8190 - acc: 0.7680 - val_loss: 1.4050 - val_acc: 0.4260
Epoch 12/25

1000/1000 [==============================] - 162s 162ms/step - loss: 0.7731 - acc: 0.7610 - val_loss: 1.4500 - val_acc: 0.4100
Epoch 13/25

1000/1000 [==============================] - 162s 162ms/step - loss: 0.7378 - acc: 0.7290 - val_loss: 1.4055 - val_acc: 0.4310
Epoch 14/25

1000/1000 [==============================] - 160s 160ms/step - loss: 0.6934 - acc: 0.7950 - val_loss: 1.4120 - val_acc: 0.4470
Epoch 15/25

1000/1000 [==============================] - 161s 161ms/step - loss: 0.6509 - acc: 0.7950 - val_loss: 1.4545 - val_acc: 0.4240
Epoch 16/25

1000/1000 [==============================] - 160s 160ms/step - loss: 0.6211 - acc: 0.7700 - val_loss: 1.4417 - val_acc: 0.4550
Epoch 17/25

1000/1000 [==============================] - 162s 162ms/step - loss: 0.5894 - acc: 0.8430 - val_loss: 1.4670 - val_acc: 0.4470
Epoch 18/25

1000/1000 [==============================] - 160s 160ms/step - loss: 0.5539 - acc: 0.8110 - val_loss: 1.4793 - val_acc: 0.4660
Epoch 19/25

1000/1000 [==============================] - 161s 161ms/step - loss: 0.5274 - acc: 0.8140 - val_loss: 1.4558 - val_acc: 0.4930
Epoch 20/25

1000/1000 [==============================] - 160s 160ms/step - loss: 0.5077 - acc: 0.8510 - val_loss: 1.5218 - val_acc: 0.4760
Epoch 21/25

1000/1000 [==============================] - 160s 160ms/step - loss: 0.4792 - acc: 0.8360 - val_loss: 1.5044 - val_acc: 0.4810
Epoch 22/25

1000/1000 [==============================] - 163s 163ms/step - loss: 0.4529 - acc: 0.8690 - val_loss: 1.5029 - val_acc: 0.4960
Epoch 23/25

1000/1000 [==============================] - 161s 161ms/step - loss: 0.4312 - acc: 0.8750 - val_loss: 1.5647 - val_acc: 0.4930
Epoch 24/25

1000/1000 [==============================] - 160s 160ms/step - loss: 0.4171 - acc: 0.8570 - val_loss: 1.5131 - val_acc: 0.5160
Epoch 25/25

1000/1000 [==============================] - 159s 159ms/step - loss: 0.3960 - acc: 0.9100 - val_loss: 1.5704 - val_acc: 0.5020
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[2.63895899e-01 7.60675371e-02 1.24053515e-01 1.85654014e-01
  3.50328982e-01]
 [3.42892289e-01 4.65035327e-02 1.86739802e-01 1.62816450e-01
  2.61047959e-01]
 [2.67701931e-02 6.26054704e-01 3.43048364e-01 4.91638493e-04
  3.63508868e-03]
 ...
 [5.39388545e-02 4.79288399e-02 4.72382233e-02 2.03731433e-01
  6.47162616e-01]
 [1.78798223e-06 3.00124925e-09 5.71024839e-06 9.99992251e-01
  2.08316180e-07]
 [4.29556817e-02 4.72328253e-02 5.88278398e-02 1.85851276e-01
  6.65132403e-01]]
[4 0 1 0 2 2 4 4 3 4 4 4 0 4 4 2 4 4 3 1 4 3 4 0 0 3 2 1 4 4 4 1 4 0 2 2 4
 4 1 4 0 0 4 4 4 4 1 4 4 1 4 4 2 4 4 4 1 4 4 1 4 3 2 4 2 3 3 4 4 4 3 4 1 4
 3 4 4 4 4 4 4 4 2 0 0 4 4 4 1 1 2 0 4 2 4 1 4 3 4 4 0 4 2 4 4 2 2 2 1 1 4
 0 4 4 1 0 2 3 4 1 4 0 4 2 4 4 4 3 4 0 4 4 4 4 1 4 0 1 4 2 3 2 2 3 0 4 4 2
 4 1 4 4 0 4 4 2 2 4 3 4 4 0 1 4 2 4 4 1 4 3 4 1 0 2 4 4 4 2 4 2 4 0 4 1 4
 4 1 4 2 1 3 4 3 4 2 0 0 0 4 0 4 4 4 4 4 4 0 3 4 2 1 0 3 0 0 4 4 4 2 4 4 4
 4 4 4 4 0 3 4 4 2 1 3 4 4 4 2 4 4 4 4 0 3 4 2 2 1 4 4 2 3 4 4 0 3 4 3 2 1
 4 1 4 3 4 2 4 4 2 2 1 4 1 4 4 4 4 4 4 1 4 3 4 3 4 2 3 2 0 2 2 4 0 1 3 2 1
 4 2 4 4 4 4 4 4 3 4 0 3 4 1 4 3 1 3 4 4 4 4 3 4 4 4 2 0 2 2 4 0 4 4 0 0 3
 4 0 4 3 2 0 4 0 4 4 3 4 4 3 4 4 1 4 4 4 3 4 1 4 4 2 4 4 0 4 2 2 2 0 1 4 0
 1 1 0 0 1 1 4 2 4 1 4 4 2 4 4 0 1 4 0 1 3 4 1 2 2 3 4 4 2 4 2 4 4 0 4 3 1
 4 0 3 1 4 4 0 2 1 2 4 2 4 4 1 0 4 4 4 4 2 4 4 4 2 4 2 4 4 1 4 0 4 4 4 2 1
 4 4 4 2 3 4 4 2 4 4 3 4 2 4 2 4 3 4 3 2 2 4 1 4 4 4 4 0 4 2 4 4 0 0 4 1 4
 0 4 3 0 4 4 2 4 4 4 0 3 0 0 3 4 4 2 4 1 2 1 4 2 3 2 4 2 1 0 3 4 4 4 4 4 4
 3 0 4 4 0 2 4 4 4 4 4 2 4 4 0 4 4 4 4 4 2 2 2 3 2 3 4 4 3 3 1 4 4 4 0 3 0
 4 4 1 3 1 2 3 4 4 4 3 4 4 4 4 1 2 4 4 4 4 4 4 1 4 0 2 2 4 3 4 4 4 4 3 4 4
 4 3 4 4 4 0 0 4 4 4 4 4 4 4 1 4 0 3 4 2 4 3 1 4 4 3 2 2 4 4 0 4 4 4 3 3 4
 3 4 2 4 4 0 3 0 0 1 4 0 0 2 3 2 4 2 0 2 4 4 4 4 4 3 0 4 0 0 4 4 2 2 4 3 4
 1 4 0 1 4 4 2 2 1 2 1 0 1 4 1 4 3 4 4 4 1 4 4 4 0 4 1 4 0 4 4 4 4 4 0 0 2
 1 3 4 2 4 2 4 4 1 4 4 4 4 4 3 4 4 3 4 0 2 2 4 3 4 3 2 4 4 2 2 0 4 4 1 3 4
 3 4 1 2 4 4 2 4 4 2 3 0 1 0 4 4 4 1 2 3 4 4 4 1 1 4 4 2 4 4 2 4 0 4 1 4 4
 4 4 2 4 1 4 4 2 4 4 1 2 4 4 4 4 1 4 0 0 4 4 3 0 4 4 4 4 4 2 4 1 0 4 4 1 4
 2 4 1 1 2 3 4 3 2 4 0 3 3 4 1 2 4 4 4 2 1 0 4 1 2 3 4 4 4 4 4 4 0 2 1 4 1
 2 0 3 1 1 2 4 2 4 3 1 4 1 2 4 4 3 2 2 0 2 4 1 0 2 4 4 4 4 4 4 4 4 2 3 4 4
 3 4 4 0 4 0 4 1 3 4 1 0 3 4 2 4 4 1 4 4 4 4 4 2 4 4 1 4 3 0 0 4 4 0 4 3 4
 2 4 4 4 4 2 1 4 2 4 4 0 4 2 4 3 4 3 4 4 4 4 1 4 2 0 4 0 1 3 2 4 4 0 4 2 4
 4 0 1 1 3 3 1 4 2 2 1 2 4 0 1 3 2 3 2 2 4 2 4 4 3 0 4 0 4 2 2 4 4 4 0 4 3
 4]

  32/1000 [..............................] - ETA: 43s
  64/1000 [>.............................] - ETA: 42s
  96/1000 [=>............................] - ETA: 40s
 128/1000 [==>...........................] - ETA: 39s
 160/1000 [===>..........................] - ETA: 38s
 192/1000 [====>.........................] - ETA: 36s
 224/1000 [=====>........................] - ETA: 35s
 256/1000 [======>.......................] - ETA: 33s
 288/1000 [=======>......................] - ETA: 32s
 320/1000 [========>.....................] - ETA: 31s
 352/1000 [=========>....................] - ETA: 29s
 384/1000 [==========>...................] - ETA: 28s
 416/1000 [===========>..................] - ETA: 26s
 448/1000 [============>.................] - ETA: 25s
 480/1000 [=============>................] - ETA: 23s
 512/1000 [==============>...............] - ETA: 22s
 544/1000 [===============>..............] - ETA: 20s
 576/1000 [================>.............] - ETA: 19s
 608/1000 [=================>............] - ETA: 17s
 640/1000 [==================>...........] - ETA: 16s
 672/1000 [===================>..........] - ETA: 14s
 704/1000 [====================>.........] - ETA: 13s
 736/1000 [=====================>........] - ETA: 12s
 768/1000 [======================>.......] - ETA: 10s
 800/1000 [=======================>......] - ETA: 9s 
 832/1000 [=======================>......] - ETA: 7s
 864/1000 [========================>.....] - ETA: 6s
 896/1000 [=========================>....] - ETA: 4s
 928/1000 [==========================>...] - ETA: 3s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 46s 46ms/step
Test loss: 1.816011697769165
Test accuracy: 0.461
[[ 66  28  46  25  35]
 [  9  58   3   0 130]
 [ 34  28  94  42   2]
 [ 10   0  13  43 134]
 [  0   0   0   0 200]]
