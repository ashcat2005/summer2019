Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:229: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-20 22:50:34.912544: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-10-20 22:50:35.015127: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-10-20 22:50:35.015429: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x559f5d489b10 executing computations on platform Host. Devices:
2019-10-20 22:50:35.015490: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Train on 1000 samples, validate on 1000 samples
Epoch 1/25

 200/1000 [=====>........................] - ETA: 2:50 - loss: 1.6098 - acc: 0.2150
 400/1000 [===========>..................] - ETA: 1:44 - loss: 1.5929 - acc: 0.2450
 600/1000 [=================>............] - ETA: 1:05 - loss: 1.5614 - acc: 0.2967
 800/1000 [=======================>......] - ETA: 31s - loss: 1.5286 - acc: 0.3163 
1000/1000 [==============================] - 197s 197ms/step - loss: 1.5125 - acc: 0.3480 - val_loss: 1.4066 - val_acc: 0.3820
Epoch 2/25

 200/1000 [=====>........................] - ETA: 1:57 - loss: 1.1974 - acc: 0.6550
 400/1000 [===========>..................] - ETA: 1:27 - loss: 1.1519 - acc: 0.6750
 600/1000 [=================>............] - ETA: 58s - loss: 1.1400 - acc: 0.6767 
 800/1000 [=======================>......] - ETA: 29s - loss: 1.0987 - acc: 0.6612
1000/1000 [==============================] - 191s 191ms/step - loss: 1.0603 - acc: 0.6610 - val_loss: 1.4232 - val_acc: 0.4820
Epoch 3/25

 200/1000 [=====>........................] - ETA: 2:04 - loss: 0.9834 - acc: 0.8000
 400/1000 [===========>..................] - ETA: 1:33 - loss: 0.9028 - acc: 0.7550
 600/1000 [=================>............] - ETA: 1:01 - loss: 0.8997 - acc: 0.7117
 800/1000 [=======================>......] - ETA: 30s - loss: 0.8811 - acc: 0.7313 
1000/1000 [==============================] - 198s 198ms/step - loss: 0.8414 - acc: 0.7540 - val_loss: 1.4399 - val_acc: 0.4100
Epoch 4/25

 200/1000 [=====>........................] - ETA: 2:01 - loss: 0.6485 - acc: 0.7800
 400/1000 [===========>..................] - ETA: 1:31 - loss: 0.6779 - acc: 0.7425
 600/1000 [=================>............] - ETA: 1:00 - loss: 0.6563 - acc: 0.7633
 800/1000 [=======================>......] - ETA: 30s - loss: 0.6596 - acc: 0.7625 
1000/1000 [==============================] - 196s 196ms/step - loss: 0.6565 - acc: 0.7760 - val_loss: 1.4723 - val_acc: 0.4760
Epoch 5/25

 200/1000 [=====>........................] - ETA: 2:04 - loss: 0.6175 - acc: 0.7950
 400/1000 [===========>..................] - ETA: 1:32 - loss: 0.5844 - acc: 0.8075
 600/1000 [=================>............] - ETA: 1:01 - loss: 0.5654 - acc: 0.8100
 800/1000 [=======================>......] - ETA: 30s - loss: 0.5490 - acc: 0.8225 
1000/1000 [==============================] - 198s 198ms/step - loss: 0.5236 - acc: 0.8380 - val_loss: 1.5728 - val_acc: 0.4560
Epoch 6/25

 200/1000 [=====>........................] - ETA: 2:04 - loss: 0.4844 - acc: 0.8300
 400/1000 [===========>..................] - ETA: 1:33 - loss: 0.4347 - acc: 0.8425
 600/1000 [=================>............] - ETA: 1:02 - loss: 0.4291 - acc: 0.8500
 800/1000 [=======================>......] - ETA: 31s - loss: 0.4165 - acc: 0.8725 
1000/1000 [==============================] - 199s 199ms/step - loss: 0.4152 - acc: 0.8760 - val_loss: 1.5973 - val_acc: 0.5480
Epoch 7/25

 200/1000 [=====>........................] - ETA: 2:02 - loss: 0.3615 - acc: 0.9400
 400/1000 [===========>..................] - ETA: 1:31 - loss: 0.3627 - acc: 0.9150
 600/1000 [=================>............] - ETA: 1:01 - loss: 0.3425 - acc: 0.9150
 800/1000 [=======================>......] - ETA: 30s - loss: 0.3279 - acc: 0.9163 
1000/1000 [==============================] - 197s 197ms/step - loss: 0.3383 - acc: 0.9030 - val_loss: 1.6853 - val_acc: 0.5020
Epoch 8/25

 200/1000 [=====>........................] - ETA: 2:06 - loss: 0.3277 - acc: 0.8800
 400/1000 [===========>..................] - ETA: 1:33 - loss: 0.3140 - acc: 0.9000
 600/1000 [=================>............] - ETA: 1:01 - loss: 0.3054 - acc: 0.9200
 800/1000 [=======================>......] - ETA: 30s - loss: 0.2907 - acc: 0.9338 
1000/1000 [==============================] - 198s 198ms/step - loss: 0.2832 - acc: 0.9310 - val_loss: 1.8404 - val_acc: 0.5290
Epoch 9/25

 200/1000 [=====>........................] - ETA: 2:01 - loss: 0.2687 - acc: 0.9050
 400/1000 [===========>..................] - ETA: 1:32 - loss: 0.2395 - acc: 0.9225
 600/1000 [=================>............] - ETA: 1:01 - loss: 0.2377 - acc: 0.9383
 800/1000 [=======================>......] - ETA: 30s - loss: 0.2426 - acc: 0.9500 
1000/1000 [==============================] - 198s 198ms/step - loss: 0.2337 - acc: 0.9540 - val_loss: 1.8110 - val_acc: 0.5230
Epoch 10/25

 200/1000 [=====>........................] - ETA: 2:04 - loss: 0.2199 - acc: 0.9200
 400/1000 [===========>..................] - ETA: 1:31 - loss: 0.2389 - acc: 0.9000
 600/1000 [=================>............] - ETA: 1:01 - loss: 0.2170 - acc: 0.9233
 800/1000 [=======================>......] - ETA: 30s - loss: 0.2132 - acc: 0.9388 
1000/1000 [==============================] - 200s 200ms/step - loss: 0.2044 - acc: 0.9490 - val_loss: 1.7764 - val_acc: 0.6100
Epoch 11/25

 200/1000 [=====>........................] - ETA: 2:05 - loss: 0.1568 - acc: 0.9750
 400/1000 [===========>..................] - ETA: 1:34 - loss: 0.1657 - acc: 0.9525
 600/1000 [=================>............] - ETA: 1:02 - loss: 0.1648 - acc: 0.9517
 800/1000 [=======================>......] - ETA: 31s - loss: 0.1561 - acc: 0.9588 
1000/1000 [==============================] - 204s 204ms/step - loss: 0.1594 - acc: 0.9630 - val_loss: 1.7439 - val_acc: 0.5920
Epoch 12/25

 200/1000 [=====>........................] - ETA: 2:08 - loss: 0.1444 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:35 - loss: 0.1598 - acc: 0.9850
 600/1000 [=================>............] - ETA: 1:03 - loss: 0.1493 - acc: 0.9883
 800/1000 [=======================>......] - ETA: 31s - loss: 0.1426 - acc: 0.9813 
1000/1000 [==============================] - 204s 204ms/step - loss: 0.1347 - acc: 0.9810 - val_loss: 1.9454 - val_acc: 0.5610
Epoch 13/25

 200/1000 [=====>........................] - ETA: 2:05 - loss: 0.1456 - acc: 0.9800
 400/1000 [===========>..................] - ETA: 1:34 - loss: 0.1163 - acc: 0.9850
 600/1000 [=================>............] - ETA: 1:02 - loss: 0.1150 - acc: 0.9883
 800/1000 [=======================>......] - ETA: 31s - loss: 0.1165 - acc: 0.9913 
1000/1000 [==============================] - 203s 203ms/step - loss: 0.1126 - acc: 0.9910 - val_loss: 1.8574 - val_acc: 0.5710
Epoch 14/25

 200/1000 [=====>........................] - ETA: 2:05 - loss: 0.0807 - acc: 0.9950
 400/1000 [===========>..................] - ETA: 1:34 - loss: 0.1016 - acc: 0.9775
 600/1000 [=================>............] - ETA: 1:03 - loss: 0.0913 - acc: 0.9817
 800/1000 [=======================>......] - ETA: 31s - loss: 0.0872 - acc: 0.9850 
1000/1000 [==============================] - 203s 203ms/step - loss: 0.0894 - acc: 0.9870 - val_loss: 1.9037 - val_acc: 0.6170
Epoch 15/25

 200/1000 [=====>........................] - ETA: 2:07 - loss: 0.0681 - acc: 0.9950
 400/1000 [===========>..................] - ETA: 1:35 - loss: 0.0784 - acc: 0.9925
 600/1000 [=================>............] - ETA: 1:03 - loss: 0.0792 - acc: 0.9950
 800/1000 [=======================>......] - ETA: 31s - loss: 0.0763 - acc: 0.9950 
1000/1000 [==============================] - 204s 204ms/step - loss: 0.0754 - acc: 0.9950 - val_loss: 2.0304 - val_acc: 0.5620
Epoch 16/25

 200/1000 [=====>........................] - ETA: 2:07 - loss: 0.0792 - acc: 0.9950
 400/1000 [===========>..................] - ETA: 1:35 - loss: 0.0756 - acc: 0.9950
 600/1000 [=================>............] - ETA: 1:03 - loss: 0.0685 - acc: 0.9967
 800/1000 [=======================>......] - ETA: 31s - loss: 0.0661 - acc: 0.9975 
1000/1000 [==============================] - 205s 205ms/step - loss: 0.0643 - acc: 0.9980 - val_loss: 1.9805 - val_acc: 0.6220
Epoch 17/25

 200/1000 [=====>........................] - ETA: 2:06 - loss: 0.0459 - acc: 0.9950
 400/1000 [===========>..................] - ETA: 1:35 - loss: 0.0507 - acc: 0.9975
 600/1000 [=================>............] - ETA: 1:03 - loss: 0.0590 - acc: 0.9950
 800/1000 [=======================>......] - ETA: 31s - loss: 0.0555 - acc: 0.9963 
1000/1000 [==============================] - 204s 204ms/step - loss: 0.0526 - acc: 0.9970 - val_loss: 2.0903 - val_acc: 0.6180
Epoch 18/25

 200/1000 [=====>........................] - ETA: 2:10 - loss: 0.0624 - acc: 0.9950
 400/1000 [===========>..................] - ETA: 1:36 - loss: 0.0483 - acc: 0.9975
 600/1000 [=================>............] - ETA: 1:05 - loss: 0.0456 - acc: 0.9983
 800/1000 [=======================>......] - ETA: 32s - loss: 0.0472 - acc: 0.9988 
1000/1000 [==============================] - 212s 212ms/step - loss: 0.0442 - acc: 0.9990 - val_loss: 2.0596 - val_acc: 0.6200
Epoch 19/25

 200/1000 [=====>........................] - ETA: 2:17 - loss: 0.0341 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:41 - loss: 0.0370 - acc: 1.0000
 600/1000 [=================>............] - ETA: 1:07 - loss: 0.0342 - acc: 1.0000
 800/1000 [=======================>......] - ETA: 33s - loss: 0.0393 - acc: 0.9975 
1000/1000 [==============================] - 212s 212ms/step - loss: 0.0370 - acc: 0.9980 - val_loss: 2.1373 - val_acc: 0.6140
Epoch 20/25

 200/1000 [=====>........................] - ETA: 2:06 - loss: 0.0347 - acc: 0.9950
 400/1000 [===========>..................] - ETA: 1:35 - loss: 0.0286 - acc: 0.9975
 600/1000 [=================>............] - ETA: 1:03 - loss: 0.0313 - acc: 0.9983
 800/1000 [=======================>......] - ETA: 31s - loss: 0.0328 - acc: 0.9988 
1000/1000 [==============================] - 206s 206ms/step - loss: 0.0318 - acc: 0.9990 - val_loss: 2.1495 - val_acc: 0.6240
Epoch 21/25

 200/1000 [=====>........................] - ETA: 2:17 - loss: 0.0349 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:41 - loss: 0.0317 - acc: 0.9975
 600/1000 [=================>............] - ETA: 1:07 - loss: 0.0303 - acc: 0.9983
 800/1000 [=======================>......] - ETA: 33s - loss: 0.0289 - acc: 0.9988 
1000/1000 [==============================] - 215s 215ms/step - loss: 0.0268 - acc: 0.9990 - val_loss: 2.1967 - val_acc: 0.6250
Epoch 22/25

 200/1000 [=====>........................] - ETA: 2:14 - loss: 0.0214 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:40 - loss: 0.0206 - acc: 1.0000
 600/1000 [=================>............] - ETA: 1:07 - loss: 0.0201 - acc: 1.0000
 800/1000 [=======================>......] - ETA: 33s - loss: 0.0235 - acc: 0.9988 
1000/1000 [==============================] - 215s 215ms/step - loss: 0.0232 - acc: 0.9990 - val_loss: 2.1985 - val_acc: 0.6150
Epoch 23/25

 200/1000 [=====>........................] - ETA: 2:13 - loss: 0.0159 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:39 - loss: 0.0207 - acc: 1.0000
 600/1000 [=================>............] - ETA: 1:05 - loss: 0.0206 - acc: 1.0000
 800/1000 [=======================>......] - ETA: 32s - loss: 0.0220 - acc: 1.0000 
1000/1000 [==============================] - 207s 207ms/step - loss: 0.0208 - acc: 1.0000 - val_loss: 2.2335 - val_acc: 0.6210
Epoch 24/25

 200/1000 [=====>........................] - ETA: 2:10 - loss: 0.0239 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:36 - loss: 0.0212 - acc: 1.0000
 600/1000 [=================>............] - ETA: 1:04 - loss: 0.0191 - acc: 1.0000
 800/1000 [=======================>......] - ETA: 32s - loss: 0.0189 - acc: 1.0000 
1000/1000 [==============================] - 205s 205ms/step - loss: 0.0180 - acc: 1.0000 - val_loss: 2.2724 - val_acc: 0.6220
Epoch 25/25

 200/1000 [=====>........................] - ETA: 2:06 - loss: 0.0195 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:35 - loss: 0.0169 - acc: 1.0000
 600/1000 [=================>............] - ETA: 1:03 - loss: 0.0168 - acc: 1.0000
 800/1000 [=======================>......] - ETA: 31s - loss: 0.0165 - acc: 1.0000 
1000/1000 [==============================] - 205s 205ms/step - loss: 0.0162 - acc: 1.0000 - val_loss: 2.2737 - val_acc: 0.6170
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[3.3803383e-01 2.6247466e-03 5.5733446e-02 2.4316151e-01 3.6044645e-01]
 [1.7978946e-02 1.2476764e-04 3.2429099e-01 5.9492302e-01 6.2682226e-02]
 [1.3238250e-04 9.9834883e-01 1.5186591e-03 8.5932417e-10 5.9867332e-08]
 ...
 [8.7864183e-02 1.2674457e-03 9.2719253e-03 2.6562256e-01 6.3597393e-01]
 [2.4421728e-28 2.7045968e-38 2.1528994e-37 1.0000000e+00 1.3782747e-35]
 [7.9647051e-03 3.3245029e-04 5.1472452e-03 3.0733138e-02 9.5582253e-01]]
[4 3 1 1 2 4 3 3 2 3 4 4 0 4 4 2 4 4 3 0 3 3 4 0 0 3 2 1 3 3 4 1 3 2 2 2 4
 3 2 3 3 0 3 4 4 3 3 3 3 1 4 4 2 4 4 3 2 4 4 2 4 3 2 4 2 3 3 4 3 4 3 4 2 3
 3 3 3 3 3 4 4 3 0 0 0 3 4 3 3 1 2 2 4 0 4 1 3 3 3 4 3 3 2 3 3 2 2 2 1 1 3
 3 4 3 1 0 2 3 3 0 3 3 3 2 3 3 4 3 4 0 4 4 3 3 1 4 0 1 3 4 3 2 2 3 1 3 3 2
 3 1 3 0 0 3 3 4 2 3 3 3 4 0 1 3 2 4 4 1 4 3 4 1 0 2 4 4 3 0 4 0 4 0 3 1 3
 4 1 3 0 2 3 3 3 3 2 3 3 2 4 0 4 3 3 4 3 4 0 3 4 0 1 0 3 0 0 3 3 1 3 4 3 3
 4 3 4 4 0 3 2 3 2 2 3 3 4 4 2 4 4 4 3 2 3 4 2 0 2 3 3 2 0 4 4 3 3 3 4 2 1
 3 1 4 3 4 2 3 3 2 2 1 3 2 3 4 3 3 4 4 0 4 3 3 3 4 2 3 2 3 2 2 4 3 1 3 2 1
 3 0 4 4 3 3 4 3 3 3 0 3 4 1 4 3 1 3 3 3 3 4 4 4 3 4 0 0 2 2 4 0 3 4 1 0 3
 4 2 4 3 2 0 3 3 3 4 3 4 3 3 4 4 0 4 4 4 3 4 1 3 3 3 3 4 0 3 3 2 2 1 1 3 0
 1 3 0 0 2 2 3 4 3 1 4 4 2 4 3 0 1 4 0 1 3 3 1 2 2 4 4 4 2 4 2 4 1 0 3 3 1
 3 2 3 1 3 3 0 2 1 0 3 2 3 3 1 0 3 3 3 3 2 4 4 4 2 0 2 4 3 1 4 0 4 3 3 2 1
 3 3 4 3 4 4 4 2 4 4 3 3 2 3 0 4 3 3 3 3 2 4 1 4 3 4 4 0 3 2 4 4 3 0 4 1 3
 0 4 3 3 4 4 3 4 4 4 3 3 0 0 3 3 0 2 3 1 0 1 3 2 3 2 4 2 2 0 3 3 4 3 3 3 4
 4 0 3 3 0 3 3 3 4 3 3 2 3 3 0 4 3 4 3 3 0 2 2 3 3 3 4 4 3 3 2 3 4 3 0 3 0
 0 4 2 3 1 2 3 3 4 4 3 3 3 0 0 1 2 4 4 4 4 4 4 1 3 3 2 3 3 0 4 4 4 3 0 4 4
 4 3 4 3 3 0 0 4 3 3 2 3 4 3 2 3 3 3 4 2 3 3 2 4 3 3 2 1 4 4 3 3 4 3 3 3 3
 3 4 2 4 4 3 3 1 3 0 0 0 3 2 3 2 3 2 0 2 3 3 3 4 4 2 0 4 0 2 3 4 2 2 4 0 3
 0 4 3 1 3 4 2 2 0 4 3 0 0 3 1 3 3 4 4 3 1 3 4 3 3 4 1 3 2 3 4 3 4 4 0 0 2
 1 3 4 2 4 2 3 4 3 3 4 4 4 4 3 4 4 3 3 3 2 2 4 3 4 0 0 3 3 2 0 1 4 3 2 3 4
 3 3 2 2 4 3 2 3 3 2 3 0 1 0 4 3 4 2 2 3 0 3 4 1 1 3 4 4 4 3 3 4 0 3 0 4 4
 4 4 3 4 0 3 4 1 3 3 1 2 3 3 4 3 1 4 0 0 3 3 3 0 3 4 0 4 4 2 3 1 4 3 4 1 0
 2 3 1 1 1 3 3 3 2 4 0 3 3 3 1 0 4 4 4 3 1 0 3 1 0 3 4 4 4 3 4 4 2 2 3 3 3
 0 2 3 1 2 2 3 2 3 3 1 3 1 3 4 3 0 2 0 3 3 3 1 0 3 4 3 4 4 0 3 4 3 0 3 3 4
 3 3 3 1 4 0 3 0 3 4 1 0 3 0 2 3 3 2 4 4 4 4 4 2 4 3 3 3 2 0 0 3 4 0 3 3 3
 2 4 4 3 4 2 1 4 2 4 3 0 4 2 4 3 3 3 4 3 4 4 3 0 1 0 4 0 0 3 2 3 4 0 4 2 4
 3 0 2 1 3 3 1 4 2 2 1 3 4 2 1 3 2 3 2 2 3 0 3 3 3 3 3 0 3 2 0 4 3 3 3 4 3
 4]

  32/1000 [..............................] - ETA: 50s
  64/1000 [>.............................] - ETA: 47s
  96/1000 [=>............................] - ETA: 46s
 128/1000 [==>...........................] - ETA: 44s
 160/1000 [===>..........................] - ETA: 43s
 192/1000 [====>.........................] - ETA: 41s
 224/1000 [=====>........................] - ETA: 39s
 256/1000 [======>.......................] - ETA: 37s
 288/1000 [=======>......................] - ETA: 36s
 320/1000 [========>.....................] - ETA: 34s
 352/1000 [=========>....................] - ETA: 33s
 384/1000 [==========>...................] - ETA: 31s
 416/1000 [===========>..................] - ETA: 29s
 448/1000 [============>.................] - ETA: 28s
 480/1000 [=============>................] - ETA: 26s
 512/1000 [==============>...............] - ETA: 24s
 544/1000 [===============>..............] - ETA: 23s
 576/1000 [================>.............] - ETA: 21s
 608/1000 [=================>............] - ETA: 19s
 640/1000 [==================>...........] - ETA: 18s
 672/1000 [===================>..........] - ETA: 16s
 704/1000 [====================>.........] - ETA: 15s
 736/1000 [=====================>........] - ETA: 13s
 768/1000 [======================>.......] - ETA: 11s
 800/1000 [=======================>......] - ETA: 10s
 832/1000 [=======================>......] - ETA: 8s 
 864/1000 [========================>.....] - ETA: 6s
 896/1000 [=========================>....] - ETA: 5s
 928/1000 [==========================>...] - ETA: 3s
 960/1000 [===========================>..] - ETA: 2s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 51s 51ms/step
Test loss: 2.9766742401123047
Test accuracy: 0.602
[[ 78   9  48  48  17]
 [  7  65   2  85  41]
 [ 33  11  90  57   9]
 [  9   0   5 181   5]
 [  0   0   0  12 188]]
