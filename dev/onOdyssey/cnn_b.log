Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:229: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-20 22:28:12.999581: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-10-20 22:28:13.003582: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-10-20 22:28:13.003719: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55d228d28270 executing computations on platform Host. Devices:
2019-10-20 22:28:13.003740: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Train on 1000 samples, validate on 1000 samples
Epoch 1/25

 200/1000 [=====>........................] - ETA: 2:29 - loss: 1.6105 - acc: 0.1350
 400/1000 [===========>..................] - ETA: 1:33 - loss: 1.5993 - acc: 0.2125
 600/1000 [=================>............] - ETA: 58s - loss: 1.5889 - acc: 0.2767 
 800/1000 [=======================>......] - ETA: 28s - loss: 1.5795 - acc: 0.2562
1000/1000 [==============================] - 177s 177ms/step - loss: 1.5641 - acc: 0.2700 - val_loss: 1.4983 - val_acc: 0.2690
Epoch 2/25

 200/1000 [=====>........................] - ETA: 1:39 - loss: 1.3677 - acc: 0.6450
 400/1000 [===========>..................] - ETA: 1:15 - loss: 1.3641 - acc: 0.5925
 600/1000 [=================>............] - ETA: 50s - loss: 1.3343 - acc: 0.5633 
 800/1000 [=======================>......] - ETA: 25s - loss: 1.2847 - acc: 0.5563
1000/1000 [==============================] - 166s 166ms/step - loss: 1.2548 - acc: 0.5550 - val_loss: 1.4559 - val_acc: 0.3880
Epoch 3/25

 200/1000 [=====>........................] - ETA: 1:41 - loss: 1.1219 - acc: 0.6600
 400/1000 [===========>..................] - ETA: 1:15 - loss: 1.0903 - acc: 0.6400
 600/1000 [=================>............] - ETA: 50s - loss: 1.0665 - acc: 0.6550 
 800/1000 [=======================>......] - ETA: 25s - loss: 1.0311 - acc: 0.6888
1000/1000 [==============================] - 166s 166ms/step - loss: 1.0240 - acc: 0.6630 - val_loss: 1.4232 - val_acc: 0.4030
Epoch 4/25

 200/1000 [=====>........................] - ETA: 1:41 - loss: 0.8727 - acc: 0.7150
 400/1000 [===========>..................] - ETA: 1:15 - loss: 0.8577 - acc: 0.7425
 600/1000 [=================>............] - ETA: 50s - loss: 0.8519 - acc: 0.7400 
 800/1000 [=======================>......] - ETA: 25s - loss: 0.8374 - acc: 0.7250
1000/1000 [==============================] - 166s 166ms/step - loss: 0.8298 - acc: 0.7150 - val_loss: 1.4139 - val_acc: 0.4180
Epoch 5/25

 200/1000 [=====>........................] - ETA: 1:42 - loss: 0.7245 - acc: 0.7350
 400/1000 [===========>..................] - ETA: 1:16 - loss: 0.7357 - acc: 0.7075
 600/1000 [=================>............] - ETA: 50s - loss: 0.7247 - acc: 0.7183 
 800/1000 [=======================>......] - ETA: 25s - loss: 0.7071 - acc: 0.7338
1000/1000 [==============================] - 167s 167ms/step - loss: 0.6932 - acc: 0.7400 - val_loss: 1.5473 - val_acc: 0.4160
Epoch 6/25

 200/1000 [=====>........................] - ETA: 1:42 - loss: 0.7031 - acc: 0.7050
 400/1000 [===========>..................] - ETA: 1:16 - loss: 0.6142 - acc: 0.7750
 600/1000 [=================>............] - ETA: 50s - loss: 0.6034 - acc: 0.7833 
 800/1000 [=======================>......] - ETA: 25s - loss: 0.5802 - acc: 0.8113
1000/1000 [==============================] - 166s 166ms/step - loss: 0.5799 - acc: 0.8230 - val_loss: 1.5004 - val_acc: 0.4920
Epoch 7/25

 200/1000 [=====>........................] - ETA: 1:41 - loss: 0.4815 - acc: 0.8250
 400/1000 [===========>..................] - ETA: 1:15 - loss: 0.4697 - acc: 0.8350
 600/1000 [=================>............] - ETA: 50s - loss: 0.4669 - acc: 0.8333 
 800/1000 [=======================>......] - ETA: 25s - loss: 0.4736 - acc: 0.8388
1000/1000 [==============================] - 166s 166ms/step - loss: 0.4688 - acc: 0.8370 - val_loss: 1.5714 - val_acc: 0.4890
Epoch 8/25

 200/1000 [=====>........................] - ETA: 1:40 - loss: 0.4580 - acc: 0.8400
 400/1000 [===========>..................] - ETA: 1:15 - loss: 0.4483 - acc: 0.8475
 600/1000 [=================>............] - ETA: 50s - loss: 0.4304 - acc: 0.8850 
 800/1000 [=======================>......] - ETA: 25s - loss: 0.4127 - acc: 0.8850
1000/1000 [==============================] - 166s 166ms/step - loss: 0.4054 - acc: 0.8770 - val_loss: 1.6822 - val_acc: 0.4890
Epoch 9/25

 200/1000 [=====>........................] - ETA: 1:43 - loss: 0.3148 - acc: 0.9000
 400/1000 [===========>..................] - ETA: 1:16 - loss: 0.3380 - acc: 0.8875
 600/1000 [=================>............] - ETA: 51s - loss: 0.3199 - acc: 0.9050 
 800/1000 [=======================>......] - ETA: 25s - loss: 0.3244 - acc: 0.9012
1000/1000 [==============================] - 169s 169ms/step - loss: 0.3275 - acc: 0.8970 - val_loss: 1.6289 - val_acc: 0.5320
Epoch 10/25

 200/1000 [=====>........................] - ETA: 1:44 - loss: 0.3002 - acc: 0.9100
 400/1000 [===========>..................] - ETA: 1:17 - loss: 0.3026 - acc: 0.9450
 600/1000 [=================>............] - ETA: 52s - loss: 0.2995 - acc: 0.9433 
 800/1000 [=======================>......] - ETA: 26s - loss: 0.2952 - acc: 0.9338
1000/1000 [==============================] - 170s 170ms/step - loss: 0.2990 - acc: 0.9180 - val_loss: 1.6973 - val_acc: 0.5860
Epoch 11/25

 200/1000 [=====>........................] - ETA: 1:48 - loss: 0.2723 - acc: 0.9350
 400/1000 [===========>..................] - ETA: 1:22 - loss: 0.2797 - acc: 0.9300
 600/1000 [=================>............] - ETA: 53s - loss: 0.2758 - acc: 0.9500 
 800/1000 [=======================>......] - ETA: 26s - loss: 0.2614 - acc: 0.9438
1000/1000 [==============================] - 172s 172ms/step - loss: 0.2620 - acc: 0.9340 - val_loss: 1.7733 - val_acc: 0.5170
Epoch 12/25

 200/1000 [=====>........................] - ETA: 1:55 - loss: 0.2006 - acc: 0.9150
 400/1000 [===========>..................] - ETA: 1:26 - loss: 0.2064 - acc: 0.9425
 600/1000 [=================>............] - ETA: 55s - loss: 0.2217 - acc: 0.9383 
 800/1000 [=======================>......] - ETA: 27s - loss: 0.2181 - acc: 0.9475
1000/1000 [==============================] - 175s 175ms/step - loss: 0.2078 - acc: 0.9550 - val_loss: 1.9446 - val_acc: 0.5290
Epoch 13/25

 200/1000 [=====>........................] - ETA: 1:54 - loss: 0.2100 - acc: 0.9050
 400/1000 [===========>..................] - ETA: 1:23 - loss: 0.2066 - acc: 0.9200
 600/1000 [=================>............] - ETA: 54s - loss: 0.1998 - acc: 0.9267 
 800/1000 [=======================>......] - ETA: 26s - loss: 0.1879 - acc: 0.9437
1000/1000 [==============================] - 173s 173ms/step - loss: 0.1844 - acc: 0.9530 - val_loss: 1.7648 - val_acc: 0.5880
Epoch 14/25

 200/1000 [=====>........................] - ETA: 1:54 - loss: 0.1888 - acc: 0.9850
 400/1000 [===========>..................] - ETA: 1:21 - loss: 0.1755 - acc: 0.9775
 600/1000 [=================>............] - ETA: 53s - loss: 0.1617 - acc: 0.9717 
 800/1000 [=======================>......] - ETA: 26s - loss: 0.1543 - acc: 0.9675
1000/1000 [==============================] - 172s 172ms/step - loss: 0.1613 - acc: 0.9600 - val_loss: 1.8788 - val_acc: 0.6370
Epoch 15/25

 200/1000 [=====>........................] - ETA: 1:48 - loss: 0.1584 - acc: 0.9600
 400/1000 [===========>..................] - ETA: 1:19 - loss: 0.1513 - acc: 0.9775
 600/1000 [=================>............] - ETA: 52s - loss: 0.1639 - acc: 0.9783 
 800/1000 [=======================>......] - ETA: 26s - loss: 0.1501 - acc: 0.9838
1000/1000 [==============================] - 171s 171ms/step - loss: 0.1400 - acc: 0.9850 - val_loss: 1.9260 - val_acc: 0.5330
Epoch 16/25

 200/1000 [=====>........................] - ETA: 1:44 - loss: 0.1279 - acc: 0.9500
 400/1000 [===========>..................] - ETA: 1:17 - loss: 0.1199 - acc: 0.9600
 600/1000 [=================>............] - ETA: 51s - loss: 0.1164 - acc: 0.9650 
 800/1000 [=======================>......] - ETA: 25s - loss: 0.1188 - acc: 0.9688
1000/1000 [==============================] - 169s 169ms/step - loss: 0.1142 - acc: 0.9730 - val_loss: 1.8550 - val_acc: 0.5970
Epoch 17/25

 200/1000 [=====>........................] - ETA: 1:43 - loss: 0.0920 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:17 - loss: 0.0899 - acc: 1.0000
 600/1000 [=================>............] - ETA: 51s - loss: 0.1015 - acc: 0.9950 
 800/1000 [=======================>......] - ETA: 25s - loss: 0.1008 - acc: 0.9913
1000/1000 [==============================] - 172s 172ms/step - loss: 0.1014 - acc: 0.9910 - val_loss: 1.9798 - val_acc: 0.5620
Epoch 18/25

 200/1000 [=====>........................] - ETA: 1:45 - loss: 0.0780 - acc: 0.9950
 400/1000 [===========>..................] - ETA: 1:18 - loss: 0.0911 - acc: 0.9925
 600/1000 [=================>............] - ETA: 51s - loss: 0.0783 - acc: 0.9950 
 800/1000 [=======================>......] - ETA: 25s - loss: 0.0797 - acc: 0.9963
1000/1000 [==============================] - 173s 173ms/step - loss: 0.0788 - acc: 0.9960 - val_loss: 1.9018 - val_acc: 0.6280
Epoch 19/25

 200/1000 [=====>........................] - ETA: 1:43 - loss: 0.0675 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:17 - loss: 0.0693 - acc: 1.0000
 600/1000 [=================>............] - ETA: 51s - loss: 0.0639 - acc: 1.0000 
 800/1000 [=======================>......] - ETA: 26s - loss: 0.0644 - acc: 0.9988
1000/1000 [==============================] - 174s 174ms/step - loss: 0.0659 - acc: 0.9980 - val_loss: 2.0255 - val_acc: 0.5790
Epoch 20/25

 200/1000 [=====>........................] - ETA: 1:42 - loss: 0.0586 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:16 - loss: 0.0517 - acc: 1.0000
 600/1000 [=================>............] - ETA: 51s - loss: 0.0522 - acc: 1.0000 
 800/1000 [=======================>......] - ETA: 26s - loss: 0.0557 - acc: 0.9975
1000/1000 [==============================] - 171s 171ms/step - loss: 0.0562 - acc: 0.9970 - val_loss: 2.0000 - val_acc: 0.6290
Epoch 21/25

 200/1000 [=====>........................] - ETA: 1:42 - loss: 0.0425 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:16 - loss: 0.0443 - acc: 1.0000
 600/1000 [=================>............] - ETA: 51s - loss: 0.0477 - acc: 0.9983 
 800/1000 [=======================>......] - ETA: 26s - loss: 0.0471 - acc: 0.9988
1000/1000 [==============================] - 171s 171ms/step - loss: 0.0475 - acc: 0.9990 - val_loss: 2.0738 - val_acc: 0.5890
Epoch 22/25

 200/1000 [=====>........................] - ETA: 1:43 - loss: 0.0491 - acc: 0.9950
 400/1000 [===========>..................] - ETA: 1:16 - loss: 0.0445 - acc: 0.9975
 600/1000 [=================>............] - ETA: 52s - loss: 0.0409 - acc: 0.9983 
 800/1000 [=======================>......] - ETA: 26s - loss: 0.0387 - acc: 0.9988
1000/1000 [==============================] - 172s 172ms/step - loss: 0.0397 - acc: 0.9980 - val_loss: 2.0815 - val_acc: 0.6350
Epoch 23/25

 200/1000 [=====>........................] - ETA: 1:43 - loss: 0.0515 - acc: 0.9900
 400/1000 [===========>..................] - ETA: 1:16 - loss: 0.0408 - acc: 0.9950
 600/1000 [=================>............] - ETA: 53s - loss: 0.0406 - acc: 0.9967 
 800/1000 [=======================>......] - ETA: 26s - loss: 0.0395 - acc: 0.9975
1000/1000 [==============================] - 174s 174ms/step - loss: 0.0367 - acc: 0.9980 - val_loss: 2.1192 - val_acc: 0.6310
Epoch 24/25

 200/1000 [=====>........................] - ETA: 1:43 - loss: 0.0291 - acc: 1.0000
 400/1000 [===========>..................] - ETA: 1:16 - loss: 0.0279 - acc: 1.0000
 600/1000 [=================>............] - ETA: 51s - loss: 0.0328 - acc: 0.9983 
 800/1000 [=======================>......] - ETA: 25s - loss: 0.0352 - acc: 0.9975
1000/1000 [==============================] - 169s 169ms/step - loss: 0.0329 - acc: 0.9980 - val_loss: 2.1126 - val_acc: 0.6310
Restoring model weights from the end of the best epoch
Epoch 00024: early stopping
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[1.6704200e-01 1.4338379e-02 7.9400979e-02 2.9007584e-01 4.4914275e-01]
 [1.3288368e-01 4.0378878e-03 2.6771796e-01 3.0670130e-01 2.8865919e-01]
 [2.7511860e-03 9.3405229e-01 6.3144535e-02 3.4903628e-06 4.8567454e-05]
 ...
 [3.7211027e-02 7.6410356e-03 2.1652874e-02 3.2448211e-01 6.0901296e-01]
 [3.0126078e-15 1.7465948e-20 2.4474862e-15 1.0000000e+00 2.6908577e-16]
 [1.6407507e-02 5.8959671e-03 2.3213351e-02 2.0822887e-01 7.4625432e-01]]
[4 3 1 1 2 2 3 3 3 3 4 4 0 4 4 2 4 4 3 2 3 3 4 0 3 3 2 1 3 3 4 1 3 2 2 2 4
 3 1 4 3 0 3 4 4 3 3 3 3 1 4 4 2 4 4 3 2 4 4 2 4 3 2 4 2 3 3 4 3 4 3 4 2 3
 3 3 3 3 4 4 4 3 0 0 0 3 4 3 3 1 2 0 4 2 4 1 3 3 4 4 0 3 2 3 4 3 2 2 1 1 4
 3 4 4 1 0 2 3 3 0 4 3 3 2 3 3 4 3 4 0 4 4 3 3 1 4 0 1 3 3 3 2 2 3 1 3 3 2
 4 1 3 4 0 4 3 0 2 3 3 3 4 0 1 3 2 4 4 1 4 3 4 1 0 2 4 4 3 0 4 2 4 0 3 1 3
 4 1 3 2 1 3 3 3 4 2 3 3 0 4 0 4 3 4 4 3 4 0 3 4 0 1 3 3 0 0 4 3 2 3 4 3 3
 4 3 4 4 0 3 2 4 2 1 3 3 4 4 2 4 4 4 4 2 3 4 2 0 2 3 4 2 3 4 4 3 3 3 4 2 1
 3 1 4 3 4 2 4 4 2 2 1 3 2 3 4 3 4 4 4 1 4 3 3 3 4 2 3 2 3 2 2 4 3 1 3 2 1
 3 2 4 4 3 4 4 4 3 3 0 3 4 1 4 3 1 3 3 4 3 4 3 4 3 4 1 0 2 2 4 0 3 4 1 0 3
 4 4 4 3 2 0 3 0 3 4 3 4 3 3 4 4 0 4 4 4 3 4 1 4 3 3 4 4 0 4 2 2 2 0 1 3 0
 1 3 0 0 2 1 3 2 4 1 4 4 2 4 4 0 1 4 0 1 3 3 1 2 2 4 4 4 2 4 2 4 4 0 3 3 1
 3 2 3 1 4 4 0 2 1 0 4 2 4 4 1 0 3 4 4 3 2 4 4 4 2 4 2 4 3 1 4 2 4 4 4 2 1
 4 3 4 2 4 4 4 2 4 4 3 3 2 3 2 4 3 4 3 3 2 4 1 4 3 4 4 0 3 2 4 4 3 0 4 1 3
 0 4 3 0 4 4 3 4 4 4 0 0 0 0 3 3 3 2 3 1 0 1 4 2 3 3 4 2 2 0 3 4 4 3 3 3 4
 3 0 4 4 0 3 3 3 4 3 3 0 4 4 0 4 3 4 4 3 2 2 2 3 3 3 4 4 3 3 2 4 4 3 0 3 0
 3 4 1 3 1 2 3 3 4 4 3 3 4 4 4 1 2 4 4 4 4 4 4 1 3 3 2 3 4 3 4 4 4 3 3 4 4
 4 3 4 3 3 4 0 4 4 3 2 3 4 3 2 4 3 3 4 2 3 3 2 4 3 3 2 1 4 4 3 3 4 3 3 3 4
 3 4 2 4 4 0 3 1 3 1 0 0 0 2 3 2 3 2 0 2 4 4 4 4 4 3 0 4 0 2 3 4 2 2 4 0 3
 2 4 0 1 3 4 2 2 1 4 3 0 0 3 2 3 3 4 4 3 1 3 4 3 3 4 1 4 2 3 4 3 4 4 0 0 2
 1 3 4 2 4 0 3 4 3 4 4 4 4 4 3 4 4 3 3 3 2 2 4 3 4 3 2 3 3 2 2 1 4 4 1 3 4
 3 3 2 2 4 4 2 3 3 2 3 0 1 0 4 3 4 2 2 3 0 3 4 1 1 4 4 2 4 3 3 4 0 3 1 4 4
 4 4 2 4 1 4 4 2 3 3 1 2 3 3 4 3 1 4 2 0 3 3 3 0 3 4 0 4 4 2 3 1 4 4 4 1 0
 2 3 1 1 1 3 3 3 2 4 0 3 3 4 1 2 4 4 4 3 1 0 4 1 2 3 4 4 4 3 4 4 4 2 3 4 3
 2 2 3 1 2 2 4 2 4 3 1 3 1 3 4 3 0 2 0 3 2 3 1 0 3 4 3 4 4 3 3 4 3 2 3 3 4
 3 3 3 1 4 0 4 0 3 4 1 2 3 4 2 3 4 1 4 4 4 4 4 2 4 3 1 3 3 0 0 3 4 0 3 3 4
 2 4 4 3 4 2 1 4 2 4 3 3 4 2 4 3 4 3 4 3 4 4 3 0 1 0 4 4 0 3 2 3 4 2 4 2 4
 4 0 2 1 3 3 1 4 2 2 1 3 4 0 1 3 2 3 2 2 4 2 3 3 3 0 4 0 3 2 2 4 3 3 3 4 3
 4]

  32/1000 [..............................] - ETA: 44s
  64/1000 [>.............................] - ETA: 42s
  96/1000 [=>............................] - ETA: 40s
 128/1000 [==>...........................] - ETA: 39s
 160/1000 [===>..........................] - ETA: 37s
 192/1000 [====>.........................] - ETA: 36s
 224/1000 [=====>........................] - ETA: 35s
 256/1000 [======>.......................] - ETA: 33s
 288/1000 [=======>......................] - ETA: 32s
 320/1000 [========>.....................] - ETA: 30s
 352/1000 [=========>....................] - ETA: 29s
 384/1000 [==========>...................] - ETA: 27s
 416/1000 [===========>..................] - ETA: 26s
 448/1000 [============>.................] - ETA: 24s
 480/1000 [=============>................] - ETA: 23s
 512/1000 [==============>...............] - ETA: 21s
 544/1000 [===============>..............] - ETA: 20s
 576/1000 [================>.............] - ETA: 19s
 608/1000 [=================>............] - ETA: 17s
 640/1000 [==================>...........] - ETA: 16s
 672/1000 [===================>..........] - ETA: 14s
 704/1000 [====================>.........] - ETA: 13s
 736/1000 [=====================>........] - ETA: 11s
 768/1000 [======================>.......] - ETA: 10s
 800/1000 [=======================>......] - ETA: 9s 
 832/1000 [=======================>......] - ETA: 7s
 864/1000 [========================>.....] - ETA: 6s
 896/1000 [=========================>....] - ETA: 4s
 928/1000 [==========================>...] - ETA: 3s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 45s 45ms/step
Test loss: 2.342508909225464
Test accuracy: 0.581
[[ 64  13  56  41  26]
 [  1  65   2  48  84]
 [ 29  16  92  60   3]
 [  6   0   6 163  25]
 [  0   0   0   3 197]]
