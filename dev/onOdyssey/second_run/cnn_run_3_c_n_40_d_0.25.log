Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 11:44:43.561938: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 11:44:43.596811: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 11:44:43.597005: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x556907c04e30 executing computations on platform Host. Devices:
2019-11-07 11:44:43.597038: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
[0.25]
Train on 522 samples, validate on 174 samples
Epoch 1/40

522/522 [==============================] - 30s 58ms/step - loss: 1.0987 - acc: 0.3487 - val_loss: 1.0889 - val_acc: 0.4368
Epoch 2/40

522/522 [==============================] - 29s 55ms/step - loss: 1.0836 - acc: 0.5651 - val_loss: 1.0750 - val_acc: 0.3851
Epoch 3/40

522/522 [==============================] - 29s 55ms/step - loss: 1.0631 - acc: 0.5747 - val_loss: 1.0591 - val_acc: 0.4310
Epoch 4/40

522/522 [==============================] - 29s 55ms/step - loss: 1.0371 - acc: 0.4828 - val_loss: 1.0441 - val_acc: 0.4310
Epoch 5/40

522/522 [==============================] - 28s 55ms/step - loss: 1.0125 - acc: 0.5441 - val_loss: 1.0682 - val_acc: 0.4080
Epoch 6/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0101 - acc: 0.4215 - val_loss: 1.0540 - val_acc: 0.3908
Epoch 7/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9979 - acc: 0.5115 - val_loss: 1.0215 - val_acc: 0.4483
Epoch 8/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9469 - acc: 0.5230 - val_loss: 1.1328 - val_acc: 0.4368
Epoch 9/40

522/522 [==============================] - 29s 55ms/step - loss: 1.0130 - acc: 0.4502 - val_loss: 1.0356 - val_acc: 0.4195
Epoch 10/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9299 - acc: 0.5460 - val_loss: 1.0972 - val_acc: 0.4253
Epoch 11/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9879 - acc: 0.4444 - val_loss: 1.1409 - val_acc: 0.4023
Epoch 12/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9668 - acc: 0.5172 - val_loss: 1.1569 - val_acc: 0.4425
Epoch 13/40

522/522 [==============================] - 28s 55ms/step - loss: 0.9651 - acc: 0.4674 - val_loss: 1.0945 - val_acc: 0.4425
Epoch 14/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9290 - acc: 0.5019 - val_loss: 1.0980 - val_acc: 0.4483
Epoch 15/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9156 - acc: 0.5019 - val_loss: 1.1485 - val_acc: 0.4425
Epoch 16/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9054 - acc: 0.5153 - val_loss: 1.1575 - val_acc: 0.3966
Epoch 17/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8944 - acc: 0.5460 - val_loss: 1.1177 - val_acc: 0.4770
Epoch 18/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8789 - acc: 0.5211 - val_loss: 1.1042 - val_acc: 0.4540
Epoch 19/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8404 - acc: 0.5977 - val_loss: 1.1602 - val_acc: 0.4713
Epoch 20/40

522/522 [==============================] - 28s 55ms/step - loss: 0.8448 - acc: 0.6149 - val_loss: 1.1600 - val_acc: 0.4540
Epoch 21/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8342 - acc: 0.5632 - val_loss: 1.1809 - val_acc: 0.4195
Epoch 22/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8667 - acc: 0.5556 - val_loss: 1.1346 - val_acc: 0.4483
Epoch 23/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7938 - acc: 0.5939 - val_loss: 1.2548 - val_acc: 0.4598
Epoch 24/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8555 - acc: 0.5728 - val_loss: 1.2411 - val_acc: 0.3966
Epoch 25/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8460 - acc: 0.5326 - val_loss: 1.3378 - val_acc: 0.4483
Epoch 26/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9539 - acc: 0.4943 - val_loss: 1.2440 - val_acc: 0.4713
Epoch 27/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8050 - acc: 0.5862 - val_loss: 1.5305 - val_acc: 0.3793
Epoch 28/40

522/522 [==============================] - 29s 55ms/step - loss: 1.0529 - acc: 0.5038 - val_loss: 1.2433 - val_acc: 0.4885
Epoch 29/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7822 - acc: 0.6169 - val_loss: 1.4084 - val_acc: 0.4655
Epoch 30/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9410 - acc: 0.5364 - val_loss: 1.2292 - val_acc: 0.5230
Epoch 31/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7251 - acc: 0.6341 - val_loss: 1.5157 - val_acc: 0.4080
Epoch 32/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9720 - acc: 0.5249 - val_loss: 1.3099 - val_acc: 0.5172
Epoch 33/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7623 - acc: 0.6169 - val_loss: 1.4749 - val_acc: 0.4425
Epoch 34/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9284 - acc: 0.5364 - val_loss: 1.2977 - val_acc: 0.5172
Epoch 35/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7170 - acc: 0.6284 - val_loss: 1.5359 - val_acc: 0.4080
Epoch 36/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9339 - acc: 0.5383 - val_loss: 1.3120 - val_acc: 0.5115
Epoch 37/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7068 - acc: 0.6552 - val_loss: 1.5019 - val_acc: 0.4540
Epoch 38/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8788 - acc: 0.5670 - val_loss: 1.3525 - val_acc: 0.5000
Epoch 39/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7143 - acc: 0.6303 - val_loss: 1.5570 - val_acc: 0.4023
Epoch 40/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9173 - acc: 0.5441 - val_loss: 1.3164 - val_acc: 0.4828
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[1.84369043e-01 4.18681711e-01 3.96949291e-01]
 [1.92276463e-01 4.06407714e-01 4.01315778e-01]
 [1.87899798e-01 4.05779749e-01 4.06320423e-01]
 [6.84814006e-02 4.86374289e-01 4.45144355e-01]
 [2.60443240e-01 3.46469820e-01 3.93086970e-01]
 [9.84698594e-01 1.53013673e-02 5.54372148e-09]
 [2.07776353e-01 3.96871209e-01 3.95352453e-01]
 [2.11963966e-01 4.00668621e-01 3.87367427e-01]
 [1.97360307e-01 4.05663937e-01 3.96975726e-01]
 [1.90845609e-01 4.00840223e-01 4.08314139e-01]
 [3.28266114e-01 3.96066666e-01 2.75667250e-01]
 [9.28514600e-02 5.91168463e-01 3.15980136e-01]
 [1.79331914e-01 3.83897692e-01 4.36770409e-01]
 [2.06009299e-01 5.99793375e-01 1.94197327e-01]
 [1.78570494e-01 2.86932260e-01 5.34497261e-01]
 [4.71168935e-01 3.02289605e-01 2.26541445e-01]
 [1.06491105e-04 2.23023742e-02 9.77591157e-01]
 [1.86877400e-01 4.33345348e-01 3.79777312e-01]
 [9.99999762e-01 4.03778255e-09 2.58903782e-07]
 [2.04404816e-01 4.26171839e-01 3.69423360e-01]
 [9.37917978e-02 3.76316786e-01 5.29891491e-01]
 [2.02914089e-01 3.53497118e-01 4.43588823e-01]
 [2.00700074e-01 4.83520567e-01 3.15779388e-01]
 [1.82425797e-01 4.90496576e-01 3.27077597e-01]
 [2.00700074e-01 4.83520567e-01 3.15779388e-01]
 [2.03765780e-01 3.79682809e-01 4.16551352e-01]
 [3.63804221e-01 2.67261475e-01 3.68934333e-01]
 [5.75816957e-03 6.84596300e-01 3.09645474e-01]
 [1.34080231e-01 5.35331607e-01 3.30588132e-01]
 [1.96090579e-01 4.21140820e-01 3.82768571e-01]
 [1.00000000e+00 3.16372395e-09 3.36423556e-09]
 [2.00700074e-01 4.83520567e-01 3.15779388e-01]
 [7.59770572e-01 9.96574983e-02 1.40571907e-01]
 [2.05974922e-01 3.56445819e-01 4.37579274e-01]
 [5.18810339e-06 1.82784679e-05 9.99976516e-01]
 [1.81555256e-01 4.39576268e-01 3.78868520e-01]
 [1.84166968e-01 4.36533809e-01 3.79299313e-01]
 [1.01516992e-01 3.98086160e-01 5.00396848e-01]
 [8.29868197e-01 8.09637159e-02 8.91680121e-02]
 [2.36095652e-01 3.85134369e-01 3.78769964e-01]
 [8.96379232e-01 1.03620827e-01 2.63433675e-09]
 [1.01516992e-01 3.98086160e-01 5.00396848e-01]
 [4.18226480e-01 1.47904798e-01 4.33868676e-01]
 [9.99992251e-01 3.00734493e-10 7.70221050e-06]
 [9.99992251e-01 3.00734493e-10 7.70221050e-06]
 [2.26716921e-01 3.94787639e-01 3.78495425e-01]
 [1.57947496e-01 4.86194432e-01 3.55858028e-01]
 [1.92973405e-01 4.17733997e-01 3.89292598e-01]
 [8.29868197e-01 8.09637159e-02 8.91680121e-02]
 [2.10733652e-01 3.62324715e-01 4.26941574e-01]
 [3.63804221e-01 2.67261475e-01 3.68934333e-01]
 [2.02607244e-01 4.26201284e-01 3.71191502e-01]
 [9.77405012e-02 5.34272254e-01 3.67987186e-01]
 [2.15624943e-01 3.75297248e-01 4.09077793e-01]
 [2.21355140e-01 3.74480933e-01 4.04163927e-01]
 [1.91570923e-01 5.66171885e-01 2.42257208e-01]
 [2.74426043e-01 3.32233846e-01 3.93340141e-01]
 [3.22674841e-01 5.20463049e-01 1.56862140e-01]
 [1.10841818e-01 3.61384183e-01 5.27774036e-01]
 [1.97360307e-01 4.05663937e-01 3.96975726e-01]
 [2.00700074e-01 4.83520567e-01 3.15779388e-01]
 [5.68087399e-01 2.51159608e-01 1.80753052e-01]
 [2.79407114e-01 3.03129911e-01 4.17462885e-01]
 [9.99999642e-01 3.89743292e-07 2.28182317e-09]
 [5.21923043e-03 6.56457782e-01 3.38323027e-01]
 [1.00000000e+00 3.16372395e-09 3.36423556e-09]
 [8.96379232e-01 1.03620827e-01 2.63433675e-09]
 [2.43128146e-04 9.99262512e-01 4.94304113e-04]
 [7.59770572e-01 9.96574983e-02 1.40571907e-01]
 [2.18575448e-01 4.08612221e-01 3.72812390e-01]
 [2.08199382e-01 4.07054216e-01 3.84746492e-01]
 [1.36844218e-01 2.65340477e-01 5.97815335e-01]
 [1.01516992e-01 3.98086160e-01 5.00396848e-01]
 [1.69418380e-01 4.19485182e-01 4.11096483e-01]
 [3.64457428e-01 2.06563756e-01 4.28978771e-01]
 [8.00781548e-01 2.20306497e-03 1.97015420e-01]
 [1.41804218e-02 5.89935422e-01 3.95884126e-01]
 [2.99759563e-02 1.93455741e-01 7.76568294e-01]
 [1.82466134e-01 4.29378003e-01 3.88155818e-01]
 [6.13892041e-02 4.88888204e-01 4.49722558e-01]
 [1.19327602e-03 6.00220144e-01 3.98586541e-01]
 [1.73594579e-01 4.26905245e-01 3.99500191e-01]
 [4.05692071e-01 3.34585845e-01 2.59722054e-01]
 [1.63089722e-01 3.86929154e-01 4.49981153e-01]
 [2.21325949e-01 3.87606531e-01 3.91067535e-01]
 [1.80260107e-01 4.11172807e-01 4.08566982e-01]
 [1.88907743e-01 3.92720997e-01 4.18371260e-01]
 [1.00000000e+00 3.16372395e-09 3.36423556e-09]
 [2.60443240e-01 3.46469820e-01 3.93086970e-01]
 [9.99999642e-01 3.89743292e-07 2.28182317e-09]
 [9.84698594e-01 1.53013673e-02 5.54372148e-09]
 [2.07709134e-01 4.24816817e-01 3.67473990e-01]
 [1.36844218e-01 2.65340477e-01 5.97815335e-01]
 [9.58402216e-01 7.16142631e-06 4.15906161e-02]
 [1.67284265e-01 4.01673198e-01 4.31042612e-01]
 [1.81437939e-01 3.78092825e-01 4.40469235e-01]
 [1.89278618e-01 3.89905393e-01 4.20816064e-01]
 [9.99999762e-01 4.03778255e-09 2.58903782e-07]
 [1.89802721e-01 4.29588199e-01 3.80609125e-01]
 [9.97126758e-01 1.56146812e-03 1.31185562e-03]
 [2.03510508e-01 3.88757914e-01 4.07731593e-01]
 [1.00000000e+00 2.13356657e-08 5.25925570e-09]
 [1.71721950e-01 4.01262969e-01 4.27015036e-01]
 [1.88932925e-01 4.28148657e-01 3.82918388e-01]
 [1.28707722e-01 5.99961519e-01 2.71330744e-01]
 [9.97126758e-01 1.56146812e-03 1.31185562e-03]
 [1.19327602e-03 6.00220144e-01 3.98586541e-01]
 [3.69138658e-01 5.57363868e-01 7.34974444e-02]
 [7.59770572e-01 9.96574983e-02 1.40571907e-01]
 [6.33215392e-03 6.56216383e-01 3.37451488e-01]
 [1.88007683e-01 3.96163493e-01 4.15828913e-01]
 [1.84166968e-01 4.36533809e-01 3.79299313e-01]
 [2.02914089e-01 3.53497118e-01 4.43588823e-01]
 [2.18054190e-01 3.71114612e-01 4.10831213e-01]
 [2.00700074e-01 4.83520567e-01 3.15779388e-01]
 [1.01183436e-03 8.63800168e-01 1.35187969e-01]
 [3.78968328e-01 3.34779173e-01 2.86252528e-01]
 [1.92185864e-01 3.82292002e-01 4.25522119e-01]
 [1.94908231e-01 4.08273816e-01 3.96817923e-01]
 [1.97360307e-01 4.05663937e-01 3.96975726e-01]
 [1.81555256e-01 4.39576268e-01 3.78868520e-01]
 [6.08921461e-02 5.22761464e-01 4.16346401e-01]
 [9.93208587e-01 4.77212667e-03 2.01929640e-03]
 [1.80260107e-01 4.11172807e-01 4.08566982e-01]
 [9.85007465e-01 5.38428547e-03 9.60833114e-03]
 [9.99992251e-01 3.00734493e-10 7.70221050e-06]
 [1.06606245e-01 2.73272127e-01 6.20121598e-01]
 [9.84698594e-01 1.53013673e-02 5.54372148e-09]
 [1.78913787e-01 3.90412360e-01 4.30673838e-01]
 [1.43591603e-02 3.83074492e-01 6.02566361e-01]
 [1.92528501e-01 3.96537602e-01 4.10933882e-01]
 [1.54935896e-01 2.53879040e-01 5.91185093e-01]
 [7.10536778e-01 2.75598164e-03 2.86707252e-01]
 [2.16428995e-01 3.92136902e-01 3.91434073e-01]
 [6.36325240e-01 3.57936346e-03 3.60095471e-01]
 [3.08838159e-01 3.15635026e-01 3.75526816e-01]
 [2.07764477e-01 4.27028745e-01 3.65206838e-01]
 [1.00000000e+00 1.65499363e-12 8.31966007e-12]
 [3.66697162e-01 2.91010201e-01 3.42292637e-01]
 [3.78968328e-01 3.34779173e-01 2.86252528e-01]
 [3.22039127e-01 1.63924858e-01 5.14036059e-01]
 [1.67974383e-01 3.95308346e-01 4.36717242e-01]
 [1.71493754e-01 4.02996540e-01 4.25509691e-01]
 [3.71424139e-01 3.33546460e-01 2.95029402e-01]
 [2.28702813e-01 3.86056513e-01 3.85240674e-01]
 [1.19327602e-03 6.00220144e-01 3.98586541e-01]
 [5.61419642e-03 6.53094888e-01 3.41290951e-01]
 [2.19745174e-01 3.91029596e-01 3.89225215e-01]
 [4.15521450e-02 4.24215227e-01 5.34232676e-01]
 [2.02761352e-01 4.29168582e-01 3.68070096e-01]
 [1.99247807e-01 3.79386395e-01 4.21365827e-01]
 [2.07776353e-01 3.96871209e-01 3.95352453e-01]
 [2.02699021e-01 3.96169156e-01 4.01131809e-01]
 [2.00700074e-01 4.83520567e-01 3.15779388e-01]
 [9.99992251e-01 3.00734493e-10 7.70221050e-06]
 [9.61886227e-01 9.06865671e-03 2.90450696e-02]
 [1.36844218e-01 2.65340477e-01 5.97815335e-01]
 [9.97954011e-01 2.03809491e-03 7.89943169e-06]
 [1.73594579e-01 4.26905245e-01 3.99500191e-01]
 [2.05996379e-01 3.79792094e-01 4.14211512e-01]
 [1.46411702e-01 5.14614820e-01 3.38973463e-01]
 [9.99999642e-01 3.89743292e-07 2.28182317e-09]
 [1.01516992e-01 3.98086160e-01 5.00396848e-01]
 [1.74204677e-01 4.14251387e-01 4.11543906e-01]
 [2.00862899e-01 3.68791282e-01 4.30345833e-01]
 [2.04276815e-01 4.26443875e-01 3.69279325e-01]
 [1.00002520e-01 3.68267447e-01 5.31730115e-01]
 [9.99999762e-01 4.03778255e-09 2.58903782e-07]
 [3.97752494e-01 2.09265620e-01 3.92981857e-01]
 [2.21307337e-01 5.19725740e-01 2.58966953e-01]
 [1.99515477e-01 4.32314843e-01 3.68169636e-01]
 [1.91602260e-01 4.32897955e-01 3.75499815e-01]
 [1.75550252e-01 3.91840279e-01 4.32609499e-01]
 [1.98596850e-01 4.23462749e-01 3.77940446e-01]]
[1 1 2 1 2 0 1 1 1 2 1 1 2 1 2 0 2 1 0 1 2 2 1 1 1 2 2 1 1 1 0 1 0 2 2 1 1
 2 0 1 0 2 2 0 0 1 1 1 0 2 2 1 1 2 2 1 2 1 2 1 1 0 2 0 1 0 0 1 0 1 1 2 2 1
 2 0 1 2 1 1 1 1 0 2 2 1 2 0 2 0 0 1 2 0 2 2 2 0 1 0 2 0 2 1 1 0 1 1 0 1 2
 1 2 2 1 1 0 2 1 1 1 1 0 1 0 0 2 0 2 2 2 2 0 1 0 2 1 0 0 0 2 2 2 0 1 1 1 1
 2 1 2 1 2 1 0 0 2 0 1 2 1 0 2 1 2 1 2 0 0 1 1 1 2 1]

 32/174 [====>.........................] - ETA: 2s
 64/174 [==========>...................] - ETA: 1s
 96/174 [===============>..............] - ETA: 1s
128/174 [=====================>........] - ETA: 0s
160/174 [==========================>...] - ETA: 0s
174/174 [==============================] - 3s 16ms/step
Test loss: 1.4938703076592807
Test accuracy: 0.5172413793103449
[[29 18 11]
 [ 0 36 22]
 [14 19 25]]
