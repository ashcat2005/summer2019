Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 11:44:46.323807: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 11:44:46.398979: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 11:44:46.399210: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55cf03c80480 executing computations on platform Host. Devices:
2019-11-07 11:44:46.399261: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
[0.5]
Train on 522 samples, validate on 174 samples
Epoch 1/40

522/522 [==============================] - 31s 59ms/step - loss: 1.0977 - acc: 0.3429 - val_loss: 1.0883 - val_acc: 0.4023
Epoch 2/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0848 - acc: 0.4464 - val_loss: 1.0763 - val_acc: 0.3966
Epoch 3/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0671 - acc: 0.4540 - val_loss: 1.0616 - val_acc: 0.4253
Epoch 4/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0438 - acc: 0.4923 - val_loss: 1.0510 - val_acc: 0.3908
Epoch 5/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0242 - acc: 0.4425 - val_loss: 1.0882 - val_acc: 0.4023
Epoch 6/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0410 - acc: 0.4176 - val_loss: 1.0460 - val_acc: 0.3851
Epoch 7/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9994 - acc: 0.4425 - val_loss: 1.0357 - val_acc: 0.3908
Epoch 8/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9718 - acc: 0.4655 - val_loss: 1.0924 - val_acc: 0.3218
Epoch 9/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0152 - acc: 0.4559 - val_loss: 1.0476 - val_acc: 0.4598
Epoch 10/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9487 - acc: 0.5172 - val_loss: 1.1123 - val_acc: 0.3736
Epoch 11/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0178 - acc: 0.4349 - val_loss: 1.0564 - val_acc: 0.4425
Epoch 12/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9503 - acc: 0.4693 - val_loss: 1.2410 - val_acc: 0.4080
Epoch 13/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0812 - acc: 0.4291 - val_loss: 1.0658 - val_acc: 0.4023
Epoch 14/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9215 - acc: 0.5000 - val_loss: 1.1832 - val_acc: 0.4310
Epoch 15/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0557 - acc: 0.4540 - val_loss: 1.0474 - val_acc: 0.3851
Epoch 16/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8804 - acc: 0.5479 - val_loss: 1.2631 - val_acc: 0.4368
Epoch 17/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0436 - acc: 0.4617 - val_loss: 1.0689 - val_acc: 0.4540
Epoch 18/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8626 - acc: 0.5958 - val_loss: 1.1838 - val_acc: 0.4368
Epoch 19/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9989 - acc: 0.4866 - val_loss: 1.1137 - val_acc: 0.4310
Epoch 20/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8914 - acc: 0.5287 - val_loss: 1.2131 - val_acc: 0.4368
Epoch 21/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9463 - acc: 0.4885 - val_loss: 1.1225 - val_acc: 0.4655
Epoch 22/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8540 - acc: 0.5307 - val_loss: 1.1615 - val_acc: 0.3851
Epoch 23/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9030 - acc: 0.5287 - val_loss: 1.1422 - val_acc: 0.4425
Epoch 24/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8735 - acc: 0.5517 - val_loss: 1.1651 - val_acc: 0.4598
Epoch 25/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8400 - acc: 0.5651 - val_loss: 1.2006 - val_acc: 0.4598
Epoch 26/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8523 - acc: 0.5651 - val_loss: 1.1344 - val_acc: 0.4368
Epoch 27/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8079 - acc: 0.6130 - val_loss: 1.1696 - val_acc: 0.4483
Epoch 28/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8345 - acc: 0.5690 - val_loss: 1.1676 - val_acc: 0.4943
Epoch 29/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7825 - acc: 0.6188 - val_loss: 1.2321 - val_acc: 0.4655
Epoch 30/40

522/522 [==============================] - 28s 54ms/step - loss: 0.8227 - acc: 0.5575 - val_loss: 1.1568 - val_acc: 0.4598
Epoch 31/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7599 - acc: 0.6341 - val_loss: 1.2062 - val_acc: 0.4195
Epoch 32/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7970 - acc: 0.5996 - val_loss: 1.1835 - val_acc: 0.4425
Epoch 33/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7453 - acc: 0.6762 - val_loss: 1.2530 - val_acc: 0.4828
Epoch 34/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7742 - acc: 0.6092 - val_loss: 1.1999 - val_acc: 0.4368
Epoch 35/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7305 - acc: 0.6360 - val_loss: 1.2550 - val_acc: 0.4310
Epoch 36/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7802 - acc: 0.5843 - val_loss: 1.2752 - val_acc: 0.4713
Epoch 37/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7530 - acc: 0.6284 - val_loss: 1.2958 - val_acc: 0.4770
Epoch 38/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7492 - acc: 0.6226 - val_loss: 1.2597 - val_acc: 0.4425
Epoch 39/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7358 - acc: 0.6111 - val_loss: 1.3259 - val_acc: 0.4253
Epoch 40/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7828 - acc: 0.5843 - val_loss: 1.4127 - val_acc: 0.5000
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[8.72119963e-02 5.49118161e-01 3.63669813e-01]
 [8.86886790e-02 5.45133352e-01 3.66178006e-01]
 [8.65982994e-02 5.43117225e-01 3.70284438e-01]
 [3.82850468e-02 6.31184816e-01 3.30530107e-01]
 [1.16617844e-01 5.10740936e-01 3.72641265e-01]
 [5.78962803e-01 4.21027184e-01 1.00506595e-05]
 [9.62025300e-02 5.37755251e-01 3.66042107e-01]
 [1.00998543e-01 5.44152796e-01 3.54848713e-01]
 [9.22132805e-02 5.39550900e-01 3.68235767e-01]
 [8.75728950e-02 5.42167962e-01 3.70259076e-01]
 [1.42011568e-01 5.94197214e-01 2.63791174e-01]
 [4.16422673e-02 7.64570951e-01 1.93786740e-01]
 [7.91827068e-02 5.19108832e-01 4.01708454e-01]
 [8.26073512e-02 7.72387207e-01 1.45005405e-01]
 [9.04258043e-02 4.72648114e-01 4.36925977e-01]
 [1.91111773e-01 5.94981074e-01 2.13907182e-01]
 [1.28157088e-04 2.76449136e-02 9.72226918e-01]
 [8.61313269e-02 5.68619013e-01 3.45249623e-01]
 [9.99698281e-01 4.03837912e-05 2.61334964e-04]
 [9.36854705e-02 5.69609106e-01 3.36705357e-01]
 [5.03432490e-02 5.48186779e-01 4.01469946e-01]
 [1.01491511e-01 5.25531232e-01 3.72977227e-01]
 [8.26876909e-02 7.19052076e-01 1.98260322e-01]
 [8.61390829e-02 6.71481252e-01 2.42379665e-01]
 [8.26876909e-02 7.19052076e-01 1.98260322e-01]
 [9.37439054e-02 5.21064341e-01 3.85191768e-01]
 [1.71794400e-01 4.57570255e-01 3.70635390e-01]
 [3.87759344e-03 7.23167777e-01 2.72954673e-01]
 [5.31129502e-02 6.38464570e-01 3.08422476e-01]
 [9.07670483e-02 5.58961749e-01 3.50271165e-01]
 [9.99999881e-01 6.37421067e-08 1.11012097e-08]
 [8.26876909e-02 7.19052076e-01 1.98260322e-01]
 [4.69857216e-01 2.93584734e-01 2.36558124e-01]
 [1.00193404e-01 4.93126124e-01 4.06680495e-01]
 [6.81208576e-06 3.17244296e-04 9.99675989e-01]
 [6.87254146e-02 6.30691469e-01 3.00583035e-01]
 [8.46399441e-02 5.72095513e-01 3.43264550e-01]
 [4.74627092e-02 4.93604720e-01 4.58932579e-01]
 [5.27155995e-01 3.20791215e-01 1.52052835e-01]
 [1.08866900e-01 5.38248003e-01 3.52885157e-01]
 [7.17298239e-02 9.28269565e-01 5.64996242e-07]
 [4.74627092e-02 4.93604720e-01 4.58932579e-01]
 [2.03165695e-01 2.93785751e-01 5.03048599e-01]
 [9.99849916e-01 3.58634082e-08 1.50027670e-04]
 [9.99849916e-01 3.58634082e-08 1.50027670e-04]
 [1.06661014e-01 5.43845654e-01 3.49493325e-01]
 [6.92387000e-02 6.57751143e-01 2.73010105e-01]
 [9.32573900e-02 5.55072248e-01 3.51670295e-01]
 [5.27155995e-01 3.20791215e-01 1.52052835e-01]
 [9.82907340e-02 5.08432984e-01 3.93276304e-01]
 [1.71794400e-01 4.57570255e-01 3.70635390e-01]
 [9.33137089e-02 5.66379309e-01 3.40306967e-01]
 [3.80151719e-02 6.88720763e-01 2.73264080e-01]
 [1.01408131e-01 5.14211059e-01 3.84380758e-01]
 [1.03302889e-01 5.17204046e-01 3.79492998e-01]
 [7.63829947e-02 7.16301978e-01 2.07315028e-01]
 [1.01730593e-01 5.19397438e-01 3.78871977e-01]
 [8.93279314e-02 7.31214345e-01 1.79457709e-01]
 [6.27921745e-02 4.89896178e-01 4.47311640e-01]
 [9.22132805e-02 5.39550900e-01 3.68235767e-01]
 [8.26876909e-02 7.19052076e-01 1.98260322e-01]
 [2.86300868e-01 5.07416248e-01 2.06282869e-01]
 [1.16635062e-01 4.13678616e-01 4.69686329e-01]
 [9.99895096e-01 1.04700084e-04 1.93333548e-07]
 [3.65594425e-03 6.84851229e-01 3.11492831e-01]
 [9.99999881e-01 6.37421067e-08 1.11012097e-08]
 [7.17298239e-02 9.28269565e-01 5.64996242e-07]
 [3.07845941e-04 9.98515904e-01 1.17624132e-03]
 [4.69857216e-01 2.93584734e-01 2.36558124e-01]
 [1.02996834e-01 5.51800847e-01 3.45202297e-01]
 [9.71473083e-02 5.53211808e-01 3.49640846e-01]
 [5.99778481e-02 3.74675333e-01 5.65346777e-01]
 [4.74627092e-02 4.93604720e-01 4.58932579e-01]
 [7.62742311e-02 5.54143906e-01 3.69581938e-01]
 [1.37817428e-01 3.66784304e-01 4.95398223e-01]
 [3.63757938e-01 3.81960794e-02 5.98046005e-01]
 [4.29496309e-03 7.46568024e-01 2.49136984e-01]
 [1.09162098e-02 1.90954566e-01 7.98129261e-01]
 [8.42481032e-02 5.65333724e-01 3.50418270e-01]
 [3.50319557e-02 6.30985498e-01 3.33982438e-01]
 [1.43612036e-03 6.14494681e-01 3.84069175e-01]
 [7.77351260e-02 5.65892160e-01 3.56372744e-01]
 [1.73318818e-01 5.49988806e-01 2.76692361e-01]
 [7.98374489e-02 5.16390204e-01 4.03772295e-01]
 [1.00202017e-01 5.40104151e-01 3.59693795e-01]
 [8.25474560e-02 5.48452616e-01 3.68999898e-01]
 [9.07085165e-02 5.31205297e-01 3.78086209e-01]
 [9.99999881e-01 6.37421067e-08 1.11012097e-08]
 [1.16617844e-01 5.10740936e-01 3.72641265e-01]
 [9.99895096e-01 1.04700084e-04 1.93333548e-07]
 [5.78962803e-01 4.21027184e-01 1.00506595e-05]
 [9.73777026e-02 5.69719136e-01 3.32903147e-01]
 [5.99778481e-02 3.74675333e-01 5.65346777e-01]
 [3.62686157e-01 2.92749493e-04 6.37021065e-01]
 [7.96225816e-02 5.30673385e-01 3.89704019e-01]
 [8.39924812e-02 5.07155299e-01 4.08852220e-01]
 [8.88907462e-02 5.24823308e-01 3.86285931e-01]
 [9.99698281e-01 4.03837912e-05 2.61334964e-04]
 [8.64554197e-02 5.70122182e-01 3.43422413e-01]
 [9.41936135e-01 3.77376601e-02 2.03261450e-02]
 [9.28733498e-02 5.33267677e-01 3.73859018e-01]
 [9.99998927e-01 1.10267388e-06 5.36861151e-08]
 [8.07933509e-02 5.31499743e-01 3.87706906e-01]
 [8.72715116e-02 5.67476213e-01 3.45252365e-01]
 [5.31582013e-02 6.98228121e-01 2.48613730e-01]
 [9.41936135e-01 3.77376601e-02 2.03261450e-02]
 [1.43612036e-03 6.14494681e-01 3.84069175e-01]
 [1.27625987e-01 8.05389404e-01 6.69846982e-02]
 [4.69857216e-01 2.93584734e-01 2.36558124e-01]
 [4.34839493e-03 7.00716376e-01 2.94935137e-01]
 [8.83914530e-02 5.34595251e-01 3.77013236e-01]
 [8.46399441e-02 5.72095513e-01 3.43264550e-01]
 [1.01491511e-01 5.25531232e-01 3.72977227e-01]
 [1.03852957e-01 5.19765794e-01 3.76381308e-01]
 [8.26876909e-02 7.19052076e-01 1.98260322e-01]
 [1.61910406e-03 9.02958751e-01 9.54220369e-02]
 [1.81393966e-01 5.28413415e-01 2.90192664e-01]
 [9.17526633e-02 5.14674127e-01 3.93573165e-01]
 [9.12587792e-02 5.43821514e-01 3.64919662e-01]
 [9.22132805e-02 5.39550900e-01 3.68235767e-01]
 [6.87254146e-02 6.30691469e-01 3.00583035e-01]
 [2.96062529e-02 5.66765904e-01 4.03627872e-01]
 [9.60628092e-01 3.39579694e-02 5.41399606e-03]
 [8.25474560e-02 5.48452616e-01 3.68999898e-01]
 [8.72290373e-01 7.24677071e-02 5.52419163e-02]
 [9.99849916e-01 3.58634082e-08 1.50027670e-04]
 [5.89855649e-02 4.39157575e-01 5.01856863e-01]
 [5.78962803e-01 4.21027184e-01 1.00506595e-05]
 [8.47316161e-02 5.20530462e-01 3.94737959e-01]
 [1.09189469e-02 4.77154642e-01 5.11926472e-01]
 [8.95022154e-02 5.33330917e-01 3.77166957e-01]
 [7.13852942e-02 3.71026486e-01 5.57588220e-01]
 [2.97375947e-01 3.33822444e-02 6.69241786e-01]
 [9.99232382e-02 5.35145581e-01 3.64931256e-01]
 [3.26907299e-02 1.43445814e-02 9.52964723e-01]
 [1.39698252e-01 5.21174967e-01 3.39126736e-01]
 [9.63867530e-02 5.64792871e-01 3.38820338e-01]
 [1.00000000e+00 2.89937102e-10 2.71199146e-10]
 [1.65463731e-01 4.70169812e-01 3.64366442e-01]
 [1.81393966e-01 5.28413415e-01 2.90192664e-01]
 [8.98054615e-02 2.33486906e-01 6.76707625e-01]
 [7.99076781e-02 5.24637103e-01 3.95455271e-01]
 [8.13814476e-02 5.31573951e-01 3.87044609e-01]
 [1.39958739e-01 5.75264275e-01 2.84777015e-01]
 [1.03095032e-01 5.37746429e-01 3.59158486e-01]
 [1.43612036e-03 6.14494681e-01 3.84069175e-01]
 [3.91755626e-03 6.88435733e-01 3.07646662e-01]
 [1.01001777e-01 5.35302341e-01 3.63695920e-01]
 [1.92063097e-02 5.10691643e-01 4.70102042e-01]
 [9.30469558e-02 5.73892832e-01 3.33060205e-01]
 [9.73935127e-02 5.16965091e-01 3.85641366e-01]
 [9.62025300e-02 5.37755251e-01 3.66042107e-01]
 [9.62960571e-02 5.35786629e-01 3.67917299e-01]
 [8.26876909e-02 7.19052076e-01 1.98260322e-01]
 [9.99849916e-01 3.58634082e-08 1.50027670e-04]
 [7.58735955e-01 1.31969154e-01 1.09294921e-01]
 [5.99778481e-02 3.74675333e-01 5.65346777e-01]
 [9.42488253e-01 5.67149110e-02 7.96803390e-04]
 [7.77351260e-02 5.65892160e-01 3.56372744e-01]
 [9.45515782e-02 5.19704521e-01 3.85743856e-01]
 [6.49342313e-02 6.53343439e-01 2.81722248e-01]
 [9.99895096e-01 1.04700084e-04 1.93333548e-07]
 [4.74627092e-02 4.93604720e-01 4.58932579e-01]
 [8.36685374e-02 5.45878887e-01 3.70452583e-01]
 [9.44281965e-02 5.06718040e-01 3.98853809e-01]
 [9.48960483e-02 5.66292703e-01 3.38811338e-01]
 [3.20573598e-02 4.89408523e-01 4.78534102e-01]
 [9.99698281e-01 4.03837912e-05 2.61334964e-04]
 [1.60464108e-01 4.18135285e-01 4.21400607e-01]
 [9.12711322e-02 6.12474024e-01 2.96254903e-01]
 [9.24386829e-02 5.72924495e-01 3.34636837e-01]
 [8.84516388e-02 5.68762362e-01 3.42785954e-01]
 [8.38838145e-02 5.23848057e-01 3.92268151e-01]
 [9.24690813e-02 5.60148001e-01 3.47383022e-01]]
[1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 2 1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 2 1 1
 1 0 1 1 1 2 0 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 2 0 1 0 1 1 0 1 1 2 1 1
 2 2 1 2 1 1 1 1 1 1 1 1 1 0 1 0 0 1 2 2 1 1 1 0 1 0 1 0 1 1 1 0 1 1 0 1 1
 1 1 1 1 1 1 1 1 1 1 1 0 1 0 0 2 0 1 2 1 2 2 1 2 1 1 0 1 1 2 1 1 1 1 1 1 1
 1 1 1 1 1 1 0 0 2 0 1 1 1 0 1 1 1 1 1 0 2 1 1 1 1 1]

 32/174 [====>.........................] - ETA: 2s
 64/174 [==========>...................] - ETA: 1s
 96/174 [===============>..............] - ETA: 1s
128/174 [=====================>........] - ETA: 0s
160/174 [==========================>...] - ETA: 0s
174/174 [==============================] - 3s 16ms/step
Test loss: 1.5563149726253815
Test accuracy: 0.5344827606760222
[[22 35  1]
 [ 0 56  2]
 [ 7 36 15]]
