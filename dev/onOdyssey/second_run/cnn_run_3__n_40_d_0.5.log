Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 11:44:46.948896: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 11:44:47.051157: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 11:44:47.051412: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55edf4daede0 executing computations on platform Host. Devices:
2019-11-07 11:44:47.051465: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
[0.5]
Train on 522 samples, validate on 174 samples
Epoch 1/40

522/522 [==============================] - 37s 72ms/step - loss: 1.0984 - acc: 0.3333 - val_loss: 1.0731 - val_acc: 0.3678
Epoch 2/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0615 - acc: 0.5460 - val_loss: 1.0453 - val_acc: 0.3736
Epoch 3/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0158 - acc: 0.5307 - val_loss: 1.0282 - val_acc: 0.3736
Epoch 4/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9692 - acc: 0.5326 - val_loss: 1.0295 - val_acc: 0.3736
Epoch 5/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9278 - acc: 0.5575 - val_loss: 1.0396 - val_acc: 0.3851
Epoch 6/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8861 - acc: 0.5594 - val_loss: 1.0468 - val_acc: 0.4253
Epoch 7/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8451 - acc: 0.6571 - val_loss: 1.0687 - val_acc: 0.4598
Epoch 8/40

522/522 [==============================] - 28s 55ms/step - loss: 0.8074 - acc: 0.7280 - val_loss: 1.0954 - val_acc: 0.3908
Epoch 9/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7751 - acc: 0.6379 - val_loss: 1.1108 - val_acc: 0.4540
Epoch 10/40

522/522 [==============================] - 28s 54ms/step - loss: 0.7414 - acc: 0.7720 - val_loss: 1.1319 - val_acc: 0.4943
Epoch 11/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7090 - acc: 0.8084 - val_loss: 1.1585 - val_acc: 0.4655
Epoch 12/40

522/522 [==============================] - 28s 55ms/step - loss: 0.6821 - acc: 0.7146 - val_loss: 1.1759 - val_acc: 0.5000
Epoch 13/40

522/522 [==============================] - 29s 55ms/step - loss: 0.6557 - acc: 0.7759 - val_loss: 1.1833 - val_acc: 0.5115
Epoch 14/40

522/522 [==============================] - 29s 55ms/step - loss: 0.6283 - acc: 0.8065 - val_loss: 1.2068 - val_acc: 0.5805
Epoch 15/40

522/522 [==============================] - 28s 55ms/step - loss: 0.6022 - acc: 0.7931 - val_loss: 1.2098 - val_acc: 0.5977
Epoch 16/40

522/522 [==============================] - 29s 55ms/step - loss: 0.5785 - acc: 0.8257 - val_loss: 1.2080 - val_acc: 0.5632
Epoch 17/40

522/522 [==============================] - 29s 55ms/step - loss: 0.5597 - acc: 0.8467 - val_loss: 1.2311 - val_acc: 0.5632
Epoch 18/40

522/522 [==============================] - 29s 55ms/step - loss: 0.5421 - acc: 0.7874 - val_loss: 1.2171 - val_acc: 0.5920
Epoch 19/40

522/522 [==============================] - 29s 55ms/step - loss: 0.5211 - acc: 0.8602 - val_loss: 1.2259 - val_acc: 0.6494
Epoch 20/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4992 - acc: 0.8602 - val_loss: 1.2414 - val_acc: 0.6207
Epoch 21/40

522/522 [==============================] - 28s 55ms/step - loss: 0.4821 - acc: 0.8276 - val_loss: 1.2396 - val_acc: 0.5920
Epoch 22/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4666 - acc: 0.8889 - val_loss: 1.2634 - val_acc: 0.6782
Epoch 23/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4525 - acc: 0.8755 - val_loss: 1.2701 - val_acc: 0.6264
Epoch 24/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4351 - acc: 0.8640 - val_loss: 1.2663 - val_acc: 0.6667
Epoch 25/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4157 - acc: 0.9061 - val_loss: 1.2762 - val_acc: 0.7069
Epoch 26/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4027 - acc: 0.9042 - val_loss: 1.2845 - val_acc: 0.6437
Epoch 27/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3921 - acc: 0.8946 - val_loss: 1.2962 - val_acc: 0.6667
Epoch 28/40

522/522 [==============================] - 28s 55ms/step - loss: 0.3786 - acc: 0.8946 - val_loss: 1.2816 - val_acc: 0.6207
Epoch 29/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3649 - acc: 0.9310 - val_loss: 1.3058 - val_acc: 0.6494
Epoch 30/40

522/522 [==============================] - 28s 54ms/step - loss: 0.3507 - acc: 0.8908 - val_loss: 1.2904 - val_acc: 0.6782
Epoch 31/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3348 - acc: 0.9272 - val_loss: 1.2884 - val_acc: 0.6782
Epoch 32/40

522/522 [==============================] - 28s 55ms/step - loss: 0.3249 - acc: 0.9387 - val_loss: 1.3054 - val_acc: 0.6609
Epoch 33/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3162 - acc: 0.9042 - val_loss: 1.2898 - val_acc: 0.6322
Epoch 34/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3071 - acc: 0.9521 - val_loss: 1.3099 - val_acc: 0.6839
Epoch 35/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3045 - acc: 0.9234 - val_loss: 1.2871 - val_acc: 0.6264
Epoch 36/40

522/522 [==============================] - 29s 55ms/step - loss: 0.2887 - acc: 0.9502 - val_loss: 1.2792 - val_acc: 0.6897
Epoch 37/40

522/522 [==============================] - 28s 55ms/step - loss: 0.2718 - acc: 0.9349 - val_loss: 1.2676 - val_acc: 0.7126
Epoch 38/40

522/522 [==============================] - 28s 55ms/step - loss: 0.2625 - acc: 0.9483 - val_loss: 1.2676 - val_acc: 0.6609
Epoch 39/40

522/522 [==============================] - 29s 55ms/step - loss: 0.2558 - acc: 0.9617 - val_loss: 1.2743 - val_acc: 0.7069
Epoch 40/40

522/522 [==============================] - 29s 55ms/step - loss: 0.2489 - acc: 0.9291 - val_loss: 1.2534 - val_acc: 0.6609
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[2.49905139e-01 3.49039555e-01 4.01055247e-01]
 [3.54079783e-01 3.02186072e-01 3.43734175e-01]
 [3.36007953e-01 3.02913666e-01 3.61078322e-01]
 [1.58504903e-01 6.58319071e-02 7.75663197e-01]
 [6.85285985e-01 1.07405260e-01 2.07308844e-01]
 [9.94486034e-01 5.51394746e-03 1.46137244e-18]
 [3.34564984e-01 2.86753774e-01 3.78681242e-01]
 [2.47451693e-01 3.62069279e-01 3.90479028e-01]
 [2.36740485e-01 3.96443397e-01 3.66816163e-01]
 [4.37201470e-01 2.09345847e-01 3.53452712e-01]
 [9.28482771e-01 1.96295939e-02 5.18877134e-02]
 [4.30398941e-01 2.88784146e-01 2.80816942e-01]
 [3.79337192e-01 1.28157496e-01 4.92505282e-01]
 [1.18650064e-01 7.68860281e-01 1.12489671e-01]
 [2.93662816e-01 1.06898844e-01 5.99438369e-01]
 [4.97661859e-01 6.52329475e-02 4.37105179e-01]
 [1.09330867e-05 6.69157191e-04 9.99319911e-01]
 [3.36917669e-01 3.68344665e-01 2.94737667e-01]
 [1.00000000e+00 1.17247136e-17 3.30988487e-10]
 [3.69226515e-01 3.02573979e-01 3.28199476e-01]
 [1.02078140e-01 1.92279562e-01 7.05642283e-01]
 [9.08313841e-02 3.75618525e-02 8.71606708e-01]
 [5.23238838e-01 1.22261219e-01 3.54499966e-01]
 [6.31105065e-01 2.59164572e-01 1.09730385e-01]
 [5.23238838e-01 1.22261219e-01 3.54499966e-01]
 [4.11996245e-01 2.16335937e-01 3.71667832e-01]
 [7.18336940e-01 1.22253932e-01 1.59409150e-01]
 [3.76774609e-04 9.67802584e-01 3.18205729e-02]
 [2.76150554e-02 9.05192792e-01 6.71921894e-02]
 [3.29508752e-01 3.68688405e-01 3.01802903e-01]
 [1.00000000e+00 8.22014169e-13 1.87490187e-13]
 [5.23238838e-01 1.22261219e-01 3.54499966e-01]
 [9.96754348e-01 1.82150712e-03 1.42411364e-03]
 [3.32918793e-01 2.70652950e-01 3.96428198e-01]
 [7.77146750e-11 6.95093434e-17 1.00000000e+00]
 [2.37114832e-01 3.93044539e-02 7.23580718e-01]
 [3.57125342e-01 3.49964499e-01 2.92910099e-01]
 [2.82452047e-01 3.02265793e-01 4.15282190e-01]
 [9.82305288e-01 6.19603321e-04 1.70751158e-02]
 [3.50892395e-01 2.09237456e-01 4.39870149e-01]
 [1.55319041e-02 9.84468043e-01 1.80171249e-18]
 [2.82452047e-01 3.02265793e-01 4.15282190e-01]
 [7.12240068e-03 9.77413774e-01 1.54637732e-02]
 [1.00000000e+00 1.54047646e-13 6.40210995e-09]
 [1.00000000e+00 1.54047646e-13 6.40210995e-09]
 [3.55565310e-01 3.08216155e-01 3.36218506e-01]
 [2.61852950e-01 4.02455442e-02 6.97901487e-01]
 [2.82226503e-01 4.34168816e-01 2.83604681e-01]
 [9.82305288e-01 6.19603321e-04 1.70751158e-02]
 [2.71329910e-01 1.91983044e-01 5.36687076e-01]
 [7.18336940e-01 1.22253932e-01 1.59409150e-01]
 [3.47925812e-01 3.26265484e-01 3.25808734e-01]
 [6.85484290e-01 1.26810938e-01 1.87704727e-01]
 [2.92903453e-01 2.62764156e-01 4.44332331e-01]
 [2.74740845e-01 2.18740895e-01 5.06518304e-01]
 [9.63413477e-01 3.00061107e-02 6.58042450e-03]
 [3.95245194e-01 2.33759023e-02 5.81378877e-01]
 [9.69957653e-03 2.62451358e-03 9.87675905e-01]
 [3.83445853e-03 8.04363549e-01 1.91801921e-01]
 [2.36740485e-01 3.96443397e-01 3.66816163e-01]
 [5.23238838e-01 1.22261219e-01 3.54499966e-01]
 [8.94783139e-01 4.71077114e-02 5.81091680e-02]
 [3.06629449e-01 6.11003101e-01 8.23674053e-02]
 [1.00000000e+00 5.42427152e-15 1.41703609e-16]
 [5.13581850e-04 9.70641851e-01 2.88445428e-02]
 [1.00000000e+00 8.22014169e-13 1.87490187e-13]
 [1.55319041e-02 9.84468043e-01 1.80171249e-18]
 [3.80741412e-08 9.99998331e-01 1.69646614e-06]
 [9.96754348e-01 1.82150712e-03 1.42411364e-03]
 [3.13838691e-01 3.90033573e-01 2.96127707e-01]
 [3.45112711e-01 3.48788947e-01 3.06098342e-01]
 [7.75040835e-02 1.78253110e-02 9.04670596e-01]
 [2.82452047e-01 3.02265793e-01 4.15282190e-01]
 [3.85709792e-01 2.50244111e-01 3.64046037e-01]
 [1.79031283e-01 3.90875712e-03 8.17059994e-01]
 [1.00000000e+00 5.03370875e-16 2.01446516e-11]
 [9.27456021e-01 5.55814579e-02 1.69625841e-02]
 [1.20674640e-05 1.29729538e-04 9.99858141e-01]
 [2.50471890e-01 3.30065876e-01 4.19462204e-01]
 [1.17821917e-01 6.05540201e-02 8.21624041e-01]
 [1.74459396e-03 8.96613538e-01 1.01641849e-01]
 [2.99407750e-01 5.55516660e-01 1.45075604e-01]
 [4.93129611e-01 2.44579718e-01 2.62290627e-01]
 [1.82833165e-01 3.18902493e-01 4.98264402e-01]
 [4.74763691e-01 2.01481685e-01 3.23754579e-01]
 [1.11717053e-01 1.47884980e-01 7.40397930e-01]
 [2.34423071e-01 3.48141760e-01 4.17435229e-01]
 [1.00000000e+00 8.22014169e-13 1.87490187e-13]
 [6.85285985e-01 1.07405260e-01 2.07308844e-01]
 [1.00000000e+00 5.42427152e-15 1.41703609e-16]
 [9.94486034e-01 5.51394746e-03 1.46137244e-18]
 [2.92691588e-01 3.60384077e-01 3.46924305e-01]
 [7.75040835e-02 1.78253110e-02 9.04670596e-01]
 [1.45166850e-04 5.49517794e-18 9.99854803e-01]
 [1.69416219e-01 2.75007129e-01 5.55576682e-01]
 [2.33116686e-01 2.47813106e-01 5.19070208e-01]
 [2.40783423e-01 3.70494813e-01 3.88721764e-01]
 [1.00000000e+00 1.17247136e-17 3.30988487e-10]
 [3.78978163e-01 3.09322357e-01 3.11699510e-01]
 [1.00000000e+00 7.79034948e-10 1.23609664e-10]
 [4.72137988e-01 1.94744781e-01 3.33117247e-01]
 [1.00000000e+00 2.00034257e-13 7.99079726e-12]
 [2.84408391e-01 2.58641720e-01 4.56949919e-01]
 [2.91552693e-01 3.43515933e-01 3.64931345e-01]
 [1.87949110e-02 9.57792044e-01 2.34130062e-02]
 [1.00000000e+00 7.79034948e-10 1.23609664e-10]
 [1.74459396e-03 8.96613538e-01 1.01641849e-01]
 [9.95930493e-01 2.02338328e-04 3.86716775e-03]
 [9.96754348e-01 1.82150712e-03 1.42411364e-03]
 [8.85677815e-04 9.70901549e-01 2.82127745e-02]
 [3.43640476e-01 2.83881605e-01 3.72477949e-01]
 [3.57125342e-01 3.49964499e-01 2.92910099e-01]
 [9.08313841e-02 3.75618525e-02 8.71606708e-01]
 [3.43877673e-01 2.70588040e-01 3.85534286e-01]
 [5.23238838e-01 1.22261219e-01 3.54499966e-01]
 [1.28974425e-05 5.33193396e-03 9.94655132e-01]
 [6.00886047e-01 2.71318376e-01 1.27795562e-01]
 [2.62648016e-01 3.75701934e-01 3.61650109e-01]
 [3.38726789e-01 3.08399409e-01 3.52873802e-01]
 [2.36740485e-01 3.96443397e-01 3.66816163e-01]
 [2.37114832e-01 3.93044539e-02 7.23580718e-01]
 [1.75288631e-04 7.80336618e-01 2.19488099e-01]
 [9.98738587e-01 1.25638605e-03 4.96628445e-06]
 [1.11717053e-01 1.47884980e-01 7.40397930e-01]
 [9.99999166e-01 7.42323323e-08 6.58216379e-07]
 [1.00000000e+00 1.54047646e-13 6.40210995e-09]
 [9.72721353e-02 3.95869315e-02 8.63140941e-01]
 [9.94486034e-01 5.51394746e-03 1.46137244e-18]
 [1.80660382e-01 2.91005790e-01 5.28333843e-01]
 [1.32335480e-02 4.91275400e-01 4.95491058e-01]
 [3.47567856e-01 2.83282071e-01 3.69150013e-01]
 [1.60740197e-01 4.52698655e-02 7.93989956e-01]
 [1.00000000e+00 2.38969488e-16 2.34710341e-11]
 [3.60516757e-01 2.64513463e-01 3.74969780e-01]
 [9.97270882e-01 5.47727011e-13 2.72907922e-03]
 [2.20418602e-01 9.24585462e-02 6.87122762e-01]
 [3.44272405e-01 3.82888377e-01 2.72839189e-01]
 [1.00000000e+00 2.93292272e-24 9.77650703e-25]
 [6.79026008e-01 6.42706528e-02 2.56703347e-01]
 [6.00886047e-01 2.71318376e-01 1.27795562e-01]
 [1.19955271e-01 1.47755712e-03 8.78567219e-01]
 [1.63477436e-01 2.50833690e-01 5.85688889e-01]
 [2.64054984e-01 3.22949022e-01 4.12995994e-01]
 [8.76730606e-02 6.22492507e-02 8.50077689e-01]
 [4.25501943e-01 2.38782391e-01 3.35715681e-01]
 [1.74459396e-03 8.96613538e-01 1.01641849e-01]
 [6.36566954e-04 9.67798233e-01 3.15651707e-02]
 [3.70425820e-01 2.61127025e-01 3.68447214e-01]
 [5.07336226e-04 5.25737405e-01 4.73755270e-01]
 [4.51929510e-01 3.07873130e-01 2.40197346e-01]
 [3.30634862e-01 3.19766372e-01 3.49598795e-01]
 [3.34564984e-01 2.86753774e-01 3.78681242e-01]
 [3.09138656e-01 3.83168846e-01 3.07692498e-01]
 [5.23238838e-01 1.22261219e-01 3.54499966e-01]
 [1.00000000e+00 1.54047646e-13 6.40210995e-09]
 [9.99998331e-01 1.82028188e-08 1.63518746e-06]
 [7.75040835e-02 1.78253110e-02 9.04670596e-01]
 [9.99986887e-01 1.30594308e-05 2.17224683e-09]
 [2.99407750e-01 5.55516660e-01 1.45075604e-01]
 [2.32661620e-01 2.92121291e-01 4.75217074e-01]
 [2.58589461e-02 3.85784246e-02 9.35562611e-01]
 [1.00000000e+00 5.42427152e-15 1.41703609e-16]
 [2.82452047e-01 3.02265793e-01 4.15282190e-01]
 [2.02820376e-01 3.56508434e-01 4.40671206e-01]
 [2.13063151e-01 2.74093032e-01 5.12843847e-01]
 [3.35702181e-01 3.69995385e-01 2.94302464e-01]
 [9.20457900e-01 9.66176484e-03 6.98802471e-02]
 [1.00000000e+00 1.17247136e-17 3.30988487e-10]
 [7.99467981e-01 8.60337727e-03 1.91928610e-01]
 [8.52894224e-03 9.71787214e-01 1.96838193e-02]
 [3.88385981e-01 3.88603717e-01 2.23010361e-01]
 [2.97383845e-01 3.54265928e-01 3.48350137e-01]
 [2.06261590e-01 3.48628521e-01 4.45109844e-01]
 [3.82269382e-01 3.00660342e-01 3.17070246e-01]]
[2 0 2 2 0 0 2 2 1 0 0 0 2 1 2 0 2 1 0 0 2 2 0 0 0 0 0 1 1 1 0 0 0 2 2 2 0
 2 0 2 1 2 1 0 0 0 2 1 0 2 0 0 0 2 2 0 2 2 1 1 0 0 1 0 1 0 1 1 0 1 1 2 2 0
 2 0 0 2 2 2 1 1 0 2 0 2 2 0 0 0 0 1 2 2 2 2 2 0 0 0 0 0 2 2 1 0 1 0 0 1 2
 0 2 2 0 2 0 1 2 1 2 1 0 2 0 0 2 0 2 2 2 2 0 2 0 2 1 0 0 0 2 2 2 2 0 1 1 0
 1 0 2 2 1 0 0 0 2 0 1 2 2 0 2 2 2 1 0 0 0 1 1 1 2 0]

 32/174 [====>.........................] - ETA: 2s
 64/174 [==========>...................] - ETA: 2s
 96/174 [===============>..............] - ETA: 1s
128/174 [=====================>........] - ETA: 0s
160/174 [==========================>...] - ETA: 0s
174/174 [==============================] - 3s 19ms/step
Test loss: 1.7967266460944866
Test accuracy: 0.57471264299305
[[41  8  9]
 [11 25 22]
 [21  3 34]]
