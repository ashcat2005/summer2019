Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 11:44:57.141963: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 11:44:57.230841: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 11:44:57.231100: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5573caa87e30 executing computations on platform Host. Devices:
2019-11-07 11:44:57.231168: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
[0.25]
Train on 522 samples, validate on 174 samples
Epoch 1/40

522/522 [==============================] - 32s 61ms/step - loss: 1.0969 - acc: 0.3314 - val_loss: 1.0934 - val_acc: 0.3506
Epoch 2/40

522/522 [==============================] - 29s 55ms/step - loss: 1.0933 - acc: 0.3812 - val_loss: 1.0901 - val_acc: 0.3506
Epoch 3/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0894 - acc: 0.4119 - val_loss: 1.0868 - val_acc: 0.4195
Epoch 4/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0851 - acc: 0.4483 - val_loss: 1.0837 - val_acc: 0.4195
Epoch 5/40

522/522 [==============================] - 28s 55ms/step - loss: 1.0806 - acc: 0.4789 - val_loss: 1.0810 - val_acc: 0.4195
Epoch 6/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0760 - acc: 0.4617 - val_loss: 1.0788 - val_acc: 0.4080
Epoch 7/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0713 - acc: 0.4521 - val_loss: 1.0774 - val_acc: 0.4138
Epoch 8/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0665 - acc: 0.4540 - val_loss: 1.0769 - val_acc: 0.4080
Epoch 9/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0618 - acc: 0.4502 - val_loss: 1.0776 - val_acc: 0.4138
Epoch 10/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0571 - acc: 0.4540 - val_loss: 1.0796 - val_acc: 0.4138
Epoch 11/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0524 - acc: 0.4617 - val_loss: 1.0832 - val_acc: 0.4195
Epoch 12/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0479 - acc: 0.4655 - val_loss: 1.0881 - val_acc: 0.3966
Epoch 13/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0435 - acc: 0.4693 - val_loss: 1.0944 - val_acc: 0.4080
Epoch 14/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0391 - acc: 0.4693 - val_loss: 1.1019 - val_acc: 0.4138
Epoch 15/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0348 - acc: 0.4828 - val_loss: 1.1103 - val_acc: 0.4195
Epoch 16/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0304 - acc: 0.4789 - val_loss: 1.1195 - val_acc: 0.4253
Epoch 17/40

522/522 [==============================] - 28s 55ms/step - loss: 1.0259 - acc: 0.4866 - val_loss: 1.1293 - val_acc: 0.4310
Epoch 18/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0212 - acc: 0.4885 - val_loss: 1.1396 - val_acc: 0.4310
Epoch 19/40

522/522 [==============================] - 29s 55ms/step - loss: 1.0163 - acc: 0.4770 - val_loss: 1.1503 - val_acc: 0.4195
Epoch 20/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0114 - acc: 0.4655 - val_loss: 1.1615 - val_acc: 0.4310
Epoch 21/40

522/522 [==============================] - 29s 55ms/step - loss: 1.0063 - acc: 0.4598 - val_loss: 1.1731 - val_acc: 0.4598
Epoch 22/40

522/522 [==============================] - 28s 54ms/step - loss: 1.0013 - acc: 0.4617 - val_loss: 1.1852 - val_acc: 0.4598
Epoch 23/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9965 - acc: 0.4636 - val_loss: 1.1977 - val_acc: 0.4483
Epoch 24/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9917 - acc: 0.4693 - val_loss: 1.2099 - val_acc: 0.4483
Epoch 25/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9870 - acc: 0.4655 - val_loss: 1.2092 - val_acc: 0.4483
Epoch 26/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9823 - acc: 0.4693 - val_loss: 1.2069 - val_acc: 0.4540
Epoch 27/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9774 - acc: 0.4770 - val_loss: 1.2048 - val_acc: 0.4598
Epoch 28/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9725 - acc: 0.4885 - val_loss: 1.2031 - val_acc: 0.4540
Epoch 29/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9676 - acc: 0.5057 - val_loss: 1.2017 - val_acc: 0.4483
Epoch 30/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9628 - acc: 0.5115 - val_loss: 1.2006 - val_acc: 0.4483
Epoch 31/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9580 - acc: 0.5115 - val_loss: 1.1997 - val_acc: 0.4483
Epoch 32/40

522/522 [==============================] - 28s 55ms/step - loss: 0.9531 - acc: 0.5153 - val_loss: 1.1995 - val_acc: 0.4598
Epoch 33/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9480 - acc: 0.5230 - val_loss: 1.2000 - val_acc: 0.4598
Epoch 34/40

522/522 [==============================] - 28s 55ms/step - loss: 0.9426 - acc: 0.5249 - val_loss: 1.2014 - val_acc: 0.4598
Epoch 35/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9371 - acc: 0.5287 - val_loss: 1.2034 - val_acc: 0.4598
Epoch 36/40

522/522 [==============================] - 28s 55ms/step - loss: 0.9313 - acc: 0.5307 - val_loss: 1.2062 - val_acc: 0.4770
Epoch 37/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9252 - acc: 0.5402 - val_loss: 1.2096 - val_acc: 0.5000
Epoch 38/40

522/522 [==============================] - 28s 55ms/step - loss: 0.9191 - acc: 0.5364 - val_loss: 1.2134 - val_acc: 0.4655
Epoch 39/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9130 - acc: 0.5345 - val_loss: 1.2172 - val_acc: 0.4598
Epoch 40/40

522/522 [==============================] - 28s 54ms/step - loss: 0.9067 - acc: 0.5364 - val_loss: 1.2207 - val_acc: 0.4598
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[3.06468487e-01 3.60145003e-01 3.33386540e-01]
 [2.89730519e-01 3.74124616e-01 3.36144894e-01]
 [2.89916754e-01 3.74601603e-01 3.35481703e-01]
 [1.95757166e-01 4.27256197e-01 3.76986682e-01]
 [3.22527647e-01 2.81735122e-01 3.95737261e-01]
 [9.91472960e-01 1.14328170e-04 8.41275230e-03]
 [3.00377846e-01 3.50624561e-01 3.48997533e-01]
 [3.08048159e-01 3.17722529e-01 3.74229312e-01]
 [3.18118483e-01 3.65226060e-01 3.16655427e-01]
 [3.04808974e-01 3.43017042e-01 3.52173984e-01]
 [3.58121693e-01 4.01736945e-01 2.40141347e-01]
 [2.89258897e-01 3.90065521e-01 3.20675582e-01]
 [3.02759916e-01 3.39227676e-01 3.58012378e-01]
 [2.72337854e-01 4.64225531e-01 2.63436645e-01]
 [2.22330540e-01 3.51701081e-01 4.25968319e-01]
 [2.88439423e-01 4.83556479e-01 2.28004083e-01]
 [7.36590847e-03 4.01230417e-02 9.52511072e-01]
 [3.21308553e-01 3.00888479e-01 3.77802968e-01]
 [8.48493755e-01 6.91934153e-02 8.23127851e-02]
 [2.86402106e-01 3.34576398e-01 3.79021555e-01]
 [2.13353038e-01 3.99910212e-01 3.86736691e-01]
 [2.31120676e-01 3.16017568e-01 4.52861726e-01]
 [2.92923868e-01 3.96802425e-01 3.10273707e-01]
 [1.87024176e-01 3.90311480e-01 4.22664285e-01]
 [2.92923868e-01 3.96802425e-01 3.10273707e-01]
 [2.89907664e-01 3.29492748e-01 3.80599588e-01]
 [2.93304205e-01 4.60513890e-01 2.46181816e-01]
 [3.39246184e-01 4.31231111e-01 2.29522735e-01]
 [2.87917614e-01 3.96732926e-01 3.15349460e-01]
 [2.88668782e-01 3.33325744e-01 3.78005534e-01]
 [8.16084623e-01 1.53452486e-08 1.83915392e-01]
 [2.92923868e-01 3.96802425e-01 3.10273707e-01]
 [4.08800751e-01 3.02575171e-01 2.88624078e-01]
 [3.00190121e-01 3.53854835e-01 3.45955044e-01]
 [6.41267616e-06 5.49224433e-06 9.99988079e-01]
 [2.83562124e-01 4.18786943e-01 2.97650933e-01]
 [3.22170198e-01 3.01679462e-01 3.76150310e-01]
 [3.14415455e-01 3.83387208e-01 3.02197367e-01]
 [5.95550716e-01 2.31714427e-01 1.72734931e-01]
 [2.92109311e-01 3.39621156e-01 3.68269473e-01]
 [8.01590532e-02 2.23925308e-05 9.19818521e-01]
 [3.14415455e-01 3.83387208e-01 3.02197367e-01]
 [3.45750183e-01 2.97476888e-01 3.56772929e-01]
 [9.66592610e-01 9.62826423e-04 3.24445181e-02]
 [9.66592610e-01 9.62826423e-04 3.24445181e-02]
 [2.94329256e-01 3.59798014e-01 3.45872730e-01]
 [2.10837230e-01 3.86322439e-01 4.02840346e-01]
 [2.70529658e-01 3.59211743e-01 3.70258570e-01]
 [5.95550716e-01 2.31714427e-01 1.72734931e-01]
 [3.03720951e-01 3.47549766e-01 3.48729312e-01]
 [2.93304205e-01 4.60513890e-01 2.46181816e-01]
 [3.00249040e-01 3.43017966e-01 3.56732935e-01]
 [2.89251685e-01 4.71132576e-01 2.39615753e-01]
 [2.99051136e-01 3.42726201e-01 3.58222753e-01]
 [3.07795882e-01 3.53908360e-01 3.38295758e-01]
 [2.82271653e-01 4.08062279e-01 3.09666067e-01]
 [2.29678333e-01 4.08302933e-01 3.62018704e-01]
 [6.86235726e-01 2.49116197e-01 6.46480992e-02]
 [1.91327617e-01 3.83926183e-01 4.24746186e-01]
 [3.18118483e-01 3.65226060e-01 3.16655427e-01]
 [2.92923868e-01 3.96802425e-01 3.10273707e-01]
 [3.73476297e-01 4.06817734e-01 2.19705909e-01]
 [3.50248635e-01 3.43934000e-01 3.05817366e-01]
 [9.04163480e-01 9.56505015e-02 1.86027552e-04]
 [3.38808089e-01 4.25021261e-01 2.36170664e-01]
 [8.16084623e-01 1.53452486e-08 1.83915392e-01]
 [8.01590532e-02 2.23925308e-05 9.19818521e-01]
 [9.98609126e-01 1.39093213e-03 8.98715857e-09]
 [4.08800751e-01 3.02575171e-01 2.88624078e-01]
 [2.98241496e-01 3.40785086e-01 3.60973388e-01]
 [2.90917277e-01 3.66503268e-01 3.42579514e-01]
 [3.36641401e-01 2.41926908e-01 4.21431690e-01]
 [3.14415455e-01 3.83387208e-01 3.02197367e-01]
 [3.02241594e-01 3.52327615e-01 3.45430851e-01]
 [3.54525656e-01 2.36616418e-01 4.08857852e-01]
 [1.89532172e-02 9.80858505e-01 1.88204765e-04]
 [3.39779615e-01 4.62197185e-01 1.98023230e-01]
 [4.17565316e-01 2.16394559e-01 3.66040111e-01]
 [3.16598266e-01 3.60628992e-01 3.22772771e-01]
 [1.93374589e-01 4.35085684e-01 3.71539682e-01]
 [1.27133131e-01 4.05939251e-01 4.66927648e-01]
 [3.14830810e-01 3.18321407e-01 3.66847754e-01]
 [2.78850555e-01 4.59192514e-01 2.61956930e-01]
 [2.61179030e-01 4.01042014e-01 3.37778956e-01]
 [3.04837734e-01 3.52341205e-01 3.42821002e-01]
 [2.78237373e-01 3.93151402e-01 3.28611165e-01]
 [2.72496611e-01 3.85290951e-01 3.42212409e-01]
 [8.16084623e-01 1.53452486e-08 1.83915392e-01]
 [3.22527647e-01 2.81735122e-01 3.95737261e-01]
 [9.04163480e-01 9.56505015e-02 1.86027552e-04]
 [9.91472960e-01 1.14328170e-04 8.41275230e-03]
 [3.09763610e-01 3.52910995e-01 3.37325454e-01]
 [3.36641401e-01 2.41926908e-01 4.21431690e-01]
 [9.52548862e-01 5.51582991e-17 4.74512167e-02]
 [2.69496858e-01 3.61331105e-01 3.69172037e-01]
 [3.11346740e-01 3.58573496e-01 3.30079764e-01]
 [2.92199403e-01 3.45319748e-01 3.62480849e-01]
 [8.48493755e-01 6.91934153e-02 8.23127851e-02]
 [3.11102986e-01 3.40166479e-01 3.48730475e-01]
 [9.03481305e-01 6.56513553e-14 9.65186805e-02]
 [2.93974936e-01 3.69633526e-01 3.36391538e-01]
 [9.99760449e-01 2.30260543e-04 9.25996210e-06]
 [3.06095123e-01 3.22663218e-01 3.71241629e-01]
 [3.02247375e-01 3.42097700e-01 3.55654925e-01]
 [2.79175073e-01 4.11705732e-01 3.09119254e-01]
 [9.03481305e-01 6.56513553e-14 9.65186805e-02]
 [1.27133131e-01 4.05939251e-01 4.66927648e-01]
 [2.03009173e-01 1.04622751e-01 6.92368031e-01]
 [4.08800751e-01 3.02575171e-01 2.88624078e-01]
 [3.35499316e-01 4.30147231e-01 2.34353438e-01]
 [3.02082539e-01 3.42375398e-01 3.55542064e-01]
 [3.22170198e-01 3.01679462e-01 3.76150310e-01]
 [2.31120676e-01 3.16017568e-01 4.52861726e-01]
 [2.79354930e-01 3.66778731e-01 3.53866339e-01]
 [2.92923868e-01 3.96802425e-01 3.10273707e-01]
 [1.56652451e-01 1.73109770e-01 6.70237839e-01]
 [3.02645206e-01 4.05038565e-01 2.92316228e-01]
 [2.99521059e-01 3.22079211e-01 3.78399760e-01]
 [3.03588301e-01 3.45626861e-01 3.50784868e-01]
 [3.18118483e-01 3.65226060e-01 3.16655427e-01]
 [2.83562124e-01 4.18786943e-01 2.97650933e-01]
 [2.90407687e-01 3.57908577e-01 3.51683795e-01]
 [8.21940184e-01 1.14488274e-01 6.35715276e-02]
 [2.78237373e-01 3.93151402e-01 3.28611165e-01]
 [5.22588849e-01 3.80681420e-04 4.77030486e-01]
 [9.66592610e-01 9.62826423e-04 3.24445181e-02]
 [1.96692541e-01 3.76258373e-01 4.27049041e-01]
 [9.91472960e-01 1.14328170e-04 8.41275230e-03]
 [2.97505289e-01 3.68477285e-01 3.34017456e-01]
 [1.64417237e-01 4.25448328e-01 4.10134405e-01]
 [2.97086447e-01 3.40133578e-01 3.62779945e-01]
 [3.18735510e-01 3.19023877e-01 3.62240583e-01]
 [8.67315307e-02 9.12617564e-01 6.50929229e-04]
 [3.10974121e-01 3.47213626e-01 3.41812223e-01]
 [2.09570918e-02 3.05658160e-03 9.75986302e-01]
 [2.31044561e-01 5.07747531e-01 2.61207879e-01]
 [3.17236602e-01 3.41530949e-01 3.41232419e-01]
 [9.91614461e-01 7.68312393e-03 7.02393474e-04]
 [3.21808755e-01 3.03095251e-01 3.75095934e-01]
 [3.02645206e-01 4.05038565e-01 2.92316228e-01]
 [5.20983696e-01 1.01184942e-01 3.77831370e-01]
 [2.70006716e-01 3.62080127e-01 3.67913097e-01]
 [2.82569557e-01 3.59136224e-01 3.58294219e-01]
 [2.81349957e-01 4.88712132e-01 2.29937911e-01]
 [3.11737806e-01 3.34346324e-01 3.53915900e-01]
 [1.27133131e-01 4.05939251e-01 4.66927648e-01]
 [3.37507278e-01 4.26480204e-01 2.36012533e-01]
 [3.11175197e-01 3.47036332e-01 3.41788441e-01]
 [3.32735658e-01 3.85208458e-01 2.82055944e-01]
 [3.01735997e-01 3.34902704e-01 3.63361269e-01]
 [2.95578361e-01 3.54242980e-01 3.50178599e-01]
 [3.00377846e-01 3.50624561e-01 3.48997533e-01]
 [2.73066431e-01 3.57035875e-01 3.69897693e-01]
 [2.92923868e-01 3.96802425e-01 3.10273707e-01]
 [9.66592610e-01 9.62826423e-04 3.24445181e-02]
 [6.32814944e-01 2.67615318e-01 9.95697677e-02]
 [3.36641401e-01 2.41926908e-01 4.21431690e-01]
 [9.92564261e-01 7.13271182e-03 3.03058274e-04]
 [3.14830810e-01 3.18321407e-01 3.66847754e-01]
 [3.31708550e-01 3.16204697e-01 3.52086723e-01]
 [2.36708134e-01 4.62057620e-01 3.01234245e-01]
 [9.04163480e-01 9.56505015e-02 1.86027552e-04]
 [3.14415455e-01 3.83387208e-01 3.02197367e-01]
 [2.65374750e-01 4.04716551e-01 3.29908669e-01]
 [3.07843804e-01 3.32323015e-01 3.59833241e-01]
 [3.05811733e-01 3.31798136e-01 3.62390131e-01]
 [2.83460647e-01 3.55334103e-01 3.61205280e-01]
 [8.48493755e-01 6.91934153e-02 8.23127851e-02]
 [2.74665862e-01 3.91167313e-01 3.34166884e-01]
 [3.37429166e-01 3.21371049e-01 3.41199815e-01]
 [2.89359063e-01 3.33029032e-01 3.77611876e-01]
 [3.12311321e-01 3.45789999e-01 3.41898739e-01]
 [2.61163294e-01 4.03335989e-01 3.35500687e-01]
 [2.88874239e-01 3.29027027e-01 3.82098705e-01]]
[1 1 1 1 2 0 1 2 1 2 1 1 2 1 2 1 2 2 0 2 1 2 1 2 1 2 1 1 1 2 0 1 0 1 2 1 2
 1 0 2 2 1 2 0 0 1 2 2 0 2 1 2 1 2 1 1 1 0 2 1 1 1 0 0 1 0 2 0 0 2 1 2 1 1
 2 1 1 0 1 1 2 2 1 1 1 1 1 0 2 0 0 1 2 0 2 1 2 0 2 0 1 0 2 2 1 0 2 2 0 1 2
 2 2 1 1 2 1 2 2 1 1 1 0 1 0 0 2 0 1 1 2 2 1 1 2 1 1 0 2 1 0 2 1 1 2 2 1 1
 1 2 1 1 2 1 0 0 2 0 2 2 1 0 1 1 2 2 2 0 1 2 2 1 1 2]

 32/174 [====>.........................] - ETA: 2s
 64/174 [==========>...................] - ETA: 1s
 96/174 [===============>..............] - ETA: 1s
128/174 [=====================>........] - ETA: 0s
160/174 [==========================>...] - ETA: 0s
174/174 [==============================] - 3s 15ms/step
Test loss: 1.2807311970612099
Test accuracy: 0.4022988510885458
[[24 22 12]
 [ 1 26 31]
 [10 28 20]]
