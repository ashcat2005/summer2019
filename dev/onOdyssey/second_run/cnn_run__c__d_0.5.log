Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 09:06:38.980841: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 09:06:38.984684: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 09:06:38.984790: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x564e89f1bfb0 executing computations on platform Host. Devices:
2019-11-07 09:06:38.984809: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
[0.5]
Train on 870 samples, validate on 290 samples
Epoch 1/35

870/870 [==============================] - 56s 64ms/step - loss: 1.6099 - acc: 0.2540 - val_loss: 1.6004 - val_acc: 0.2414
Epoch 2/35

870/870 [==============================] - 52s 60ms/step - loss: 1.5956 - acc: 0.3954 - val_loss: 1.5851 - val_acc: 0.2586
Epoch 3/35

870/870 [==============================] - 52s 60ms/step - loss: 1.5751 - acc: 0.3943 - val_loss: 1.5623 - val_acc: 0.2966
Epoch 4/35

870/870 [==============================] - 52s 59ms/step - loss: 1.5459 - acc: 0.3885 - val_loss: 1.5332 - val_acc: 0.4000
Epoch 5/35

870/870 [==============================] - 52s 59ms/step - loss: 1.5089 - acc: 0.5115 - val_loss: 1.5027 - val_acc: 0.3897
Epoch 6/35

870/870 [==============================] - 52s 60ms/step - loss: 1.4671 - acc: 0.4966 - val_loss: 1.4738 - val_acc: 0.3241
Epoch 7/35

870/870 [==============================] - 52s 59ms/step - loss: 1.4296 - acc: 0.3598 - val_loss: 1.5156 - val_acc: 0.2483
Epoch 8/35

870/870 [==============================] - 52s 60ms/step - loss: 1.4459 - acc: 0.3230 - val_loss: 1.4590 - val_acc: 0.3172
Epoch 9/35

870/870 [==============================] - 52s 59ms/step - loss: 1.3776 - acc: 0.3943 - val_loss: 1.4721 - val_acc: 0.3138
Epoch 10/35

870/870 [==============================] - 52s 60ms/step - loss: 1.3842 - acc: 0.3138 - val_loss: 1.4195 - val_acc: 0.2862
Epoch 11/35

870/870 [==============================] - 52s 59ms/step - loss: 1.3049 - acc: 0.4184 - val_loss: 1.4545 - val_acc: 0.4172
Epoch 12/35

870/870 [==============================] - 52s 60ms/step - loss: 1.3091 - acc: 0.5080 - val_loss: 1.4383 - val_acc: 0.3759
Epoch 13/35

870/870 [==============================] - 52s 60ms/step - loss: 1.2589 - acc: 0.4690 - val_loss: 1.4160 - val_acc: 0.3690
Epoch 14/35

870/870 [==============================] - 52s 60ms/step - loss: 1.2227 - acc: 0.4471 - val_loss: 1.4086 - val_acc: 0.3690
Epoch 15/35

870/870 [==============================] - 52s 59ms/step - loss: 1.2029 - acc: 0.4540 - val_loss: 1.3894 - val_acc: 0.4138
Epoch 16/35

870/870 [==============================] - 52s 59ms/step - loss: 1.1491 - acc: 0.5460 - val_loss: 1.4356 - val_acc: 0.3793
Epoch 17/35

870/870 [==============================] - 52s 59ms/step - loss: 1.1414 - acc: 0.5034 - val_loss: 1.4206 - val_acc: 0.3931
Epoch 18/35

870/870 [==============================] - 51s 59ms/step - loss: 1.1032 - acc: 0.5621 - val_loss: 1.3989 - val_acc: 0.4655
Epoch 19/35

870/870 [==============================] - 52s 59ms/step - loss: 1.0653 - acc: 0.6126 - val_loss: 1.4025 - val_acc: 0.3931
Epoch 20/35

870/870 [==============================] - 51s 59ms/step - loss: 1.0511 - acc: 0.5678 - val_loss: 1.3887 - val_acc: 0.4897
Epoch 21/35

870/870 [==============================] - 52s 59ms/step - loss: 1.0047 - acc: 0.6575 - val_loss: 1.4233 - val_acc: 0.3897
Epoch 22/35

870/870 [==============================] - 52s 59ms/step - loss: 0.9852 - acc: 0.5632 - val_loss: 1.4207 - val_acc: 0.3931
Epoch 23/35

870/870 [==============================] - 52s 59ms/step - loss: 0.9589 - acc: 0.5816 - val_loss: 1.3921 - val_acc: 0.5069
Epoch 24/35

870/870 [==============================] - 52s 59ms/step - loss: 0.9204 - acc: 0.6460 - val_loss: 1.4194 - val_acc: 0.5069
Epoch 25/35

870/870 [==============================] - 52s 59ms/step - loss: 0.9123 - acc: 0.6724 - val_loss: 1.4047 - val_acc: 0.5138
Epoch 26/35

870/870 [==============================] - 52s 59ms/step - loss: 0.8760 - acc: 0.6954 - val_loss: 1.4235 - val_acc: 0.4931
Epoch 27/35

870/870 [==============================] - 52s 59ms/step - loss: 0.8507 - acc: 0.6253 - val_loss: 1.4332 - val_acc: 0.4655
Epoch 28/35

870/870 [==============================] - 51s 59ms/step - loss: 0.8347 - acc: 0.6310 - val_loss: 1.4345 - val_acc: 0.4724
Epoch 29/35

870/870 [==============================] - 51s 59ms/step - loss: 0.8017 - acc: 0.6552 - val_loss: 1.4542 - val_acc: 0.5069
Epoch 30/35

870/870 [==============================] - 51s 59ms/step - loss: 0.7886 - acc: 0.7115 - val_loss: 1.4947 - val_acc: 0.5379
Epoch 31/35

870/870 [==============================] - 51s 59ms/step - loss: 0.7683 - acc: 0.6874 - val_loss: 1.4752 - val_acc: 0.5690
Epoch 32/35

870/870 [==============================] - 52s 59ms/step - loss: 0.7545 - acc: 0.7563 - val_loss: 1.5881 - val_acc: 0.5034
Epoch 33/35

870/870 [==============================] - 51s 59ms/step - loss: 0.7708 - acc: 0.6575 - val_loss: 1.5137 - val_acc: 0.4793
Epoch 34/35

870/870 [==============================] - 52s 59ms/step - loss: 0.7411 - acc: 0.7069 - val_loss: 1.5240 - val_acc: 0.5655
Epoch 35/35

870/870 [==============================] - 51s 59ms/step - loss: 0.6890 - acc: 0.7851 - val_loss: 1.5865 - val_acc: 0.5138
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[6.5492891e-02 1.8641150e-02 4.0910792e-02 3.6144391e-01 5.1351118e-01]
 [1.8038575e-01 6.6793388e-01 1.4740142e-01 2.1521859e-03 2.1267468e-03]
 [1.1210896e-01 1.7838471e-02 5.2884065e-02 2.7821088e-01 5.3895772e-01]
 ...
 [8.1431055e-03 1.7997842e-02 7.8815418e-01 1.8206292e-01 3.6419020e-03]
 [7.0110410e-01 1.2664326e-01 1.7225264e-01 1.8525894e-08 1.3450191e-10]
 [8.5524954e-02 1.8566480e-02 6.9620848e-02 2.7474305e-01 5.5154467e-01]]
[4 1 4 0 2 4 0 0 4 1 0 0 3 4 4 0 2 4 0 4 2 2 0 4 4 1 0 4 2 4 3 0 4 0 4 4 4
 4 0 0 4 4 4 1 4 3 2 3 3 1 4 0 0 0 0 4 0 3 4 4 4 0 2 2 4 4 4 4 3 4 4 4 2 2
 0 4 4 3 1 4 4 0 4 1 1 4 4 4 4 0 4 0 4 4 4 4 0 0 0 4 4 4 2 3 4 4 4 4 2 4 4
 4 2 2 1 2 4 4 4 4 3 4 4 4 4 3 2 1 3 3 2 4 4 4 0 4 4 2 3 2 4 1 3 0 0 1 4 4
 1 4 4 0 4 2 0 0 4 4 2 4 4 3 2 2 1 4 0 4 3 4 3 3 4 2 4 3 3 3 4 1 1 4 2 4 4
 0 4 2 4 4 4 4 2 3 2 3 4 4 0 0 4 0 4 3 4 4 4 4 4 4 3 4 4 0 4 2 4 4 2 4 0 2
 4 4 2 3 2 3 4 4 4 4 4 4 4 4 4 0 4 4 0 4 4 3 4 0 3 0 4 4 0 4 4 4 4 4 4 3 4
 0 0 3 0 2 4 4 4 0 4 4 4 2 2 4 3 0 4 4 4 4 3 4 4 0 1 4 4 2 0 4]

 32/290 [==>...........................] - ETA: 4s
 64/290 [=====>........................] - ETA: 3s
 96/290 [========>.....................] - ETA: 3s
128/290 [============>.................] - ETA: 2s
160/290 [===============>..............] - ETA: 2s
192/290 [==================>...........] - ETA: 1s
224/290 [======================>.......] - ETA: 1s
256/290 [=========================>....] - ETA: 0s
288/290 [============================>.] - ETA: 0s
290/290 [==============================] - 5s 17ms/step
Test loss: 1.9665105079782421
Test accuracy: 0.4413793103448276
[[28  5 10  4 11]
 [ 4  9  6  0 39]
 [18  3 18 15  4]
 [ 1  0  3 15 39]
 [ 0  0  0  0 58]]
