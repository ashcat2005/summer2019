Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 11:44:45.717444: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 11:44:45.834974: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 11:44:45.835233: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55b52925c620 executing computations on platform Host. Devices:
2019-11-07 11:44:45.835285: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
[0.25]
Train on 522 samples, validate on 174 samples
Epoch 1/40

522/522 [==============================] - 38s 72ms/step - loss: 1.0986 - acc: 0.3276 - val_loss: 1.0688 - val_acc: 0.3621
Epoch 2/40

522/522 [==============================] - 28s 55ms/step - loss: 1.0564 - acc: 0.5383 - val_loss: 1.0384 - val_acc: 0.3736
Epoch 3/40

522/522 [==============================] - 29s 55ms/step - loss: 1.0045 - acc: 0.5479 - val_loss: 1.0264 - val_acc: 0.3736
Epoch 4/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9537 - acc: 0.5517 - val_loss: 1.0394 - val_acc: 0.4080
Epoch 5/40

522/522 [==============================] - 29s 55ms/step - loss: 0.9077 - acc: 0.5939 - val_loss: 1.0606 - val_acc: 0.3793
Epoch 6/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8653 - acc: 0.5747 - val_loss: 1.0840 - val_acc: 0.3966
Epoch 7/40

522/522 [==============================] - 29s 55ms/step - loss: 0.8257 - acc: 0.6475 - val_loss: 1.1108 - val_acc: 0.4310
Epoch 8/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7846 - acc: 0.6705 - val_loss: 1.1318 - val_acc: 0.3908
Epoch 9/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7513 - acc: 0.6552 - val_loss: 1.1517 - val_acc: 0.4713
Epoch 10/40

522/522 [==============================] - 29s 55ms/step - loss: 0.7196 - acc: 0.7586 - val_loss: 1.1704 - val_acc: 0.5172
Epoch 11/40

522/522 [==============================] - 29s 55ms/step - loss: 0.6867 - acc: 0.7874 - val_loss: 1.1891 - val_acc: 0.4828
Epoch 12/40

522/522 [==============================] - 29s 55ms/step - loss: 0.6612 - acc: 0.7261 - val_loss: 1.2016 - val_acc: 0.5632
Epoch 13/40

522/522 [==============================] - 29s 55ms/step - loss: 0.6314 - acc: 0.8084 - val_loss: 1.2147 - val_acc: 0.5690
Epoch 14/40

522/522 [==============================] - 29s 55ms/step - loss: 0.6062 - acc: 0.8103 - val_loss: 1.2248 - val_acc: 0.5345
Epoch 15/40

522/522 [==============================] - 29s 55ms/step - loss: 0.5841 - acc: 0.8257 - val_loss: 1.2393 - val_acc: 0.5920
Epoch 16/40

522/522 [==============================] - 29s 55ms/step - loss: 0.5599 - acc: 0.8065 - val_loss: 1.2385 - val_acc: 0.5920
Epoch 17/40

522/522 [==============================] - 29s 55ms/step - loss: 0.5387 - acc: 0.8621 - val_loss: 1.2456 - val_acc: 0.6034
Epoch 18/40

522/522 [==============================] - 29s 55ms/step - loss: 0.5182 - acc: 0.8736 - val_loss: 1.2651 - val_acc: 0.6092
Epoch 19/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4997 - acc: 0.8238 - val_loss: 1.2620 - val_acc: 0.6034
Epoch 20/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4831 - acc: 0.8736 - val_loss: 1.2880 - val_acc: 0.6149
Epoch 21/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4634 - acc: 0.8429 - val_loss: 1.2881 - val_acc: 0.6207
Epoch 22/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4451 - acc: 0.8870 - val_loss: 1.3007 - val_acc: 0.6609
Epoch 23/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4295 - acc: 0.9023 - val_loss: 1.3113 - val_acc: 0.6437
Epoch 24/40

522/522 [==============================] - 29s 55ms/step - loss: 0.4121 - acc: 0.9004 - val_loss: 1.3147 - val_acc: 0.6322
Epoch 25/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3967 - acc: 0.9080 - val_loss: 1.3219 - val_acc: 0.6667
Epoch 26/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3837 - acc: 0.9061 - val_loss: 1.3231 - val_acc: 0.6092
Epoch 27/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3723 - acc: 0.9215 - val_loss: 1.3776 - val_acc: 0.6092
Epoch 28/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3778 - acc: 0.8525 - val_loss: 1.3442 - val_acc: 0.5632
Epoch 29/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3800 - acc: 0.8640 - val_loss: 1.3320 - val_acc: 0.6667
Epoch 30/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3337 - acc: 0.9042 - val_loss: 1.3610 - val_acc: 0.6494
Epoch 31/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3396 - acc: 0.8716 - val_loss: 1.3120 - val_acc: 0.6207
Epoch 32/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3189 - acc: 0.9425 - val_loss: 1.3108 - val_acc: 0.6149
Epoch 33/40

522/522 [==============================] - 29s 55ms/step - loss: 0.3116 - acc: 0.9444 - val_loss: 1.3186 - val_acc: 0.6954
Epoch 34/40

522/522 [==============================] - 29s 55ms/step - loss: 0.2981 - acc: 0.9138 - val_loss: 1.3206 - val_acc: 0.6782
Epoch 35/40

522/522 [==============================] - 29s 55ms/step - loss: 0.2920 - acc: 0.9061 - val_loss: 1.2919 - val_acc: 0.6552
Epoch 36/40

522/522 [==============================] - 29s 55ms/step - loss: 0.2779 - acc: 0.9579 - val_loss: 1.2853 - val_acc: 0.6379
Epoch 37/40

522/522 [==============================] - 29s 55ms/step - loss: 0.2723 - acc: 0.9540 - val_loss: 1.2812 - val_acc: 0.6954
Epoch 38/40

522/522 [==============================] - 29s 55ms/step - loss: 0.2593 - acc: 0.9483 - val_loss: 1.2880 - val_acc: 0.6897
Epoch 39/40

522/522 [==============================] - 29s 55ms/step - loss: 0.2534 - acc: 0.9291 - val_loss: 1.2728 - val_acc: 0.6552
Epoch 40/40

522/522 [==============================] - 29s 55ms/step - loss: 0.2437 - acc: 0.9579 - val_loss: 1.2568 - val_acc: 0.6552
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[2.38750875e-01 3.46866578e-01 4.14382547e-01]
 [3.33015174e-01 3.29403996e-01 3.37580889e-01]
 [3.12966824e-01 3.27485234e-01 3.59547973e-01]
 [1.64512053e-01 6.47805929e-02 7.70707369e-01]
 [6.69164538e-01 1.11670598e-01 2.19164878e-01]
 [9.96866763e-01 3.13324342e-03 1.57547270e-18]
 [3.12363863e-01 3.07040781e-01 3.80595446e-01]
 [2.37392664e-01 3.65249544e-01 3.97357762e-01]
 [2.37088501e-01 4.15043354e-01 3.47868145e-01]
 [4.46143568e-01 2.31571808e-01 3.22284639e-01]
 [9.24023032e-01 1.81811284e-02 5.77957742e-02]
 [4.82546896e-01 2.23276958e-01 2.94176131e-01]
 [3.83854866e-01 1.47533193e-01 4.68611866e-01]
 [1.44814402e-01 7.51233160e-01 1.03952467e-01]
 [2.92686760e-01 7.51032233e-02 6.32210076e-01]
 [5.22432148e-01 5.77472150e-02 4.19820637e-01]
 [1.83414031e-05 7.04757695e-04 9.99276936e-01]
 [2.95731276e-01 4.26515579e-01 2.77753174e-01]
 [1.00000000e+00 3.75317848e-19 2.48674636e-10]
 [3.52551013e-01 3.32936257e-01 3.14512700e-01]
 [1.11505710e-01 1.30117118e-01 7.58377135e-01]
 [1.09255955e-01 4.08626013e-02 8.49881470e-01]
 [5.43109417e-01 9.28620622e-02 3.64028573e-01]
 [6.20270193e-01 2.95158744e-01 8.45710263e-02]
 [5.43109417e-01 9.28620622e-02 3.64028573e-01]
 [3.93667310e-01 2.36541450e-01 3.69791210e-01]
 [7.03596234e-01 1.45738557e-01 1.50665209e-01]
 [3.04587884e-04 9.75747526e-01 2.39478350e-02]
 [2.10376102e-02 9.28810239e-01 5.01522124e-02]
 [3.05516183e-01 4.04491514e-01 2.89992303e-01]
 [1.00000000e+00 3.92118412e-12 1.91901334e-12]
 [5.43109417e-01 9.28620622e-02 3.64028573e-01]
 [9.96232569e-01 2.12310394e-03 1.64429471e-03]
 [3.31401259e-01 2.67225116e-01 4.01373595e-01]
 [9.59113830e-11 7.83726333e-18 1.00000000e+00]
 [2.29216725e-01 4.06635255e-02 7.30119705e-01]
 [3.26105624e-01 4.01870430e-01 2.72024006e-01]
 [2.74303943e-01 3.05913746e-01 4.19782311e-01]
 [9.79003608e-01 6.16665639e-04 2.03797743e-02]
 [3.44300836e-01 2.25306556e-01 4.30392683e-01]
 [2.75786556e-02 9.72421288e-01 1.61113969e-18]
 [2.74303943e-01 3.05913746e-01 4.19782311e-01]
 [2.54497584e-02 9.23075557e-01 5.14746942e-02]
 [9.99999881e-01 3.72749249e-13 8.51468158e-08]
 [9.99999881e-01 3.72749249e-13 8.51468158e-08]
 [3.49278063e-01 3.32483083e-01 3.18238795e-01]
 [2.49898791e-01 4.07397486e-02 7.09361494e-01]
 [2.69275874e-01 4.44672227e-01 2.86051989e-01]
 [9.79003608e-01 6.16665639e-04 2.03797743e-02]
 [2.75907457e-01 1.90540299e-01 5.33552289e-01]
 [7.03596234e-01 1.45738557e-01 1.50665209e-01]
 [3.22187632e-01 3.57239604e-01 3.20572793e-01]
 [6.42960966e-01 1.58157825e-01 1.98881209e-01]
 [2.90894061e-01 2.66702503e-01 4.42403495e-01]
 [2.68778473e-01 2.09291399e-01 5.21930158e-01]
 [9.57986176e-01 3.44528705e-02 7.56094651e-03]
 [4.08851117e-01 2.31035966e-02 5.68045259e-01]
 [1.02394270e-02 2.47177389e-03 9.87288833e-01]
 [4.53521730e-03 8.48342121e-01 1.47122711e-01]
 [2.37088501e-01 4.15043354e-01 3.47868145e-01]
 [5.43109417e-01 9.28620622e-02 3.64028573e-01]
 [8.85093689e-01 5.10005243e-02 6.39058650e-02]
 [3.06511104e-01 6.31904185e-01 6.15846105e-02]
 [1.00000000e+00 1.20362528e-13 1.09287717e-15]
 [4.43260389e-04 9.76652861e-01 2.29039006e-02]
 [1.00000000e+00 3.92118412e-12 1.91901334e-12]
 [2.75786556e-02 9.72421288e-01 1.61113969e-18]
 [3.57655372e-09 9.99999762e-01 2.88153444e-07]
 [9.96232569e-01 2.12310394e-03 1.64429471e-03]
 [3.12729985e-01 3.91129434e-01 2.96140581e-01]
 [3.26951265e-01 3.77095014e-01 2.95953810e-01]
 [9.18216258e-02 2.08283495e-02 8.87350023e-01]
 [2.74303943e-01 3.05913746e-01 4.19782311e-01]
 [3.99018973e-01 2.80607909e-01 3.20373088e-01]
 [1.47662088e-01 4.98723751e-03 8.47350657e-01]
 [1.00000000e+00 1.80291556e-15 2.85755253e-10]
 [9.23583925e-01 3.75355631e-02 3.88805605e-02]
 [1.46151397e-05 1.62973942e-04 9.99822438e-01]
 [2.34134585e-01 3.67998898e-01 3.97866547e-01]
 [1.24490194e-01 5.93333654e-02 8.16176474e-01]
 [1.17934472e-03 9.44366574e-01 5.44540174e-02]
 [2.67885029e-01 6.09659672e-01 1.22455291e-01]
 [4.95639116e-01 2.64251888e-01 2.40109041e-01]
 [1.75260007e-01 3.26536238e-01 4.98203784e-01]
 [4.86914396e-01 2.27398291e-01 2.85687238e-01]
 [1.10108651e-01 1.47855461e-01 7.42035925e-01]
 [2.30786338e-01 3.60259682e-01 4.08953935e-01]
 [1.00000000e+00 3.92118412e-12 1.91901334e-12]
 [6.69164538e-01 1.11670598e-01 2.19164878e-01]
 [1.00000000e+00 1.20362528e-13 1.09287717e-15]
 [9.96866763e-01 3.13324342e-03 1.57547270e-18]
 [2.77942508e-01 3.57833236e-01 3.64224315e-01]
 [9.18216258e-02 2.08283495e-02 8.87350023e-01]
 [7.09089654e-05 1.05670617e-18 9.99929070e-01]
 [1.63757533e-01 2.64150888e-01 5.72091579e-01]
 [2.08996445e-01 2.65302032e-01 5.25701463e-01]
 [2.31522247e-01 3.65918100e-01 4.02559638e-01]
 [1.00000000e+00 3.75317848e-19 2.48674636e-10]
 [3.66526186e-01 3.35622549e-01 2.97851235e-01]
 [1.00000000e+00 5.43595320e-08 2.22376163e-11]
 [4.80511248e-01 2.17752710e-01 3.01735967e-01]
 [1.00000000e+00 3.61421613e-13 1.09517111e-10]
 [2.72617012e-01 2.69153029e-01 4.58230019e-01]
 [2.80183643e-01 3.71928930e-01 3.47887397e-01]
 [1.34791024e-02 9.68469203e-01 1.80517416e-02]
 [1.00000000e+00 5.43595320e-08 2.22376163e-11]
 [1.17934472e-03 9.44366574e-01 5.44540174e-02]
 [9.96532440e-01 2.48759054e-04 3.21882358e-03]
 [9.96232569e-01 2.12310394e-03 1.64429471e-03]
 [7.25255348e-04 9.76784289e-01 2.24904474e-02]
 [3.27688009e-01 3.06690097e-01 3.65621895e-01]
 [3.26105624e-01 4.01870430e-01 2.72024006e-01]
 [1.09255955e-01 4.08626013e-02 8.49881470e-01]
 [3.36882204e-01 2.60443896e-01 4.02673841e-01]
 [5.43109417e-01 9.28620622e-02 3.64028573e-01]
 [6.48077321e-06 1.31173851e-03 9.98681724e-01]
 [5.83782256e-01 2.99533963e-01 1.16683811e-01]
 [2.58214116e-01 3.82485121e-01 3.59300762e-01]
 [3.22656959e-01 3.37795109e-01 3.39547902e-01]
 [2.37088501e-01 4.15043354e-01 3.47868145e-01]
 [2.29216725e-01 4.06635255e-02 7.30119705e-01]
 [2.09679754e-04 8.53377283e-01 1.46413118e-01]
 [9.99394178e-01 5.95851627e-04 1.00500110e-05]
 [1.10108651e-01 1.47855461e-01 7.42035925e-01]
 [9.99998927e-01 3.00766800e-07 7.17724674e-07]
 [9.99999881e-01 3.72749249e-13 8.51468158e-08]
 [1.08201757e-01 2.77340189e-02 8.64064157e-01]
 [9.96866763e-01 3.13324342e-03 1.57547270e-18]
 [1.73487693e-01 2.80572206e-01 5.45940101e-01]
 [1.47167947e-02 5.84973454e-01 4.00309771e-01]
 [3.16697419e-01 3.29080582e-01 3.54222059e-01]
 [1.47295535e-01 4.15667519e-02 8.11137736e-01]
 [1.00000000e+00 8.39982986e-16 4.14149715e-10]
 [3.44615668e-01 2.96845168e-01 3.58539134e-01]
 [9.97901201e-01 7.99144063e-13 2.09881505e-03]
 [2.42095172e-01 9.26280990e-02 6.65276706e-01]
 [3.22535187e-01 4.21198249e-01 2.56266564e-01]
 [1.00000000e+00 2.12988689e-23 4.89920487e-23]
 [6.33306980e-01 7.99781904e-02 2.86714792e-01]
 [5.83782256e-01 2.99533963e-01 1.16683811e-01]
 [8.41495767e-02 3.49656050e-03 9.12353814e-01]
 [1.59145638e-01 2.40372047e-01 6.00482345e-01]
 [2.41039112e-01 3.49486917e-01 4.09473956e-01]
 [1.14999004e-01 5.43740839e-02 8.30626905e-01]
 [4.04879868e-01 2.67119765e-01 3.28000367e-01]
 [1.17934472e-03 9.44366574e-01 5.44540174e-02]
 [5.36098261e-04 9.74495590e-01 2.49683335e-02]
 [3.53646398e-01 2.88926750e-01 3.57426882e-01]
 [6.99842698e-04 5.13676584e-01 4.85623509e-01]
 [4.27221984e-01 3.41206729e-01 2.31571242e-01]
 [3.18020672e-01 3.17680240e-01 3.64299059e-01]
 [3.12363863e-01 3.07040781e-01 3.80595446e-01]
 [2.96979129e-01 3.84527117e-01 3.18493813e-01]
 [5.43109417e-01 9.28620622e-02 3.64028573e-01]
 [9.99999881e-01 3.72749249e-13 8.51468158e-08]
 [9.99993086e-01 3.50256215e-08 6.96645429e-06]
 [9.18216258e-02 2.08283495e-02 8.87350023e-01]
 [9.99986529e-01 1.35273058e-05 5.73088077e-10]
 [2.67885029e-01 6.09659672e-01 1.22455291e-01]
 [2.20667854e-01 2.88524687e-01 4.90807444e-01]
 [2.90618651e-02 4.69376892e-02 9.24000442e-01]
 [1.00000000e+00 1.20362528e-13 1.09287717e-15]
 [2.74303943e-01 3.05913746e-01 4.19782311e-01]
 [1.99498624e-01 3.80029082e-01 4.20472324e-01]
 [2.10470602e-01 2.66502947e-01 5.23026466e-01]
 [3.16731781e-01 4.12154645e-01 2.71113664e-01]
 [8.91207874e-01 2.69750673e-02 8.18171129e-02]
 [1.00000000e+00 3.75317848e-19 2.48674636e-10]
 [7.93164670e-01 7.48571428e-03 1.99349567e-01]
 [5.78144612e-03 9.85018671e-01 9.19983350e-03]
 [3.64587873e-01 4.31289256e-01 2.04122916e-01]
 [2.68674463e-01 4.02915180e-01 3.28410327e-01]
 [2.05914348e-01 3.71908724e-01 4.22176927e-01]
 [3.61132681e-01 3.31116229e-01 3.07751119e-01]]
[2 2 2 2 0 0 2 2 1 0 0 0 2 1 2 0 2 1 0 0 2 2 0 0 0 0 0 1 1 1 0 0 0 2 2 2 1
 2 0 2 1 2 1 0 0 0 2 1 0 2 0 1 0 2 2 0 2 2 1 1 0 0 1 0 1 0 1 1 0 1 1 2 2 0
 2 0 0 2 2 2 1 1 0 2 0 2 2 0 0 0 0 2 2 2 2 2 2 0 0 0 0 0 2 1 1 0 1 0 0 1 2
 1 2 2 0 2 0 1 2 1 2 1 0 2 0 0 2 0 2 1 2 2 0 2 0 2 1 0 0 0 2 2 2 2 0 1 1 2
 1 0 2 2 1 0 0 0 2 0 1 2 2 0 2 2 2 1 0 0 0 1 1 1 2 0]

 32/174 [====>.........................] - ETA: 2s
 64/174 [==========>...................] - ETA: 2s
 96/174 [===============>..............] - ETA: 1s
128/174 [=====================>........] - ETA: 0s
160/174 [==========================>...] - ETA: 0s
174/174 [==============================] - 3s 19ms/step
Test loss: 1.7757579005997757
Test accuracy: 0.5977011487401765
[[41  8  9]
 [ 6 29 23]
 [21  3 34]]
