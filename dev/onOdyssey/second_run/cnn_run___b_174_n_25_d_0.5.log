Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 09:06:07.939061: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 09:06:07.943016: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 09:06:07.943132: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x558b2dbc6890 executing computations on platform Host. Devices:
2019-11-07 09:06:07.943151: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
[0.5]
Train on 870 samples, validate on 290 samples
Epoch 1/25

174/870 [=====>........................] - ETA: 1:06 - loss: 1.6094 - acc: 0.1782
348/870 [===========>..................] - ETA: 40s - loss: 1.5994 - acc: 0.2040 
522/870 [=================>............] - ETA: 24s - loss: 1.5908 - acc: 0.2031
696/870 [=======================>......] - ETA: 11s - loss: 1.5765 - acc: 0.2213
870/870 [==============================] - 63s 72ms/step - loss: 1.5621 - acc: 0.2276 - val_loss: 1.4342 - val_acc: 0.4931
Epoch 2/25

174/870 [=====>........................] - ETA: 41s - loss: 1.3954 - acc: 0.5977
348/870 [===========>..................] - ETA: 30s - loss: 1.3688 - acc: 0.5632
522/870 [=================>............] - ETA: 20s - loss: 1.3380 - acc: 0.5613
696/870 [=======================>......] - ETA: 10s - loss: 1.3259 - acc: 0.5402
870/870 [==============================] - 56s 65ms/step - loss: 1.3177 - acc: 0.5184 - val_loss: 1.3739 - val_acc: 0.3724
Epoch 3/25

174/870 [=====>........................] - ETA: 40s - loss: 1.1512 - acc: 0.4655
348/870 [===========>..................] - ETA: 30s - loss: 1.1579 - acc: 0.4856
522/870 [=================>............] - ETA: 20s - loss: 1.1468 - acc: 0.5077
696/870 [=======================>......] - ETA: 10s - loss: 1.1454 - acc: 0.5187
870/870 [==============================] - 56s 65ms/step - loss: 1.1361 - acc: 0.5172 - val_loss: 1.3682 - val_acc: 0.3897
Epoch 4/25

174/870 [=====>........................] - ETA: 40s - loss: 1.0276 - acc: 0.5000
348/870 [===========>..................] - ETA: 30s - loss: 1.0108 - acc: 0.5603
522/870 [=================>............] - ETA: 20s - loss: 0.9817 - acc: 0.5939
696/870 [=======================>......] - ETA: 10s - loss: 0.9750 - acc: 0.6006
870/870 [==============================] - 56s 64ms/step - loss: 0.9602 - acc: 0.6184 - val_loss: 1.3263 - val_acc: 0.4862
Epoch 5/25

174/870 [=====>........................] - ETA: 40s - loss: 0.8305 - acc: 0.6494
348/870 [===========>..................] - ETA: 30s - loss: 0.8287 - acc: 0.6580
522/870 [=================>............] - ETA: 20s - loss: 0.8644 - acc: 0.6341
696/870 [=======================>......] - ETA: 10s - loss: 0.8572 - acc: 0.6523
870/870 [==============================] - 56s 64ms/step - loss: 0.8430 - acc: 0.6724 - val_loss: 1.3473 - val_acc: 0.5586
Epoch 6/25

174/870 [=====>........................] - ETA: 40s - loss: 0.7095 - acc: 0.7989
348/870 [===========>..................] - ETA: 30s - loss: 0.7336 - acc: 0.7586
522/870 [=================>............] - ETA: 20s - loss: 0.7511 - acc: 0.7280
696/870 [=======================>......] - ETA: 10s - loss: 0.7504 - acc: 0.7241
870/870 [==============================] - 56s 64ms/step - loss: 0.7486 - acc: 0.7414 - val_loss: 1.3782 - val_acc: 0.5034
Epoch 7/25

174/870 [=====>........................] - ETA: 40s - loss: 0.5947 - acc: 0.7816
348/870 [===========>..................] - ETA: 30s - loss: 0.6653 - acc: 0.7328
522/870 [=================>............] - ETA: 20s - loss: 0.6688 - acc: 0.7356
696/870 [=======================>......] - ETA: 10s - loss: 0.6615 - acc: 0.7586
870/870 [==============================] - 56s 65ms/step - loss: 0.6614 - acc: 0.7724 - val_loss: 1.4063 - val_acc: 0.6414
Epoch 8/25

174/870 [=====>........................] - ETA: 40s - loss: 0.5959 - acc: 0.8333
348/870 [===========>..................] - ETA: 30s - loss: 0.6043 - acc: 0.7816
522/870 [=================>............] - ETA: 20s - loss: 0.5901 - acc: 0.7759
696/870 [=======================>......] - ETA: 10s - loss: 0.5901 - acc: 0.7687
870/870 [==============================] - 56s 64ms/step - loss: 0.5881 - acc: 0.7724 - val_loss: 1.5177 - val_acc: 0.5414
Epoch 9/25

174/870 [=====>........................] - ETA: 40s - loss: 0.5759 - acc: 0.7586
348/870 [===========>..................] - ETA: 30s - loss: 0.5865 - acc: 0.7759
522/870 [=================>............] - ETA: 20s - loss: 0.5669 - acc: 0.8084
696/870 [=======================>......] - ETA: 10s - loss: 0.5495 - acc: 0.8233
870/870 [==============================] - 56s 64ms/step - loss: 0.5408 - acc: 0.8149 - val_loss: 1.5522 - val_acc: 0.5241
Epoch 10/25

174/870 [=====>........................] - ETA: 40s - loss: 0.5269 - acc: 0.7471
348/870 [===========>..................] - ETA: 30s - loss: 0.5171 - acc: 0.7730
522/870 [=================>............] - ETA: 20s - loss: 0.5122 - acc: 0.8142
696/870 [=======================>......] - ETA: 10s - loss: 0.4929 - acc: 0.8290
870/870 [==============================] - 56s 64ms/step - loss: 0.4870 - acc: 0.8379 - val_loss: 1.5720 - val_acc: 0.6724
Epoch 11/25

174/870 [=====>........................] - ETA: 40s - loss: 0.4321 - acc: 0.8966
348/870 [===========>..................] - ETA: 30s - loss: 0.4407 - acc: 0.8506
522/870 [=================>............] - ETA: 20s - loss: 0.4356 - acc: 0.8467
696/870 [=======================>......] - ETA: 10s - loss: 0.4312 - acc: 0.8606
870/870 [==============================] - 56s 64ms/step - loss: 0.4342 - acc: 0.8770 - val_loss: 1.5348 - val_acc: 0.6483
Epoch 12/25

174/870 [=====>........................] - ETA: 40s - loss: 0.3630 - acc: 0.9368
348/870 [===========>..................] - ETA: 30s - loss: 0.4141 - acc: 0.9080
522/870 [=================>............] - ETA: 20s - loss: 0.3945 - acc: 0.9119
696/870 [=======================>......] - ETA: 10s - loss: 0.4034 - acc: 0.9095
870/870 [==============================] - 56s 64ms/step - loss: 0.3914 - acc: 0.9172 - val_loss: 1.4786 - val_acc: 0.6483
Epoch 13/25

174/870 [=====>........................] - ETA: 40s - loss: 0.3666 - acc: 0.9310
348/870 [===========>..................] - ETA: 30s - loss: 0.3383 - acc: 0.9339
522/870 [=================>............] - ETA: 20s - loss: 0.3407 - acc: 0.9272
696/870 [=======================>......] - ETA: 10s - loss: 0.3408 - acc: 0.9224
870/870 [==============================] - 56s 65ms/step - loss: 0.3468 - acc: 0.9149 - val_loss: 1.5029 - val_acc: 0.6552
Epoch 14/25

174/870 [=====>........................] - ETA: 40s - loss: 0.3432 - acc: 0.9195
348/870 [===========>..................] - ETA: 30s - loss: 0.3280 - acc: 0.9339
522/870 [=================>............] - ETA: 20s - loss: 0.3418 - acc: 0.9272
696/870 [=======================>......] - ETA: 10s - loss: 0.3168 - acc: 0.9411
870/870 [==============================] - 56s 65ms/step - loss: 0.3102 - acc: 0.9402 - val_loss: 1.5901 - val_acc: 0.6414
Epoch 15/25

174/870 [=====>........................] - ETA: 40s - loss: 0.3241 - acc: 0.9138
348/870 [===========>..................] - ETA: 30s - loss: 0.3091 - acc: 0.9224
522/870 [=================>............] - ETA: 20s - loss: 0.2907 - acc: 0.9387
696/870 [=======================>......] - ETA: 10s - loss: 0.2901 - acc: 0.9425
870/870 [==============================] - 56s 64ms/step - loss: 0.2831 - acc: 0.9414 - val_loss: 1.5450 - val_acc: 0.7103
Epoch 16/25

174/870 [=====>........................] - ETA: 40s - loss: 0.2829 - acc: 0.9310
348/870 [===========>..................] - ETA: 30s - loss: 0.2756 - acc: 0.9339
522/870 [=================>............] - ETA: 20s - loss: 0.2692 - acc: 0.9406
696/870 [=======================>......] - ETA: 10s - loss: 0.2587 - acc: 0.9468
870/870 [==============================] - 56s 65ms/step - loss: 0.2544 - acc: 0.9494 - val_loss: 1.5213 - val_acc: 0.6517
Epoch 17/25

174/870 [=====>........................] - ETA: 40s - loss: 0.2519 - acc: 0.9770
348/870 [===========>..................] - ETA: 30s - loss: 0.2443 - acc: 0.9626
522/870 [=================>............] - ETA: 20s - loss: 0.2383 - acc: 0.9655
696/870 [=======================>......] - ETA: 10s - loss: 0.2284 - acc: 0.9655
870/870 [==============================] - 56s 64ms/step - loss: 0.2246 - acc: 0.9621 - val_loss: 1.5343 - val_acc: 0.6759
Epoch 18/25

174/870 [=====>........................] - ETA: 40s - loss: 0.2179 - acc: 0.9425
348/870 [===========>..................] - ETA: 30s - loss: 0.2068 - acc: 0.9511
522/870 [=================>............] - ETA: 20s - loss: 0.1952 - acc: 0.9636
696/870 [=======================>......] - ETA: 10s - loss: 0.2020 - acc: 0.9655
870/870 [==============================] - 56s 64ms/step - loss: 0.2019 - acc: 0.9644 - val_loss: 1.5673 - val_acc: 0.6690
Epoch 19/25

174/870 [=====>........................] - ETA: 40s - loss: 0.1880 - acc: 0.9540
348/870 [===========>..................] - ETA: 30s - loss: 0.2065 - acc: 0.9511
522/870 [=================>............] - ETA: 20s - loss: 0.1965 - acc: 0.9579
696/870 [=======================>......] - ETA: 10s - loss: 0.1904 - acc: 0.9569
870/870 [==============================] - 56s 65ms/step - loss: 0.1837 - acc: 0.9621 - val_loss: 1.5388 - val_acc: 0.6690
Epoch 20/25

174/870 [=====>........................] - ETA: 40s - loss: 0.2071 - acc: 0.9598
348/870 [===========>..................] - ETA: 30s - loss: 0.1890 - acc: 0.9626
522/870 [=================>............] - ETA: 20s - loss: 0.1718 - acc: 0.9693
696/870 [=======================>......] - ETA: 10s - loss: 0.1686 - acc: 0.9684
870/870 [==============================] - 56s 65ms/step - loss: 0.1629 - acc: 0.9724 - val_loss: 1.5425 - val_acc: 0.6862
Epoch 21/25

174/870 [=====>........................] - ETA: 40s - loss: 0.1025 - acc: 0.9943
348/870 [===========>..................] - ETA: 30s - loss: 0.1311 - acc: 0.9799
522/870 [=================>............] - ETA: 20s - loss: 0.1383 - acc: 0.9789
696/870 [=======================>......] - ETA: 10s - loss: 0.1486 - acc: 0.9756
870/870 [==============================] - 56s 65ms/step - loss: 0.1444 - acc: 0.9759 - val_loss: 1.5439 - val_acc: 0.6621
Epoch 22/25

174/870 [=====>........................] - ETA: 40s - loss: 0.1228 - acc: 0.9943
348/870 [===========>..................] - ETA: 30s - loss: 0.1336 - acc: 0.9885
522/870 [=================>............] - ETA: 20s - loss: 0.1233 - acc: 0.9866
696/870 [=======================>......] - ETA: 10s - loss: 0.1370 - acc: 0.9784
870/870 [==============================] - 56s 64ms/step - loss: 0.1378 - acc: 0.9782 - val_loss: 1.5323 - val_acc: 0.6552
Epoch 23/25

174/870 [=====>........................] - ETA: 40s - loss: 0.1408 - acc: 0.9713
348/870 [===========>..................] - ETA: 30s - loss: 0.1400 - acc: 0.9741
522/870 [=================>............] - ETA: 20s - loss: 0.1277 - acc: 0.9789
696/870 [=======================>......] - ETA: 10s - loss: 0.1297 - acc: 0.9799
870/870 [==============================] - 56s 64ms/step - loss: 0.1271 - acc: 0.9805 - val_loss: 1.6025 - val_acc: 0.6690
Epoch 24/25

174/870 [=====>........................] - ETA: 40s - loss: 0.1265 - acc: 0.9713
348/870 [===========>..................] - ETA: 30s - loss: 0.1101 - acc: 0.9828
522/870 [=================>............] - ETA: 20s - loss: 0.1130 - acc: 0.9847
696/870 [=======================>......] - ETA: 10s - loss: 0.1164 - acc: 0.9813
870/870 [==============================] - 56s 65ms/step - loss: 0.1098 - acc: 0.9839 - val_loss: 1.5299 - val_acc: 0.6931
Epoch 25/25

174/870 [=====>........................] - ETA: 40s - loss: 0.1008 - acc: 0.9943
348/870 [===========>..................] - ETA: 30s - loss: 0.0948 - acc: 0.9914
522/870 [=================>............] - ETA: 20s - loss: 0.0921 - acc: 0.9885
696/870 [=======================>......] - ETA: 10s - loss: 0.0986 - acc: 0.9842
870/870 [==============================] - 56s 64ms/step - loss: 0.1002 - acc: 0.9839 - val_loss: 1.5476 - val_acc: 0.6828
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[2.5028646e-01 2.7220552e-03 1.4827718e-01 2.2934145e-01 3.6937287e-01]
 [7.3234070e-05 9.9098468e-01 8.9352289e-03 4.6417263e-06 2.2933289e-06]
 [3.1651190e-01 7.6866723e-03 1.3130136e-01 5.0854111e-01 3.5959039e-02]
 ...
 [5.1663318e-07 9.1082957e-06 7.0752665e-02 9.2923772e-01 5.8375754e-10]
 [9.9857616e-01 2.0602842e-04 1.2177532e-03 2.1087839e-14 2.9287378e-30]
 [1.7481939e-01 5.2881385e-03 1.8144074e-01 5.9701967e-01 4.1431990e-02]]
[4 1 3 0 1 4 0 2 0 1 0 0 3 3 0 0 2 4 0 4 2 0 1 3 3 1 1 3 0 4 0 0 3 0 4 4 4
 3 0 0 3 3 4 1 3 0 2 0 3 1 4 0 0 2 2 3 0 2 0 4 4 0 1 0 3 4 3 4 0 3 3 4 1 0
 0 4 4 3 1 4 3 0 4 1 2 4 3 3 4 2 3 0 4 4 4 4 0 0 0 3 3 4 2 3 4 4 4 4 1 3 4
 4 0 2 0 0 3 3 4 4 2 3 3 3 3 0 0 1 3 3 2 4 3 4 0 3 0 2 3 2 3 2 3 0 0 1 3 4
 0 3 4 1 4 0 1 0 3 3 1 4 4 2 0 3 1 3 0 4 3 0 2 3 3 0 4 3 0 3 0 1 1 3 2 3 3
 0 3 0 4 4 3 4 0 3 2 3 4 0 0 0 4 0 4 3 4 4 4 0 3 4 3 4 4 0 3 1 4 0 2 3 0 2
 4 0 3 2 2 3 4 4 3 3 3 4 3 4 4 0 0 0 2 4 3 3 4 2 3 0 3 4 0 3 0 3 4 3 4 3 4
 0 2 3 2 0 4 3 0 0 3 4 4 0 2 4 2 0 0 3 4 3 3 0 4 0 4 3 3 3 0 3]

 32/290 [==>...........................] - ETA: 4s
 64/290 [=====>........................] - ETA: 4s
 96/290 [========>.....................] - ETA: 3s
128/290 [============>.................] - ETA: 3s
160/290 [===============>..............] - ETA: 2s
192/290 [==================>...........] - ETA: 1s
224/290 [======================>.......] - ETA: 1s
256/290 [=========================>....] - ETA: 0s
288/290 [============================>.] - ETA: 0s
290/290 [==============================] - 6s 19ms/step
Test loss: 2.1161763750273606
Test accuracy: 0.6793103448275862
[[43  3  3  6  3]
 [ 8 19  0 13 18]
 [24  0 26  8  0]
 [ 2  0  1 55  0]
 [ 0  0  0  4 54]]
