Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 11:44:45.857017: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 11:44:45.987379: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 11:44:45.987636: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5600404a8360 executing computations on platform Host. Devices:
2019-11-07 11:44:45.987687: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
None
Train on 522 samples, validate on 174 samples
Epoch 1/40

522/522 [==============================] - 22s 43ms/step - loss: 1.0979 - acc: 0.3199 - val_loss: 1.0937 - val_acc: 0.3851
Epoch 2/40

522/522 [==============================] - 20s 39ms/step - loss: 1.0925 - acc: 0.4310 - val_loss: 1.0894 - val_acc: 0.3908
Epoch 3/40

522/522 [==============================] - 20s 39ms/step - loss: 1.0864 - acc: 0.4962 - val_loss: 1.0854 - val_acc: 0.3851
Epoch 4/40

522/522 [==============================] - 20s 39ms/step - loss: 1.0803 - acc: 0.5096 - val_loss: 1.0816 - val_acc: 0.3736
Epoch 5/40

522/522 [==============================] - 20s 39ms/step - loss: 1.0742 - acc: 0.4981 - val_loss: 1.0783 - val_acc: 0.3793
Epoch 6/40

522/522 [==============================] - 20s 39ms/step - loss: 1.0682 - acc: 0.4923 - val_loss: 1.0752 - val_acc: 0.3678
Epoch 7/40

522/522 [==============================] - 21s 40ms/step - loss: 1.0623 - acc: 0.4923 - val_loss: 1.0725 - val_acc: 0.3563
Epoch 8/40

522/522 [==============================] - 20s 39ms/step - loss: 1.0564 - acc: 0.5134 - val_loss: 1.0701 - val_acc: 0.4138
Epoch 9/40

522/522 [==============================] - 21s 40ms/step - loss: 1.0505 - acc: 0.5383 - val_loss: 1.0681 - val_acc: 0.4253
Epoch 10/40

522/522 [==============================] - 21s 39ms/step - loss: 1.0445 - acc: 0.5383 - val_loss: 1.0665 - val_acc: 0.4425
Epoch 11/40

522/522 [==============================] - 21s 40ms/step - loss: 1.0386 - acc: 0.5326 - val_loss: 1.0653 - val_acc: 0.4368
Epoch 12/40

522/522 [==============================] - 21s 40ms/step - loss: 1.0326 - acc: 0.5211 - val_loss: 1.0644 - val_acc: 0.4540
Epoch 13/40

522/522 [==============================] - 21s 40ms/step - loss: 1.0265 - acc: 0.5402 - val_loss: 1.0640 - val_acc: 0.4483
Epoch 14/40

522/522 [==============================] - 21s 40ms/step - loss: 1.0203 - acc: 0.5364 - val_loss: 1.0640 - val_acc: 0.4368
Epoch 15/40

522/522 [==============================] - 21s 40ms/step - loss: 1.0141 - acc: 0.5268 - val_loss: 1.0643 - val_acc: 0.4540
Epoch 16/40

522/522 [==============================] - 21s 40ms/step - loss: 1.0078 - acc: 0.5307 - val_loss: 1.0652 - val_acc: 0.4540
Epoch 17/40

522/522 [==============================] - 21s 40ms/step - loss: 1.0015 - acc: 0.5268 - val_loss: 1.0666 - val_acc: 0.4598
Epoch 18/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9951 - acc: 0.5192 - val_loss: 1.0685 - val_acc: 0.4598
Epoch 19/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9887 - acc: 0.5268 - val_loss: 1.0709 - val_acc: 0.4598
Epoch 20/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9822 - acc: 0.5307 - val_loss: 1.0737 - val_acc: 0.4598
Epoch 21/40

522/522 [==============================] - 21s 41ms/step - loss: 0.9758 - acc: 0.5268 - val_loss: 1.0770 - val_acc: 0.4540
Epoch 22/40

522/522 [==============================] - 20s 38ms/step - loss: 0.9692 - acc: 0.5230 - val_loss: 1.0808 - val_acc: 0.4770
Epoch 23/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9627 - acc: 0.5268 - val_loss: 1.0852 - val_acc: 0.4713
Epoch 24/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9561 - acc: 0.5326 - val_loss: 1.0899 - val_acc: 0.4770
Epoch 25/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9496 - acc: 0.5326 - val_loss: 1.0951 - val_acc: 0.4770
Epoch 26/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9430 - acc: 0.5383 - val_loss: 1.1008 - val_acc: 0.4770
Epoch 27/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9365 - acc: 0.5383 - val_loss: 1.1070 - val_acc: 0.4770
Epoch 28/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9299 - acc: 0.5441 - val_loss: 1.1136 - val_acc: 0.4770
Epoch 29/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9233 - acc: 0.5364 - val_loss: 1.1204 - val_acc: 0.4713
Epoch 30/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9168 - acc: 0.5383 - val_loss: 1.1278 - val_acc: 0.4828
Epoch 31/40

522/522 [==============================] - 21s 40ms/step - loss: 0.9102 - acc: 0.5517 - val_loss: 1.1355 - val_acc: 0.4713
Epoch 32/40

522/522 [==============================] - 21s 41ms/step - loss: 0.9037 - acc: 0.5498 - val_loss: 1.1435 - val_acc: 0.4655
Epoch 33/40

522/522 [==============================] - 21s 40ms/step - loss: 0.8973 - acc: 0.5613 - val_loss: 1.1517 - val_acc: 0.4598
Epoch 34/40

522/522 [==============================] - 21s 40ms/step - loss: 0.8908 - acc: 0.5575 - val_loss: 1.1600 - val_acc: 0.4483
Epoch 35/40

522/522 [==============================] - 21s 40ms/step - loss: 0.8845 - acc: 0.5670 - val_loss: 1.1683 - val_acc: 0.4540
Epoch 36/40

522/522 [==============================] - 21s 41ms/step - loss: 0.8782 - acc: 0.5728 - val_loss: 1.1771 - val_acc: 0.4540
Epoch 37/40

522/522 [==============================] - 21s 40ms/step - loss: 0.8720 - acc: 0.5766 - val_loss: 1.1853 - val_acc: 0.4598
Epoch 38/40

522/522 [==============================] - 21s 40ms/step - loss: 0.8659 - acc: 0.5824 - val_loss: 1.1941 - val_acc: 0.4713
Epoch 39/40

522/522 [==============================] - 21s 40ms/step - loss: 0.8598 - acc: 0.6034 - val_loss: 1.2023 - val_acc: 0.4713
Epoch 40/40

522/522 [==============================] - 21s 40ms/step - loss: 0.8538 - acc: 0.6054 - val_loss: 1.2105 - val_acc: 0.4713
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[3.18296313e-01 3.42844099e-01 3.38859588e-01]
 [2.89713204e-01 3.51423979e-01 3.58862817e-01]
 [2.92090148e-01 3.48217130e-01 3.59692693e-01]
 [2.38288775e-01 3.93412024e-01 3.68299246e-01]
 [3.03827882e-01 2.74076492e-01 4.22095686e-01]
 [9.86665010e-01 1.04827350e-02 2.85227713e-03]
 [3.13390672e-01 3.43541473e-01 3.43067855e-01]
 [2.91070282e-01 3.44394147e-01 3.64535600e-01]
 [2.74908125e-01 3.66856426e-01 3.58235449e-01]
 [3.22754174e-01 3.33399892e-01 3.43845963e-01]
 [3.83582741e-01 3.86962503e-01 2.29454756e-01]
 [3.10523987e-01 4.37830478e-01 2.51645505e-01]
 [3.19989294e-01 3.11678916e-01 3.68331730e-01]
 [3.10129672e-01 4.57717955e-01 2.32152373e-01]
 [3.81806523e-01 3.53085846e-01 2.65107661e-01]
 [3.75822514e-01 3.96936417e-01 2.27241084e-01]
 [1.88099314e-02 1.44401848e-01 8.36788237e-01]
 [2.79801488e-01 3.41922194e-01 3.78276318e-01]
 [8.72374833e-01 5.97041696e-02 6.79209903e-02]
 [2.91828811e-01 3.42910200e-01 3.65260959e-01]
 [3.21950197e-01 4.12330896e-01 2.65718907e-01]
 [1.71472698e-01 3.95805180e-01 4.32722151e-01]
 [3.45217913e-01 4.24023986e-01 2.30758131e-01]
 [1.66668192e-01 3.88130039e-01 4.45201784e-01]
 [3.45217913e-01 4.24023986e-01 2.30758131e-01]
 [3.03925633e-01 3.29529732e-01 3.66544604e-01]
 [3.51315171e-01 3.86561543e-01 2.62123257e-01]
 [2.70603329e-01 4.78661448e-01 2.50735253e-01]
 [2.52423853e-01 4.04099137e-01 3.43477041e-01]
 [2.90609360e-01 3.46292824e-01 3.63097847e-01]
 [9.86968935e-01 2.31573998e-04 1.27994874e-02]
 [3.45217913e-01 4.24023986e-01 2.30758131e-01]
 [3.07503551e-01 3.30464214e-01 3.62032205e-01]
 [2.92304337e-01 3.38770300e-01 3.68925363e-01]
 [3.52948817e-04 2.73727924e-02 9.72274244e-01]
 [2.78909177e-01 4.62065548e-01 2.59025276e-01]
 [2.80061752e-01 3.42628956e-01 3.77309322e-01]
 [2.80631483e-01 3.54769886e-01 3.64598602e-01]
 [4.87225085e-01 2.88671821e-01 2.24103078e-01]
 [3.24373692e-01 3.38776648e-01 3.36849630e-01]
 [9.99281466e-01 2.30531354e-04 4.87999030e-04]
 [2.80631483e-01 3.54769886e-01 3.64598602e-01]
 [7.62870550e-01 1.43604264e-01 9.35252011e-02]
 [8.19499254e-01 8.00874457e-03 1.72491997e-01]
 [8.19499254e-01 8.00874457e-03 1.72491997e-01]
 [3.03690195e-01 3.52413267e-01 3.43896538e-01]
 [3.17182302e-01 3.90345365e-01 2.92472243e-01]
 [2.65319288e-01 3.49627107e-01 3.85053664e-01]
 [4.87225085e-01 2.88671821e-01 2.24103078e-01]
 [2.98247844e-01 3.32143486e-01 3.69608670e-01]
 [3.51315171e-01 3.86561543e-01 2.62123257e-01]
 [3.03836167e-01 3.41553777e-01 3.54610026e-01]
 [3.68015558e-01 4.53615904e-01 1.78368598e-01]
 [2.74307609e-01 3.30825567e-01 3.94866794e-01]
 [3.02655339e-01 3.24189544e-01 3.73155087e-01]
 [3.49382460e-01 4.56128925e-01 1.94488525e-01]
 [2.32485861e-01 4.56242770e-01 3.11271429e-01]
 [6.05439246e-01 2.83813924e-01 1.10746883e-01]
 [2.02233538e-01 3.46767336e-01 4.50999081e-01]
 [2.74908125e-01 3.66856426e-01 3.58235449e-01]
 [3.45217913e-01 4.24023986e-01 2.30758131e-01]
 [3.99767965e-01 3.50667387e-01 2.49564603e-01]
 [3.71885836e-01 3.48882675e-01 2.79231519e-01]
 [1.11934682e-02 9.88624573e-01 1.81930052e-04]
 [2.28520930e-01 4.83781248e-01 2.87697822e-01]
 [9.86968935e-01 2.31573998e-04 1.27994874e-02]
 [9.99281466e-01 2.30531354e-04 4.87999030e-04]
 [9.66665804e-01 2.98970640e-02 3.43708764e-03]
 [3.07503551e-01 3.30464214e-01 3.62032205e-01]
 [3.01330000e-01 3.46210450e-01 3.52459520e-01]
 [3.12876701e-01 3.48965555e-01 3.38157743e-01]
 [2.67928600e-01 2.87006378e-01 4.45065081e-01]
 [2.80631483e-01 3.54769886e-01 3.64598602e-01]
 [3.06885004e-01 3.41402858e-01 3.51712197e-01]
 [3.20442319e-01 2.11187199e-01 4.68370438e-01]
 [2.45117187e-03 5.14087915e-01 4.83460933e-01]
 [4.25973952e-01 4.40266460e-01 1.33759633e-01]
 [3.34731191e-01 3.88733745e-01 2.76535064e-01]
 [3.06255251e-01 3.51218075e-01 3.42526644e-01]
 [2.31706232e-01 3.92908335e-01 3.75385404e-01]
 [3.96052189e-02 2.59760439e-01 7.00634360e-01]
 [2.53947467e-01 3.74887645e-01 3.71164888e-01]
 [3.80103052e-01 3.64144295e-01 2.55752623e-01]
 [2.76214391e-01 3.69126469e-01 3.54659140e-01]
 [3.37508768e-01 3.21190804e-01 3.41300488e-01]
 [2.83938527e-01 3.82424772e-01 3.33636701e-01]
 [2.80367374e-01 3.67691904e-01 3.51940691e-01]
 [9.86968935e-01 2.31573998e-04 1.27994874e-02]
 [3.03827882e-01 2.74076492e-01 4.22095686e-01]
 [1.11934682e-02 9.88624573e-01 1.81930052e-04]
 [9.86665010e-01 1.04827350e-02 2.85227713e-03]
 [2.95144916e-01 3.61987203e-01 3.42867941e-01]
 [2.67928600e-01 2.87006378e-01 4.45065081e-01]
 [9.99999642e-01 6.56409704e-10 3.86894698e-07]
 [2.73021221e-01 3.54960054e-01 3.72018695e-01]
 [2.92122573e-01 3.68250489e-01 3.39626938e-01]
 [2.76617765e-01 3.52985382e-01 3.70396882e-01]
 [8.72374833e-01 5.97041696e-02 6.79209903e-02]
 [3.03050995e-01 3.56161952e-01 3.40787023e-01]
 [3.38160748e-06 4.24082458e-07 9.99996185e-01]
 [3.22965711e-01 3.31168741e-01 3.45865548e-01]
 [9.95480061e-01 4.36507910e-03 1.54874841e-04]
 [2.81641185e-01 3.51116896e-01 3.67241919e-01]
 [2.92097628e-01 3.43342006e-01 3.64560336e-01]
 [2.68338323e-01 4.03545141e-01 3.28116596e-01]
 [3.38160748e-06 4.24082458e-07 9.99996185e-01]
 [3.96052189e-02 2.59760439e-01 7.00634360e-01]
 [1.79073200e-01 3.99028122e-01 4.21898663e-01]
 [3.07503551e-01 3.30464214e-01 3.62032205e-01]
 [2.35684097e-01 4.83662128e-01 2.80653775e-01]
 [2.88427800e-01 3.44818950e-01 3.66753191e-01]
 [2.80061752e-01 3.42628956e-01 3.77309322e-01]
 [1.71472698e-01 3.95805180e-01 4.32722151e-01]
 [2.85711706e-01 3.44515830e-01 3.69772464e-01]
 [3.45217913e-01 4.24023986e-01 2.30758131e-01]
 [1.30623728e-01 4.34340984e-01 4.35035288e-01]
 [4.11297649e-01 3.45922291e-01 2.42780060e-01]
 [2.77334243e-01 3.15146089e-01 4.07519698e-01]
 [3.02806109e-01 3.41675550e-01 3.55518311e-01]
 [2.74908125e-01 3.66856426e-01 3.58235449e-01]
 [2.78909177e-01 4.62065548e-01 2.59025276e-01]
 [2.25914538e-01 4.10663486e-01 3.63421977e-01]
 [8.83951724e-01 1.03223614e-01 1.28247133e-02]
 [2.83938527e-01 3.82424772e-01 3.33636701e-01]
 [1.56820286e-02 2.92656175e-03 9.81391430e-01]
 [8.19499254e-01 8.00874457e-03 1.72491997e-01]
 [2.88965851e-01 4.08320725e-01 3.02713424e-01]
 [9.86665010e-01 1.04827350e-02 2.85227713e-03]
 [3.04827839e-01 3.55749279e-01 3.39422882e-01]
 [1.63318664e-01 3.63152444e-01 4.73528832e-01]
 [2.85040915e-01 3.47706527e-01 3.67252558e-01]
 [3.22169542e-01 3.10908139e-01 3.66922319e-01]
 [3.16044549e-03 5.53272843e-01 4.43566740e-01]
 [3.22883695e-01 3.38863909e-01 3.38252425e-01]
 [4.99331057e-01 4.81661409e-01 1.90075040e-02]
 [2.62740880e-01 4.32452768e-01 3.04806381e-01]
 [3.11638057e-01 3.39827389e-01 3.48534495e-01]
 [9.94971991e-01 3.11783911e-03 1.91015832e-03]
 [3.46607953e-01 2.92198271e-01 3.61193806e-01]
 [4.11297649e-01 3.45922291e-01 2.42780060e-01]
 [1.82539910e-01 2.43819747e-02 7.93078125e-01]
 [2.75852263e-01 3.51627856e-01 3.72519910e-01]
 [2.84379482e-01 3.56064737e-01 3.59555781e-01]
 [3.93156767e-01 3.89031947e-01 2.17811391e-01]
 [3.19556504e-01 3.31344128e-01 3.49099338e-01]
 [3.96052189e-02 2.59760439e-01 7.00634360e-01]
 [2.32523099e-01 4.81750965e-01 2.85725951e-01]
 [3.22514325e-01 3.39086086e-01 3.38399619e-01]
 [2.33888432e-01 4.37890649e-01 3.28220904e-01]
 [3.02535892e-01 3.53240222e-01 3.44223887e-01]
 [3.15101802e-01 3.38534683e-01 3.46363425e-01]
 [3.13390672e-01 3.43541473e-01 3.43067855e-01]
 [2.64263988e-01 3.51816565e-01 3.83919388e-01]
 [3.45217913e-01 4.24023986e-01 2.30758131e-01]
 [8.19499254e-01 8.00874457e-03 1.72491997e-01]
 [5.82181871e-01 3.53918791e-01 6.38993531e-02]
 [2.67928600e-01 2.87006378e-01 4.45065081e-01]
 [1.69133216e-01 8.29428196e-01 1.43856427e-03]
 [2.53947467e-01 3.74887645e-01 3.71164888e-01]
 [3.28000933e-01 3.33074242e-01 3.38924795e-01]
 [1.80738658e-01 4.13395435e-01 4.05865818e-01]
 [1.11934682e-02 9.88624573e-01 1.81930052e-04]
 [2.80631483e-01 3.54769886e-01 3.64598602e-01]
 [2.80355841e-01 3.74560028e-01 3.45084131e-01]
 [2.94036984e-01 3.23433787e-01 3.82529259e-01]
 [3.08906764e-01 3.48726898e-01 3.42366368e-01]
 [2.68536091e-01 3.65412623e-01 3.66051257e-01]
 [8.72374833e-01 5.97041696e-02 6.79209903e-02]
 [3.36767077e-01 3.69058520e-01 2.94174403e-01]
 [3.46217155e-01 3.56452823e-01 2.97330081e-01]
 [2.92635858e-01 3.43528092e-01 3.63835990e-01]
 [3.14084768e-01 3.48377943e-01 3.37537259e-01]
 [2.70041406e-01 3.73050600e-01 3.56908053e-01]
 [3.06402266e-01 3.46522778e-01 3.47074926e-01]]
[1 2 2 1 2 0 1 2 1 2 1 1 2 1 0 1 2 2 0 2 1 2 1 2 1 2 1 1 1 2 0 1 2 2 2 1 2
 2 0 1 0 2 0 0 0 1 1 2 0 2 1 2 1 2 2 1 1 0 2 1 1 0 0 1 1 0 0 0 2 2 1 2 2 2
 2 1 1 1 1 1 2 1 0 1 2 1 1 0 2 1 0 1 2 0 2 1 2 0 1 2 2 0 2 2 1 2 2 2 2 1 2
 2 2 2 1 2 0 2 2 1 1 1 0 1 2 0 1 0 1 2 2 2 1 1 0 1 2 0 2 0 2 2 2 0 2 2 1 1
 1 1 2 1 2 1 0 0 2 1 1 2 1 1 2 1 2 1 2 0 1 1 2 1 1 2]

 32/174 [====>.........................] - ETA: 1s
 64/174 [==========>...................] - ETA: 1s
 96/174 [===============>..............] - ETA: 0s
128/174 [=====================>........] - ETA: 0s
160/174 [==========================>...] - ETA: 0s
174/174 [==============================] - 2s 12ms/step
Test loss: 1.3593901066944516
Test accuracy: 0.38505747229203413
[[25 16 17]
 [ 1 22 35]
 [ 7 31 20]]
