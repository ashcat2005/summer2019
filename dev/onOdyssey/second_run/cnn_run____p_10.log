Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 09:06:34.301469: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 09:06:34.372937: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 09:06:34.373228: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55ab85c450d0 executing computations on platform Host. Devices:
2019-11-07 09:06:34.373284: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
None
Train on 870 samples, validate on 290 samples
Epoch 1/35

870/870 [==============================] - 36s 41ms/step - loss: 1.6060 - acc: 0.2184 - val_loss: 1.5957 - val_acc: 0.2103
Epoch 2/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5983 - acc: 0.2575 - val_loss: 1.5893 - val_acc: 0.2345
Epoch 3/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5894 - acc: 0.2874 - val_loss: 1.5824 - val_acc: 0.2517
Epoch 4/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5803 - acc: 0.3011 - val_loss: 1.5755 - val_acc: 0.2621
Epoch 5/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5711 - acc: 0.3218 - val_loss: 1.5684 - val_acc: 0.2759
Epoch 6/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5619 - acc: 0.3333 - val_loss: 1.5614 - val_acc: 0.2586
Epoch 7/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5528 - acc: 0.3368 - val_loss: 1.5542 - val_acc: 0.2552
Epoch 8/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5436 - acc: 0.3494 - val_loss: 1.5470 - val_acc: 0.3517
Epoch 9/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5343 - acc: 0.4575 - val_loss: 1.5397 - val_acc: 0.4448
Epoch 10/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5247 - acc: 0.5080 - val_loss: 1.5323 - val_acc: 0.4207
Epoch 11/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5150 - acc: 0.5023 - val_loss: 1.5247 - val_acc: 0.4379
Epoch 12/35

870/870 [==============================] - 32s 37ms/step - loss: 1.5051 - acc: 0.5115 - val_loss: 1.5169 - val_acc: 0.4207
Epoch 13/35

870/870 [==============================] - 32s 37ms/step - loss: 1.4948 - acc: 0.4977 - val_loss: 1.5091 - val_acc: 0.4069
Epoch 14/35

870/870 [==============================] - 32s 37ms/step - loss: 1.4843 - acc: 0.4931 - val_loss: 1.5011 - val_acc: 0.4000
Epoch 15/35

870/870 [==============================] - 32s 37ms/step - loss: 1.4733 - acc: 0.4885 - val_loss: 1.4931 - val_acc: 0.3931
Epoch 16/35

870/870 [==============================] - 32s 37ms/step - loss: 1.4620 - acc: 0.4885 - val_loss: 1.4851 - val_acc: 0.3793
Epoch 17/35

870/870 [==============================] - 32s 37ms/step - loss: 1.4505 - acc: 0.4839 - val_loss: 1.4771 - val_acc: 0.3759
Epoch 18/35

870/870 [==============================] - 32s 37ms/step - loss: 1.4385 - acc: 0.4816 - val_loss: 1.4692 - val_acc: 0.3828
Epoch 19/35

870/870 [==============================] - 32s 37ms/step - loss: 1.4263 - acc: 0.4851 - val_loss: 1.4615 - val_acc: 0.3793
Epoch 20/35

870/870 [==============================] - 32s 37ms/step - loss: 1.4138 - acc: 0.4851 - val_loss: 1.4540 - val_acc: 0.3759
Epoch 21/35

870/870 [==============================] - 32s 37ms/step - loss: 1.4010 - acc: 0.4805 - val_loss: 1.4468 - val_acc: 0.3724
Epoch 22/35

870/870 [==============================] - 32s 37ms/step - loss: 1.3881 - acc: 0.4747 - val_loss: 1.4400 - val_acc: 0.3586
Epoch 23/35

870/870 [==============================] - 32s 36ms/step - loss: 1.3748 - acc: 0.4701 - val_loss: 1.4338 - val_acc: 0.3552
Epoch 24/35

870/870 [==============================] - 32s 37ms/step - loss: 1.3614 - acc: 0.4632 - val_loss: 1.4281 - val_acc: 0.3517
Epoch 25/35

870/870 [==============================] - 32s 37ms/step - loss: 1.3479 - acc: 0.4644 - val_loss: 1.4231 - val_acc: 0.3517
Epoch 26/35

870/870 [==============================] - 32s 37ms/step - loss: 1.3344 - acc: 0.4644 - val_loss: 1.4185 - val_acc: 0.3517
Epoch 27/35

870/870 [==============================] - 32s 37ms/step - loss: 1.3209 - acc: 0.4644 - val_loss: 1.4143 - val_acc: 0.3517
Epoch 28/35

870/870 [==============================] - 32s 37ms/step - loss: 1.3075 - acc: 0.4690 - val_loss: 1.4104 - val_acc: 0.3690
Epoch 29/35

870/870 [==============================] - 32s 37ms/step - loss: 1.2941 - acc: 0.4793 - val_loss: 1.4066 - val_acc: 0.3862
Epoch 30/35

870/870 [==============================] - 32s 36ms/step - loss: 1.2807 - acc: 0.4828 - val_loss: 1.4029 - val_acc: 0.3897
Epoch 31/35

870/870 [==============================] - 32s 37ms/step - loss: 1.2674 - acc: 0.4816 - val_loss: 1.3992 - val_acc: 0.3966
Epoch 32/35

870/870 [==============================] - 32s 36ms/step - loss: 1.2542 - acc: 0.4851 - val_loss: 1.3959 - val_acc: 0.3966
Epoch 33/35

870/870 [==============================] - 32s 37ms/step - loss: 1.2410 - acc: 0.4839 - val_loss: 1.3930 - val_acc: 0.4034
Epoch 34/35

870/870 [==============================] - 32s 36ms/step - loss: 1.2280 - acc: 0.4885 - val_loss: 1.3900 - val_acc: 0.4069
Epoch 35/35

870/870 [==============================] - 32s 37ms/step - loss: 1.2151 - acc: 0.4943 - val_loss: 1.3878 - val_acc: 0.4034
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[0.14885795 0.09682707 0.14066994 0.28383258 0.32981244]
 [0.21108446 0.1958376  0.24461259 0.15290228 0.19556312]
 [0.16041192 0.11321376 0.1549673  0.25725847 0.3141485 ]
 ...
 [0.19666654 0.1948212  0.21858646 0.23748697 0.15243888]
 [0.15120102 0.60430586 0.24260576 0.00083192 0.00105554]
 [0.16026418 0.11631673 0.15973747 0.25309148 0.31059006]]
[4 2 4 0 2 4 0 1 3 2 0 0 0 4 4 0 1 4 0 4 1 1 2 4 4 2 2 4 0 4 4 0 4 1 4 4 4
 4 0 0 4 4 4 2 4 4 2 3 3 2 4 0 1 1 1 4 0 4 4 4 4 0 2 1 4 4 4 4 0 4 4 4 2 1
 0 4 4 2 2 4 4 1 4 2 1 4 4 4 4 1 4 1 4 4 4 4 1 1 1 4 3 4 1 3 4 4 4 4 2 3 4
 4 1 2 1 1 4 4 4 4 4 4 4 4 4 4 0 2 3 3 1 4 4 4 0 4 3 1 0 1 4 1 3 1 3 2 4 4
 4 4 4 2 4 1 2 1 4 4 2 4 4 0 1 2 2 4 0 4 4 4 3 3 4 1 4 0 4 3 4 2 2 4 1 4 4
 0 4 1 4 4 4 4 1 0 1 0 4 4 0 2 4 1 4 4 4 4 4 4 4 4 1 4 4 1 4 2 4 4 2 4 0 1
 4 4 3 3 1 3 4 4 4 4 4 4 4 4 4 0 4 4 1 4 4 4 4 1 0 0 4 4 0 4 4 4 4 4 4 3 4
 0 1 4 1 1 4 4 4 1 4 4 4 1 1 4 3 1 4 4 4 4 3 4 4 4 1 4 4 3 1 4]

 32/290 [==>...........................] - ETA: 3s
 64/290 [=====>........................] - ETA: 2s
 96/290 [========>.....................] - ETA: 2s
128/290 [============>.................] - ETA: 1s
160/290 [===============>..............] - ETA: 1s
192/290 [==================>...........] - ETA: 1s
224/290 [======================>.......] - ETA: 0s
256/290 [=========================>....] - ETA: 0s
288/290 [============================>.] - ETA: 0s
290/290 [==============================] - 4s 12ms/step
Test loss: 1.5345650919552507
Test accuracy: 0.31724137931034485
[[22 14  5  6 11]
 [ 0  0 19  0 39]
 [ 2 35  2  5 14]
 [ 8  1  2 10 37]
 [ 0  0  0  0 58]]
