Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 09:06:34.324812: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 09:06:34.372938: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 09:06:34.373212: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x555e8249fca0 executing computations on platform Host. Devices:
2019-11-07 09:06:34.373263: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
None
Train on 870 samples, validate on 290 samples
Epoch 1/35

870/870 [==============================] - 52s 60ms/step - loss: 1.6096 - acc: 0.2563 - val_loss: 1.6059 - val_acc: 0.3724
Epoch 2/35

870/870 [==============================] - 48s 56ms/step - loss: 1.6043 - acc: 0.3092 - val_loss: 1.6002 - val_acc: 0.3448
Epoch 3/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5980 - acc: 0.3287 - val_loss: 1.5940 - val_acc: 0.3069
Epoch 4/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5911 - acc: 0.3138 - val_loss: 1.5874 - val_acc: 0.3069
Epoch 5/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5837 - acc: 0.3149 - val_loss: 1.5806 - val_acc: 0.2966
Epoch 6/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5758 - acc: 0.3184 - val_loss: 1.5736 - val_acc: 0.3034
Epoch 7/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5674 - acc: 0.3310 - val_loss: 1.5666 - val_acc: 0.3034
Epoch 8/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5585 - acc: 0.3218 - val_loss: 1.5597 - val_acc: 0.3034
Epoch 9/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5491 - acc: 0.3161 - val_loss: 1.5527 - val_acc: 0.3000
Epoch 10/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5393 - acc: 0.3034 - val_loss: 1.5459 - val_acc: 0.2931
Epoch 11/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5290 - acc: 0.3103 - val_loss: 1.5392 - val_acc: 0.2931
Epoch 12/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5183 - acc: 0.3195 - val_loss: 1.5329 - val_acc: 0.2897
Epoch 13/35

870/870 [==============================] - 48s 55ms/step - loss: 1.5071 - acc: 0.3218 - val_loss: 1.5269 - val_acc: 0.2931
Epoch 14/35

870/870 [==============================] - 48s 55ms/step - loss: 1.4955 - acc: 0.3287 - val_loss: 1.5212 - val_acc: 0.3138
Epoch 15/35

870/870 [==============================] - 48s 55ms/step - loss: 1.4834 - acc: 0.3333 - val_loss: 1.5159 - val_acc: 0.3483
Epoch 16/35

870/870 [==============================] - 48s 55ms/step - loss: 1.4710 - acc: 0.3425 - val_loss: 1.5108 - val_acc: 0.2828
Epoch 17/35

870/870 [==============================] - 48s 55ms/step - loss: 1.4582 - acc: 0.3460 - val_loss: 1.5060 - val_acc: 0.2897
Epoch 18/35

870/870 [==============================] - 48s 55ms/step - loss: 1.4451 - acc: 0.3563 - val_loss: 1.5014 - val_acc: 0.3000
Epoch 19/35

870/870 [==============================] - 48s 55ms/step - loss: 1.4318 - acc: 0.3793 - val_loss: 1.4970 - val_acc: 0.2966
Epoch 20/35

870/870 [==============================] - 48s 55ms/step - loss: 1.4185 - acc: 0.3920 - val_loss: 1.4924 - val_acc: 0.2931
Epoch 21/35

870/870 [==============================] - 48s 55ms/step - loss: 1.4051 - acc: 0.3931 - val_loss: 1.4872 - val_acc: 0.3000
Epoch 22/35

870/870 [==============================] - 47s 54ms/step - loss: 1.3917 - acc: 0.4069 - val_loss: 1.4812 - val_acc: 0.3276
Epoch 23/35

870/870 [==============================] - 48s 55ms/step - loss: 1.3783 - acc: 0.4207 - val_loss: 1.4750 - val_acc: 0.3345
Epoch 24/35

870/870 [==============================] - 46s 53ms/step - loss: 1.3649 - acc: 0.4276 - val_loss: 1.4691 - val_acc: 0.3690
Epoch 25/35

870/870 [==============================] - 46s 53ms/step - loss: 1.3516 - acc: 0.4448 - val_loss: 1.4638 - val_acc: 0.3759
Epoch 26/35

870/870 [==============================] - 46s 53ms/step - loss: 1.3382 - acc: 0.4563 - val_loss: 1.4595 - val_acc: 0.3897
Epoch 27/35

870/870 [==============================] - 46s 53ms/step - loss: 1.3245 - acc: 0.4678 - val_loss: 1.4563 - val_acc: 0.3828
Epoch 28/35

870/870 [==============================] - 46s 53ms/step - loss: 1.3108 - acc: 0.4609 - val_loss: 1.4540 - val_acc: 0.4276
Epoch 29/35

870/870 [==============================] - 46s 53ms/step - loss: 1.2968 - acc: 0.4563 - val_loss: 1.4524 - val_acc: 0.4966
Epoch 30/35

870/870 [==============================] - 46s 53ms/step - loss: 1.2826 - acc: 0.4793 - val_loss: 1.4507 - val_acc: 0.4931
Epoch 31/35

870/870 [==============================] - 46s 53ms/step - loss: 1.2680 - acc: 0.4897 - val_loss: 1.4484 - val_acc: 0.5103
Epoch 32/35

870/870 [==============================] - 46s 53ms/step - loss: 1.2531 - acc: 0.5092 - val_loss: 1.4451 - val_acc: 0.5207
Epoch 33/35

870/870 [==============================] - 46s 53ms/step - loss: 1.2378 - acc: 0.5264 - val_loss: 1.4410 - val_acc: 0.4897
Epoch 34/35

870/870 [==============================] - 46s 53ms/step - loss: 1.2219 - acc: 0.5103 - val_loss: 1.4367 - val_acc: 0.4621
Epoch 35/35

870/870 [==============================] - 46s 53ms/step - loss: 1.2056 - acc: 0.5046 - val_loss: 1.4321 - val_acc: 0.4414
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[1.9028060e-01 1.2835684e-01 1.5451804e-01 2.8279248e-01 2.4405208e-01]
 [3.3554935e-01 2.4773015e-01 2.2176661e-01 9.0930678e-02 1.0402321e-01]
 [1.9727668e-01 1.5747114e-01 1.7516181e-01 2.2835454e-01 2.4173585e-01]
 ...
 [3.8367423e-01 1.5277347e-01 2.2425611e-01 1.8255226e-01 5.6743931e-02]
 [1.6315995e-01 3.4362766e-01 4.9321234e-01 6.2605263e-09 1.1436816e-08]
 [1.9280201e-01 1.6090725e-01 1.8117969e-01 2.2533536e-01 2.3977563e-01]]
[3 0 4 3 0 3 0 1 3 2 1 0 0 3 3 1 2 3 0 3 2 1 0 3 3 0 2 3 0 3 3 0 3 1 3 3 3
 4 0 3 4 4 3 0 4 3 2 3 2 1 3 1 0 1 1 3 0 4 0 3 3 0 2 1 3 3 4 3 0 3 3 3 0 1
 0 3 3 3 0 3 3 0 3 2 1 3 3 3 3 1 3 0 3 3 3 3 0 1 1 3 3 3 2 2 3 3 3 3 0 3 3
 3 1 2 0 1 4 3 3 3 4 4 3 4 3 3 0 1 3 0 2 3 3 3 3 3 3 1 0 1 4 1 3 1 0 1 3 3
 3 3 3 0 3 2 2 0 3 3 0 3 3 0 1 3 2 4 0 3 4 3 3 3 3 1 3 0 3 2 3 2 0 3 1 3 3
 0 3 1 3 3 4 3 1 0 1 0 3 0 0 2 3 0 3 3 3 3 3 3 3 3 2 3 3 1 4 0 3 3 1 3 0 1
 3 3 0 3 2 3 3 3 3 3 4 3 3 3 3 0 3 3 1 3 4 3 3 2 0 3 3 3 3 3 3 3 3 3 3 3 3
 3 1 3 1 1 3 3 0 1 3 3 3 1 1 3 3 0 0 3 3 3 0 3 3 0 0 3 4 0 2 4]

 32/290 [==>...........................] - ETA: 3s
 64/290 [=====>........................] - ETA: 3s
 96/290 [========>.....................] - ETA: 2s
128/290 [============>.................] - ETA: 2s
160/290 [===============>..............] - ETA: 1s
192/290 [==================>...........] - ETA: 1s
224/290 [======================>.......] - ETA: 0s
256/290 [=========================>....] - ETA: 0s
288/290 [============================>.] - ETA: 0s
290/290 [==============================] - 4s 14ms/step
Test loss: 1.4975899055086332
Test accuracy: 0.21379310344827587
[[23 13  4 18  0]
 [12  3  4 39  0]
 [ 6 23 11 15  3]
 [13  0  3 25 17]
 [ 0  0  0 58  0]]
