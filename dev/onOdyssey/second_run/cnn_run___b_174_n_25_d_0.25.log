Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 09:06:50.275001: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 09:06:50.314193: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 09:06:50.314466: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x560f64c0a620 executing computations on platform Host. Devices:
2019-11-07 09:06:50.314516: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
[0.25]
Train on 870 samples, validate on 290 samples
Epoch 1/25

174/870 [=====>........................] - ETA: 1:09 - loss: 1.6095 - acc: 0.1724
348/870 [===========>..................] - ETA: 41s - loss: 1.6016 - acc: 0.2098 
522/870 [=================>............] - ETA: 25s - loss: 1.5873 - acc: 0.2337
696/870 [=======================>......] - ETA: 11s - loss: 1.5810 - acc: 0.2917
870/870 [==============================] - 63s 72ms/step - loss: 1.5695 - acc: 0.3023 - val_loss: 1.4584 - val_acc: 0.3000
Epoch 2/25

174/870 [=====>........................] - ETA: 40s - loss: 1.3951 - acc: 0.4195
348/870 [===========>..................] - ETA: 30s - loss: 1.3902 - acc: 0.3764
522/870 [=================>............] - ETA: 20s - loss: 1.3846 - acc: 0.3985
696/870 [=======================>......] - ETA: 10s - loss: 1.3666 - acc: 0.4325
870/870 [==============================] - 56s 64ms/step - loss: 1.3710 - acc: 0.4264 - val_loss: 1.3701 - val_acc: 0.4414
Epoch 3/25

174/870 [=====>........................] - ETA: 39s - loss: 1.2135 - acc: 0.5517
348/870 [===========>..................] - ETA: 30s - loss: 1.2257 - acc: 0.5201
522/870 [=================>............] - ETA: 20s - loss: 1.2091 - acc: 0.5096
696/870 [=======================>......] - ETA: 10s - loss: 1.2039 - acc: 0.5201
870/870 [==============================] - 56s 64ms/step - loss: 1.1846 - acc: 0.5414 - val_loss: 1.3513 - val_acc: 0.3793
Epoch 4/25

174/870 [=====>........................] - ETA: 40s - loss: 1.0689 - acc: 0.6379
348/870 [===========>..................] - ETA: 30s - loss: 1.0804 - acc: 0.6379
522/870 [=================>............] - ETA: 20s - loss: 1.0792 - acc: 0.5977
696/870 [=======================>......] - ETA: 10s - loss: 1.0648 - acc: 0.5876
870/870 [==============================] - 55s 64ms/step - loss: 1.0371 - acc: 0.6011 - val_loss: 1.3371 - val_acc: 0.4621
Epoch 5/25

174/870 [=====>........................] - ETA: 40s - loss: 0.9808 - acc: 0.7126
348/870 [===========>..................] - ETA: 30s - loss: 0.9311 - acc: 0.7126
522/870 [=================>............] - ETA: 20s - loss: 0.9272 - acc: 0.6877
696/870 [=======================>......] - ETA: 10s - loss: 0.9268 - acc: 0.6638
870/870 [==============================] - 55s 63ms/step - loss: 0.9088 - acc: 0.6552 - val_loss: 1.3146 - val_acc: 0.4897
Epoch 6/25

174/870 [=====>........................] - ETA: 39s - loss: 0.8652 - acc: 0.6954
348/870 [===========>..................] - ETA: 29s - loss: 0.8408 - acc: 0.7011
522/870 [=================>............] - ETA: 19s - loss: 0.8444 - acc: 0.6897
696/870 [=======================>......] - ETA: 9s - loss: 0.8109 - acc: 0.7126 
870/870 [==============================] - 55s 63ms/step - loss: 0.8050 - acc: 0.7046 - val_loss: 1.4038 - val_acc: 0.4966
Epoch 7/25

174/870 [=====>........................] - ETA: 39s - loss: 0.7666 - acc: 0.6724
348/870 [===========>..................] - ETA: 29s - loss: 0.7576 - acc: 0.6724
522/870 [=================>............] - ETA: 19s - loss: 0.7696 - acc: 0.6667
696/870 [=======================>......] - ETA: 9s - loss: 0.7564 - acc: 0.7083 
870/870 [==============================] - 55s 63ms/step - loss: 0.7324 - acc: 0.7425 - val_loss: 1.4165 - val_acc: 0.5552
Epoch 8/25

174/870 [=====>........................] - ETA: 39s - loss: 0.7127 - acc: 0.7989
348/870 [===========>..................] - ETA: 29s - loss: 0.6571 - acc: 0.8218
522/870 [=================>............] - ETA: 19s - loss: 0.6487 - acc: 0.8333
696/870 [=======================>......] - ETA: 9s - loss: 0.6517 - acc: 0.8075 
870/870 [==============================] - 55s 63ms/step - loss: 0.6468 - acc: 0.7954 - val_loss: 1.3751 - val_acc: 0.5345
Epoch 9/25

174/870 [=====>........................] - ETA: 39s - loss: 0.6348 - acc: 0.7299
348/870 [===========>..................] - ETA: 29s - loss: 0.6169 - acc: 0.7586
522/870 [=================>............] - ETA: 20s - loss: 0.5886 - acc: 0.7950
696/870 [=======================>......] - ETA: 10s - loss: 0.5910 - acc: 0.8147
870/870 [==============================] - 55s 63ms/step - loss: 0.5779 - acc: 0.8322 - val_loss: 1.4856 - val_acc: 0.6000
Epoch 10/25

174/870 [=====>........................] - ETA: 40s - loss: 0.4846 - acc: 0.8793
348/870 [===========>..................] - ETA: 30s - loss: 0.5458 - acc: 0.8420
522/870 [=================>............] - ETA: 20s - loss: 0.5236 - acc: 0.8602
696/870 [=======================>......] - ETA: 10s - loss: 0.5079 - acc: 0.8678
870/870 [==============================] - 55s 64ms/step - loss: 0.5075 - acc: 0.8586 - val_loss: 1.4462 - val_acc: 0.6103
Epoch 11/25

174/870 [=====>........................] - ETA: 40s - loss: 0.4538 - acc: 0.8908
348/870 [===========>..................] - ETA: 30s - loss: 0.4597 - acc: 0.8678
522/870 [=================>............] - ETA: 20s - loss: 0.4536 - acc: 0.8563
696/870 [=======================>......] - ETA: 10s - loss: 0.4497 - acc: 0.8635
870/870 [==============================] - 55s 64ms/step - loss: 0.4474 - acc: 0.8598 - val_loss: 1.5012 - val_acc: 0.6034
Epoch 12/25

174/870 [=====>........................] - ETA: 39s - loss: 0.4207 - acc: 0.8506
348/870 [===========>..................] - ETA: 29s - loss: 0.4304 - acc: 0.8764
522/870 [=================>............] - ETA: 19s - loss: 0.4244 - acc: 0.8621
696/870 [=======================>......] - ETA: 10s - loss: 0.4278 - acc: 0.8506
870/870 [==============================] - 55s 64ms/step - loss: 0.4253 - acc: 0.8517 - val_loss: 1.4415 - val_acc: 0.6448
Epoch 13/25

174/870 [=====>........................] - ETA: 39s - loss: 0.3900 - acc: 0.9310
348/870 [===========>..................] - ETA: 29s - loss: 0.4029 - acc: 0.9368
522/870 [=================>............] - ETA: 19s - loss: 0.4015 - acc: 0.9330
696/870 [=======================>......] - ETA: 10s - loss: 0.3848 - acc: 0.9397
870/870 [==============================] - 55s 63ms/step - loss: 0.3736 - acc: 0.9333 - val_loss: 1.5593 - val_acc: 0.6241
Epoch 14/25

174/870 [=====>........................] - ETA: 39s - loss: 0.3537 - acc: 0.9195
348/870 [===========>..................] - ETA: 29s - loss: 0.3069 - acc: 0.9368
522/870 [=================>............] - ETA: 19s - loss: 0.3246 - acc: 0.9349
696/870 [=======================>......] - ETA: 9s - loss: 0.3320 - acc: 0.9411 
870/870 [==============================] - 55s 63ms/step - loss: 0.3366 - acc: 0.9402 - val_loss: 1.4955 - val_acc: 0.6379
Epoch 15/25

174/870 [=====>........................] - ETA: 39s - loss: 0.3337 - acc: 0.9195
348/870 [===========>..................] - ETA: 30s - loss: 0.3030 - acc: 0.9425
522/870 [=================>............] - ETA: 20s - loss: 0.3050 - acc: 0.9330
696/870 [=======================>......] - ETA: 10s - loss: 0.3093 - acc: 0.9239
870/870 [==============================] - 55s 63ms/step - loss: 0.3054 - acc: 0.9299 - val_loss: 1.5155 - val_acc: 0.6276
Epoch 16/25

174/870 [=====>........................] - ETA: 40s - loss: 0.2949 - acc: 0.9310
348/870 [===========>..................] - ETA: 30s - loss: 0.2999 - acc: 0.9310
522/870 [=================>............] - ETA: 20s - loss: 0.2643 - acc: 0.9444
696/870 [=======================>......] - ETA: 10s - loss: 0.2717 - acc: 0.9397
870/870 [==============================] - 55s 64ms/step - loss: 0.2726 - acc: 0.9379 - val_loss: 1.4125 - val_acc: 0.7069
Epoch 17/25

174/870 [=====>........................] - ETA: 40s - loss: 0.2809 - acc: 0.9540
348/870 [===========>..................] - ETA: 30s - loss: 0.2690 - acc: 0.9540
522/870 [=================>............] - ETA: 20s - loss: 0.2682 - acc: 0.9444
696/870 [=======================>......] - ETA: 10s - loss: 0.2578 - acc: 0.9454
870/870 [==============================] - 55s 63ms/step - loss: 0.2535 - acc: 0.9483 - val_loss: 1.4084 - val_acc: 0.6724
Epoch 18/25

174/870 [=====>........................] - ETA: 39s - loss: 0.2233 - acc: 0.9655
348/870 [===========>..................] - ETA: 29s - loss: 0.2125 - acc: 0.9713
522/870 [=================>............] - ETA: 19s - loss: 0.2291 - acc: 0.9521
696/870 [=======================>......] - ETA: 9s - loss: 0.2297 - acc: 0.9483 
870/870 [==============================] - 55s 63ms/step - loss: 0.2268 - acc: 0.9529 - val_loss: 1.4748 - val_acc: 0.6517
Epoch 19/25

174/870 [=====>........................] - ETA: 39s - loss: 0.2368 - acc: 0.9483
348/870 [===========>..................] - ETA: 29s - loss: 0.2219 - acc: 0.9511
522/870 [=================>............] - ETA: 19s - loss: 0.2153 - acc: 0.9540
696/870 [=======================>......] - ETA: 10s - loss: 0.1942 - acc: 0.9626
870/870 [==============================] - 55s 63ms/step - loss: 0.1974 - acc: 0.9621 - val_loss: 1.4481 - val_acc: 0.7103
Epoch 20/25

174/870 [=====>........................] - ETA: 39s - loss: 0.1937 - acc: 0.9655
348/870 [===========>..................] - ETA: 30s - loss: 0.1916 - acc: 0.9626
522/870 [=================>............] - ETA: 20s - loss: 0.1787 - acc: 0.9732
696/870 [=======================>......] - ETA: 10s - loss: 0.1716 - acc: 0.9727
870/870 [==============================] - 56s 64ms/step - loss: 0.1753 - acc: 0.9690 - val_loss: 1.5185 - val_acc: 0.6552
Epoch 21/25

174/870 [=====>........................] - ETA: 40s - loss: 0.2050 - acc: 0.9425
348/870 [===========>..................] - ETA: 30s - loss: 0.1704 - acc: 0.9626
522/870 [=================>............] - ETA: 20s - loss: 0.1794 - acc: 0.9617
696/870 [=======================>......] - ETA: 10s - loss: 0.1675 - acc: 0.9670
870/870 [==============================] - 55s 63ms/step - loss: 0.1622 - acc: 0.9701 - val_loss: 1.5800 - val_acc: 0.6897
Epoch 22/25

174/870 [=====>........................] - ETA: 39s - loss: 0.1487 - acc: 0.9713
348/870 [===========>..................] - ETA: 29s - loss: 0.1716 - acc: 0.9598
522/870 [=================>............] - ETA: 19s - loss: 0.1643 - acc: 0.9617
696/870 [=======================>......] - ETA: 9s - loss: 0.1589 - acc: 0.9698 
870/870 [==============================] - 55s 63ms/step - loss: 0.1553 - acc: 0.9736 - val_loss: 1.4731 - val_acc: 0.6759
Epoch 23/25

174/870 [=====>........................] - ETA: 40s - loss: 0.1150 - acc: 0.9828
348/870 [===========>..................] - ETA: 29s - loss: 0.1209 - acc: 0.9799
522/870 [=================>............] - ETA: 19s - loss: 0.1328 - acc: 0.9732
696/870 [=======================>......] - ETA: 9s - loss: 0.1295 - acc: 0.9756 
870/870 [==============================] - 55s 63ms/step - loss: 0.1344 - acc: 0.9759 - val_loss: 1.4959 - val_acc: 0.6828
Epoch 24/25

174/870 [=====>........................] - ETA: 39s - loss: 0.1285 - acc: 0.9770
348/870 [===========>..................] - ETA: 29s - loss: 0.1333 - acc: 0.9741
522/870 [=================>............] - ETA: 19s - loss: 0.1279 - acc: 0.9808
696/870 [=======================>......] - ETA: 9s - loss: 0.1205 - acc: 0.9828 
870/870 [==============================] - 55s 63ms/step - loss: 0.1178 - acc: 0.9839 - val_loss: 1.5095 - val_acc: 0.6862
Epoch 25/25

174/870 [=====>........................] - ETA: 39s - loss: 0.1054 - acc: 0.9828
348/870 [===========>..................] - ETA: 29s - loss: 0.0913 - acc: 0.9914
522/870 [=================>............] - ETA: 19s - loss: 0.1015 - acc: 0.9885
696/870 [=======================>......] - ETA: 9s - loss: 0.1151 - acc: 0.9813 
870/870 [==============================] - 54s 62ms/step - loss: 0.1066 - acc: 0.9816 - val_loss: 1.4668 - val_acc: 0.7000
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[2.7315053e-01 6.9243126e-03 1.0186385e-01 1.6779527e-01 4.5026606e-01]
 [1.8699362e-04 9.9486190e-01 4.9417475e-03 4.2125962e-06 5.0992203e-06]
 [3.6270919e-01 1.7101664e-02 1.4808857e-01 4.1019672e-01 6.1903872e-02]
 ...
 [1.0620955e-06 2.5705338e-05 7.1709551e-02 9.2826360e-01 2.6149731e-09]
 [9.9868554e-01 5.4094283e-04 7.7350851e-04 1.0341361e-15 1.2606199e-28]
 [2.2371517e-01 1.1911071e-02 2.0171395e-01 4.8920110e-01 7.3458709e-02]]
[4 1 3 0 1 4 0 2 0 1 0 0 3 3 4 0 2 4 0 4 2 0 1 3 0 1 1 4 0 4 0 0 4 0 4 4 4
 3 0 0 3 3 4 1 3 0 2 0 3 1 4 0 0 2 2 3 0 2 0 4 4 0 1 0 3 4 3 4 0 4 3 4 1 0
 0 4 4 3 1 4 3 0 4 1 2 4 3 3 4 2 4 0 4 4 4 4 0 0 0 3 3 4 2 3 4 4 4 4 1 3 4
 4 0 2 0 0 3 3 4 4 2 3 3 0 3 0 0 1 3 3 2 4 0 4 0 3 0 2 3 2 3 0 3 0 0 1 3 4
 0 3 4 1 4 0 1 0 3 4 1 4 4 2 0 3 1 3 0 4 3 0 2 3 3 0 4 3 0 3 0 1 1 0 2 3 3
 0 4 0 4 4 3 4 0 3 2 3 4 0 0 0 4 0 4 3 4 4 4 0 4 4 3 4 4 0 3 1 4 0 2 3 0 2
 4 0 3 2 2 3 4 4 3 3 3 4 4 4 4 0 0 0 2 4 3 3 4 2 3 0 3 4 0 3 0 4 4 3 4 3 4
 0 2 3 2 0 4 3 0 0 0 4 4 0 2 4 2 0 0 3 4 4 3 0 4 0 4 3 3 3 0 3]

 32/290 [==>...........................] - ETA: 4s
 64/290 [=====>........................] - ETA: 4s
 96/290 [========>.....................] - ETA: 3s
128/290 [============>.................] - ETA: 3s
160/290 [===============>..............] - ETA: 2s
192/290 [==================>...........] - ETA: 1s
224/290 [======================>.......] - ETA: 1s
256/290 [=========================>....] - ETA: 0s
288/290 [============================>.] - ETA: 0s
290/290 [==============================] - 6s 19ms/step
Test loss: 2.01327805519104
Test accuracy: 0.6758620689655173
[[43  3  3  6  3]
 [ 8 19  0  4 27]
 [26  0 25  7  0]
 [ 4  0  1 53  0]
 [ 1  0  0  1 56]]
