Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:397: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-07 09:06:56.601198: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-07 09:06:56.605069: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-07 09:06:56.605180: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55b6ab0e99f0 executing computations on platform Host. Devices:
2019-11-07 09:06:56.605201: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
None
Train on 870 samples, validate on 290 samples
Epoch 1/35

870/870 [==============================] - 52s 60ms/step - loss: 1.6099 - acc: 0.1782 - val_loss: 1.5699 - val_acc: 0.2621
Epoch 2/35

870/870 [==============================] - 46s 52ms/step - loss: 1.5623 - acc: 0.3333 - val_loss: 1.5202 - val_acc: 0.2690
Epoch 3/35

870/870 [==============================] - 46s 53ms/step - loss: 1.5000 - acc: 0.4000 - val_loss: 1.4745 - val_acc: 0.2897
Epoch 4/35

870/870 [==============================] - 46s 53ms/step - loss: 1.4381 - acc: 0.4023 - val_loss: 1.4411 - val_acc: 0.2966
Epoch 5/35

870/870 [==============================] - 46s 53ms/step - loss: 1.3702 - acc: 0.4161 - val_loss: 1.4102 - val_acc: 0.4793
Epoch 6/35

870/870 [==============================] - 46s 53ms/step - loss: 1.3042 - acc: 0.6414 - val_loss: 1.3936 - val_acc: 0.4000
Epoch 7/35

870/870 [==============================] - 46s 53ms/step - loss: 1.2394 - acc: 0.5632 - val_loss: 1.3872 - val_acc: 0.3966
Epoch 8/35

870/870 [==============================] - 46s 53ms/step - loss: 1.1805 - acc: 0.5598 - val_loss: 1.3830 - val_acc: 0.4276
Epoch 9/35

870/870 [==============================] - 46s 53ms/step - loss: 1.1271 - acc: 0.6172 - val_loss: 1.3895 - val_acc: 0.4483
Epoch 10/35

870/870 [==============================] - 47s 54ms/step - loss: 1.0916 - acc: 0.6080 - val_loss: 1.4495 - val_acc: 0.3586
Epoch 11/35

870/870 [==============================] - 46s 53ms/step - loss: 1.0893 - acc: 0.5356 - val_loss: 1.3802 - val_acc: 0.4207
Epoch 12/35

870/870 [==============================] - 46s 53ms/step - loss: 1.0057 - acc: 0.6241 - val_loss: 1.3988 - val_acc: 0.5103
Epoch 13/35

870/870 [==============================] - 46s 53ms/step - loss: 0.9990 - acc: 0.7092 - val_loss: 1.3869 - val_acc: 0.4448
Epoch 14/35

870/870 [==============================] - 46s 53ms/step - loss: 0.9299 - acc: 0.6126 - val_loss: 1.4233 - val_acc: 0.4552
Epoch 15/35

870/870 [==============================] - 46s 53ms/step - loss: 0.9212 - acc: 0.6253 - val_loss: 1.3827 - val_acc: 0.5379
Epoch 16/35

870/870 [==============================] - 47s 54ms/step - loss: 0.8687 - acc: 0.7379 - val_loss: 1.3732 - val_acc: 0.5724
Epoch 17/35

870/870 [==============================] - 46s 53ms/step - loss: 0.8489 - acc: 0.7851 - val_loss: 1.3787 - val_acc: 0.5207
Epoch 18/35

870/870 [==============================] - 46s 53ms/step - loss: 0.8194 - acc: 0.6793 - val_loss: 1.4000 - val_acc: 0.5138
Epoch 19/35

870/870 [==============================] - 46s 53ms/step - loss: 0.7894 - acc: 0.6736 - val_loss: 1.4100 - val_acc: 0.5241
Epoch 20/35

870/870 [==============================] - 46s 53ms/step - loss: 0.7650 - acc: 0.7080 - val_loss: 1.4123 - val_acc: 0.5793
Epoch 21/35

870/870 [==============================] - 46s 53ms/step - loss: 0.7465 - acc: 0.7851 - val_loss: 1.4031 - val_acc: 0.5828
Epoch 22/35

870/870 [==============================] - 46s 52ms/step - loss: 0.7154 - acc: 0.8161 - val_loss: 1.4131 - val_acc: 0.5448
Epoch 23/35

870/870 [==============================] - 46s 53ms/step - loss: 0.6995 - acc: 0.7425 - val_loss: 1.4218 - val_acc: 0.5345
Epoch 24/35

870/870 [==============================] - 45s 52ms/step - loss: 0.6808 - acc: 0.7241 - val_loss: 1.4198 - val_acc: 0.5517
Epoch 25/35

870/870 [==============================] - 45s 52ms/step - loss: 0.6553 - acc: 0.7540 - val_loss: 1.4339 - val_acc: 0.6103
Epoch 26/35

870/870 [==============================] - 45s 51ms/step - loss: 0.6384 - acc: 0.8023 - val_loss: 1.4568 - val_acc: 0.6103
Epoch 27/35

870/870 [==============================] - 45s 52ms/step - loss: 0.6235 - acc: 0.8287 - val_loss: 1.4473 - val_acc: 0.6414
Epoch 28/35

870/870 [==============================] - 45s 52ms/step - loss: 0.6001 - acc: 0.8241 - val_loss: 1.4335 - val_acc: 0.5690
Epoch 29/35

870/870 [==============================] - 45s 52ms/step - loss: 0.5846 - acc: 0.7954 - val_loss: 1.4412 - val_acc: 0.5621
Epoch 30/35

870/870 [==============================] - 45s 52ms/step - loss: 0.5701 - acc: 0.7943 - val_loss: 1.4616 - val_acc: 0.5897
Epoch 31/35

870/870 [==============================] - 45s 52ms/step - loss: 0.5510 - acc: 0.8103 - val_loss: 1.4715 - val_acc: 0.6207
Epoch 32/35

870/870 [==============================] - 45s 52ms/step - loss: 0.5352 - acc: 0.8644 - val_loss: 1.4697 - val_acc: 0.6207
Epoch 33/35

870/870 [==============================] - 45s 52ms/step - loss: 0.5228 - acc: 0.8655 - val_loss: 1.4736 - val_acc: 0.6310
Epoch 34/35

870/870 [==============================] - 45s 52ms/step - loss: 0.5050 - acc: 0.8391 - val_loss: 1.4765 - val_acc: 0.6034
Epoch 35/35

870/870 [==============================] - 45s 51ms/step - loss: 0.4917 - acc: 0.8241 - val_loss: 1.4596 - val_acc: 0.6379
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[1.39584824e-01 6.20956346e-02 1.18810117e-01 3.26071709e-01
  3.53437781e-01]
 [1.66649036e-02 9.47409809e-01 3.56750339e-02 9.58272212e-05
  1.54522466e-04]
 [1.21779725e-01 5.31327948e-02 1.13884993e-01 3.06063861e-01
  4.05138642e-01]
 ...
 [2.49952753e-03 2.06407681e-02 7.90947318e-01 1.85475543e-01
  4.36780043e-04]
 [5.40620983e-01 3.96258265e-01 6.31205738e-02 1.50740306e-07
  4.15745172e-09]
 [9.14803296e-02 4.81840409e-02 1.42297074e-01 3.04018497e-01
  4.14019972e-01]]
[4 1 4 0 1 4 0 2 3 1 3 0 3 4 4 1 2 4 0 4 2 1 1 3 4 1 1 4 0 4 3 0 4 2 4 4 4
 4 0 0 4 4 4 1 4 3 2 0 3 1 4 3 0 0 2 3 0 3 2 4 4 0 1 1 3 4 4 4 0 3 3 4 1 1
 0 4 4 3 1 4 3 0 4 1 1 4 4 3 4 1 3 0 4 4 4 4 0 0 2 4 3 4 2 3 4 4 4 4 1 3 4
 3 1 2 1 1 4 4 4 4 3 4 3 4 4 3 0 1 3 3 2 4 4 4 0 3 3 2 3 2 4 1 3 0 0 1 3 4
 1 4 4 1 4 2 1 0 3 4 1 4 4 0 1 1 1 4 0 4 3 4 2 3 3 1 4 3 0 3 4 1 1 4 2 4 3
 0 4 1 4 4 4 4 2 3 2 3 4 2 0 0 4 0 4 3 4 4 4 4 4 4 3 4 4 0 4 1 4 4 2 4 0 2
 4 4 2 2 2 3 4 4 4 3 3 3 3 4 4 0 4 4 2 4 4 3 4 0 3 0 3 4 0 3 4 3 4 4 4 3 4
 0 1 3 0 1 4 4 2 0 4 4 4 1 2 4 2 0 2 3 4 3 3 4 4 0 1 3 4 2 0 4]

 32/290 [==>...........................] - ETA: 4s
 64/290 [=====>........................] - ETA: 4s
 96/290 [========>.....................] - ETA: 3s
128/290 [============>.................] - ETA: 2s
160/290 [===============>..............] - ETA: 2s
192/290 [==================>...........] - ETA: 1s
224/290 [======================>.......] - ETA: 1s
256/290 [=========================>....] - ETA: 0s
288/290 [============================>.] - ETA: 0s
290/290 [==============================] - 5s 18ms/step
Test loss: 1.7699093465147346
Test accuracy: 0.5206896551724138
[[27 12  7  7  5]
 [ 0 19  0 11 28]
 [13  9 21 12  3]
 [ 3  1  2 27 25]
 [ 0  0  0  1 57]]
