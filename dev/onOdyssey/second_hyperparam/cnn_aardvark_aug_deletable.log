Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:177: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("de...)`
  model = Model(input=[input1, input2], output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-17 17:56:27.718032: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-10-17 17:56:27.843308: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-10-17 17:56:27.843586: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x561598f5e620 executing computations on platform Host. Devices:
2019-10-17 17:56:27.843641: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Train on 1000 samples, validate on 1000 samples
Epoch 1/25

1000/1000 [==============================] - 176s 176ms/step - loss: 1.6064 - acc: 0.1980 - val_loss: 1.5552 - val_acc: 0.2600
Epoch 2/25

1000/1000 [==============================] - 159s 159ms/step - loss: 1.5013 - acc: 0.3700 - val_loss: 1.4958 - val_acc: 0.2870
Epoch 3/25

1000/1000 [==============================] - 161s 161ms/step - loss: 1.3652 - acc: 0.5250 - val_loss: 1.4513 - val_acc: 0.3290
Epoch 4/25

1000/1000 [==============================] - 161s 161ms/step - loss: 1.2487 - acc: 0.6370 - val_loss: 1.4235 - val_acc: 0.4310
Epoch 5/25

1000/1000 [==============================] - 162s 162ms/step - loss: 1.1397 - acc: 0.7460 - val_loss: 1.4633 - val_acc: 0.3300
Epoch 6/25

1000/1000 [==============================] - 163s 163ms/step - loss: 1.0852 - acc: 0.5410 - val_loss: 1.4549 - val_acc: 0.2670
Epoch 7/25

1000/1000 [==============================] - 162s 162ms/step - loss: 1.0415 - acc: 0.5830 - val_loss: 1.4161 - val_acc: 0.4480
Epoch 8/25

1000/1000 [==============================] - 162s 162ms/step - loss: 0.9365 - acc: 0.7990 - val_loss: 1.4716 - val_acc: 0.3810
Epoch 9/25

1000/1000 [==============================] - 163s 163ms/step - loss: 0.8918 - acc: 0.6500 - val_loss: 1.4524 - val_acc: 0.3810
Epoch 10/25

1000/1000 [==============================] - 162s 162ms/step - loss: 0.8215 - acc: 0.7000 - val_loss: 1.4255 - val_acc: 0.4400
Epoch 11/25

1000/1000 [==============================] - 163s 163ms/step - loss: 0.7720 - acc: 0.7830 - val_loss: 1.4398 - val_acc: 0.4500
Epoch 12/25

1000/1000 [==============================] - 163s 163ms/step - loss: 0.7387 - acc: 0.8240 - val_loss: 1.4446 - val_acc: 0.4310
Epoch 13/25

1000/1000 [==============================] - 163s 163ms/step - loss: 0.6753 - acc: 0.8050 - val_loss: 1.4954 - val_acc: 0.4230
Epoch 14/25

1000/1000 [==============================] - 163s 163ms/step - loss: 0.6502 - acc: 0.7550 - val_loss: 1.4970 - val_acc: 0.4340
Epoch 15/25

1000/1000 [==============================] - 163s 163ms/step - loss: 0.6069 - acc: 0.7840 - val_loss: 1.4803 - val_acc: 0.4740
Epoch 16/25

1000/1000 [==============================] - 163s 163ms/step - loss: 0.5691 - acc: 0.8370 - val_loss: 1.5041 - val_acc: 0.4840
Epoch 17/25

1000/1000 [==============================] - 164s 164ms/step - loss: 0.5425 - acc: 0.8580 - val_loss: 1.5552 - val_acc: 0.4670
Epoch 18/25

1000/1000 [==============================] - 164s 164ms/step - loss: 0.5069 - acc: 0.8380 - val_loss: 1.6033 - val_acc: 0.4620
Epoch 19/25

1000/1000 [==============================] - 169s 169ms/step - loss: 0.4831 - acc: 0.8350 - val_loss: 1.5760 - val_acc: 0.4940
Epoch 20/25

1000/1000 [==============================] - 164s 164ms/step - loss: 0.4547 - acc: 0.8560 - val_loss: 1.5746 - val_acc: 0.5060
Epoch 21/25

1000/1000 [==============================] - 164s 164ms/step - loss: 0.4321 - acc: 0.8630 - val_loss: 1.6288 - val_acc: 0.5070
Epoch 22/25

1000/1000 [==============================] - 165s 165ms/step - loss: 0.4110 - acc: 0.8730 - val_loss: 1.6480 - val_acc: 0.5010
Epoch 23/25

1000/1000 [==============================] - 165s 165ms/step - loss: 0.3895 - acc: 0.8820 - val_loss: 1.6276 - val_acc: 0.5060
Epoch 24/25

1000/1000 [==============================] - 166s 166ms/step - loss: 0.3698 - acc: 0.8850 - val_loss: 1.6500 - val_acc: 0.5040
Epoch 25/25

1000/1000 [==============================] - 163s 163ms/step - loss: 0.3509 - acc: 0.8810 - val_loss: 1.6941 - val_acc: 0.5030
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug10.h5 
[[1.0000000e+00 2.1771400e-21 7.4783732e-17 1.5132479e-20 1.5418283e-21]
 [3.5230771e-02 6.7091145e-02 7.1262777e-02 3.2259548e-01 5.0381982e-01]
 [3.5828713e-02 3.8387824e-02 4.4715807e-02 2.0537950e-01 6.7568821e-01]
 ...
 [3.7664574e-02 1.8965496e-02 1.1605029e-01 7.0023471e-01 1.2708497e-01]
 [6.4536102e-02 6.2276050e-02 6.8261318e-02 2.7162969e-01 5.3329682e-01]
 [5.8279078e-02 4.2569514e-02 8.8861346e-02 2.6050293e-01 5.4978710e-01]]
[0 4 4 3 4 4 2 2 4 4 3 4 4 2 4 2 2 4 4 2 2 4 4 4 4 4 4 4 2 4 4 0 3 4 2 0 4
 1 4 1 2 4 4 4 4 2 4 4 4 4 0 0 3 4 1 4 4 3 4 0 1 2 4 4 2 4 1 4 4 4 4 4 3 4
 1 4 4 4 2 2 1 3 2 3 4 1 4 4 0 2 4 4 4 1 4 4 2 2 1 2 4 4 0 0 1 0 2 4 0 4 4
 4 1 0 2 3 4 4 3 1 2 2 3 0 1 0 0 2 3 4 3 4 4 0 4 2 4 4 4 3 3 3 3 4 4 4 4 1
 4 4 4 2 1 4 1 2 2 3 2 1 4 4 4 4 0 4 4 2 4 4 1 0 0 2 4 3 4 4 4 4 2 4 4 4 4
 3 4 4 3 2 1 0 4 4 4 4 3 4 4 4 3 2 4 2 0 4 4 4 4 2 4 4 4 4 3 3 0 4 2 4 4 4
 0 1 4 0 2 4 0 3 2 1 4 3 2 4 1 4 2 4 4 0 1 2 4 2 3 0 4 3 2 4 1 4 4 4 4 4 1
 1 2 2 3 2 2 3 1 4 3 4 4 4 4 2 3 4 3 3 0 4 4 4 1 4 0 2 1 4 4 4 4 4 4 4 4 4
 3 4 4 2 4 3 4 4 0 4 4 1 4 0 3 0 0 4 2 4 3 3 4 1 4 4 4 3 4 3 4 0 1 4 4 4 4
 4 1 4 4 1 2 4 4 4 4 4 4 4 4 4 4 1 0 1 2 4 2 0 3 3 4 3 2 2 4 4 4 4 1 4 4 0
 0 4 4 4 0 2 4 3 3 0 4 4 4 4 4 3 0 4 4 4 2 1 4 4 0 4 2 1 2 4 4 2 4 1 4 4 1
 1 4 4 3 2 1 4 4 4 1 4 1 3 1 3 4 4 1 0 4 1 1 3 4 2 1 1 4 4 3 1 4 1 4 4 3 3
 4 4 1 4 2 4 4 0 4 0 0 2 0 4 4 4 2 4 4 4 4 3 2 0 0 4 4 0 4 4 0 4 4 2 4 4 3
 1 2 3 4 1 4 4 2 2 4 0 2 4 2 0 4 1 0 4 3 4 4 3 4 3 1 4 4 4 1 4 4 4 4 2 4 4
 4 4 3 4 3 4 4 2 4 2 4 4 4 3 3 3 1 1 4 2 2 0 2 3 4 2 4 2 4 4 2 4 2 3 0 4 2
 1 1 1 4 4 4 4 3 4 4 4 1 4 4 4 3 3 1 2 4 0 4 4 3 2 4 0 4 4 2 4 4 4 1 2 4 4
 2 3 4 4 4 4 4 3 0 2 4 4 4 3 3 4 3 1 4 4 0 2 0 4 4 4 1 2 4 4 4 4 4 4 3 3 2
 0 1 4 4 4 0 0 4 2 3 4 4 0 4 4 4 4 4 4 4 4 4 3 4 4 4 3 3 3 4 0 0 1 1 2 3 4
 3 3 4 3 4 3 4 4 4 0 2 0 4 1 3 4 3 2 4 4 2 2 1 0 4 4 4 4 3 4 2 4 2 3 4 4 3
 1 1 3 4 4 4 4 0 1 2 4 4 4 4 1 4 3 2 4 4 4 3 3 4 4 2 2 3 4 4 1 3 4 0 4 4 0
 4 2 4 2 3 4 4 0 4 0 4 4 3 2 4 0 3 4 3 4 4 4 3 4 4 0 0 2 1 4 4 4 4 4 4 4 2
 4 2 1 2 2 1 4 4 4 3 4 4 4 0 4 4 1 4 4 1 0 4 4 0 4 4 3 4 0 0 4 0 2 4 4 0 4
 4 4 3 4 4 4 4 2 4 4 4 2 2 4 1 4 4 4 4 4 4 4 2 4 4 4 3 4 4 4 3 3 3 4 2 0 1
 1 2 4 3 4 4 4 0 4 4 2 2 4 3 2 2 1 4 0 4 4 2 3 1 4 4 3 3 4 3 2 4 4 3 2 2 4
 4 2 3 0 4 4 3 0 2 3 4 4 4 3 0 4 1 4 4 2 0 4 1 4 4 4 4 2 3 2 3 4 1 2 0 0 1
 4 4 0 1 2 4 2 4 0 4 4 2 0 1 4 4 4 4 2 4 4 4 1 0 1 1 3 4 2 4 2 4 1 4 2 4 0
 2 1 2 4 4 4 4 4 4 2 0 4 4 4 1 4 2 2 4 4 4 1 0 4 2 4 4 4 0 4 2 4 2 0 4 3 4
 4]

  32/1000 [..............................] - ETA: 40s
  64/1000 [>.............................] - ETA: 39s
  96/1000 [=>............................] - ETA: 37s
 128/1000 [==>...........................] - ETA: 36s
 160/1000 [===>..........................] - ETA: 35s
 192/1000 [====>.........................] - ETA: 33s
 224/1000 [=====>........................] - ETA: 32s
 256/1000 [======>.......................] - ETA: 31s
 288/1000 [=======>......................] - ETA: 29s
 320/1000 [========>.....................] - ETA: 28s
 352/1000 [=========>....................] - ETA: 27s
 384/1000 [==========>...................] - ETA: 25s
 416/1000 [===========>..................] - ETA: 24s
 448/1000 [============>.................] - ETA: 23s
 480/1000 [=============>................] - ETA: 21s
 512/1000 [==============>...............] - ETA: 20s
 544/1000 [===============>..............] - ETA: 19s
 576/1000 [================>.............] - ETA: 17s
 608/1000 [=================>............] - ETA: 16s
 640/1000 [==================>...........] - ETA: 15s
 672/1000 [===================>..........] - ETA: 13s
 704/1000 [====================>.........] - ETA: 12s
 736/1000 [=====================>........] - ETA: 11s
 768/1000 [======================>.......] - ETA: 9s 
 800/1000 [=======================>......] - ETA: 8s
 832/1000 [=======================>......] - ETA: 7s
 864/1000 [========================>.....] - ETA: 5s
 896/1000 [=========================>....] - ETA: 4s
 928/1000 [==========================>...] - ETA: 3s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 42s 42ms/step
Test loss: 1.9749737815856934
Test accuracy: 0.453
[[ 57  22  48  30  43]
 [  5  60   2   0 133]
 [ 32  21  90  51   6]
 [  9   0  11  46 134]
 [  0   0   0   0 200]]
