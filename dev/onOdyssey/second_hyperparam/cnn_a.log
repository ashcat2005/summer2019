Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:340: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-03 22:39:55.276153: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-03 22:39:55.280169: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-03 22:39:55.280291: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55f67c8ac550 executing computations on platform Host. Devices:
2019-11-03 22:39:55.280310: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
loaded
Train on 1000 samples, validate on 1000 samples
Epoch 1/35

1000/1000 [==============================] - 171s 171ms/step - loss: 1.6096 - acc: 0.1840 - val_loss: 1.5505 - val_acc: 0.2480
Epoch 2/35

1000/1000 [==============================] - 158s 158ms/step - loss: 1.4091 - acc: 0.3950 - val_loss: 1.5063 - val_acc: 0.2710
Epoch 3/35

1000/1000 [==============================] - 159s 159ms/step - loss: 1.2230 - acc: 0.4790 - val_loss: 1.4956 - val_acc: 0.3130
Epoch 4/35

1000/1000 [==============================] - 159s 159ms/step - loss: 1.0934 - acc: 0.6370 - val_loss: 1.5225 - val_acc: 0.4000
Epoch 5/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.9803 - acc: 0.6930 - val_loss: 1.5856 - val_acc: 0.4430
Epoch 6/35

1000/1000 [==============================] - 159s 159ms/step - loss: 0.8709 - acc: 0.7360 - val_loss: 1.7375 - val_acc: 0.3870
Epoch 7/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.8292 - acc: 0.6600 - val_loss: 1.7710 - val_acc: 0.3710
Epoch 8/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.7710 - acc: 0.7250 - val_loss: 1.8057 - val_acc: 0.4020
Epoch 9/35

1000/1000 [==============================] - 159s 159ms/step - loss: 0.6908 - acc: 0.8310 - val_loss: 1.9174 - val_acc: 0.4090
Epoch 10/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.6495 - acc: 0.7190 - val_loss: 1.9924 - val_acc: 0.4150
Epoch 11/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.6030 - acc: 0.7300 - val_loss: 2.0275 - val_acc: 0.4430
Epoch 12/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.5591 - acc: 0.7960 - val_loss: 2.0601 - val_acc: 0.4550
Epoch 13/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.5313 - acc: 0.8580 - val_loss: 2.0905 - val_acc: 0.4390
Epoch 14/35

1000/1000 [==============================] - 162s 162ms/step - loss: 0.4904 - acc: 0.8610 - val_loss: 2.1541 - val_acc: 0.4300
Epoch 15/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.4664 - acc: 0.8520 - val_loss: 2.2180 - val_acc: 0.4250
Epoch 16/35

1000/1000 [==============================] - 159s 159ms/step - loss: 0.4362 - acc: 0.8530 - val_loss: 2.2804 - val_acc: 0.4380
Epoch 17/35

1000/1000 [==============================] - 157s 157ms/step - loss: 0.4070 - acc: 0.8630 - val_loss: 2.3294 - val_acc: 0.4440
Epoch 18/35

1000/1000 [==============================] - 161s 161ms/step - loss: 0.3886 - acc: 0.8860 - val_loss: 2.3434 - val_acc: 0.4430
Epoch 19/35

1000/1000 [==============================] - 162s 162ms/step - loss: 0.3589 - acc: 0.8910 - val_loss: 2.3746 - val_acc: 0.5000
Epoch 20/35

1000/1000 [==============================] - 162s 162ms/step - loss: 0.3398 - acc: 0.9250 - val_loss: 2.4127 - val_acc: 0.5190
Epoch 21/35

1000/1000 [==============================] - 159s 159ms/step - loss: 0.3211 - acc: 0.9260 - val_loss: 2.4469 - val_acc: 0.4670
Epoch 22/35

1000/1000 [==============================] - 156s 156ms/step - loss: 0.2967 - acc: 0.9240 - val_loss: 2.5000 - val_acc: 0.4460
Epoch 23/35

1000/1000 [==============================] - 162s 162ms/step - loss: 0.2868 - acc: 0.9200 - val_loss: 2.5176 - val_acc: 0.4530
Epoch 24/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.2627 - acc: 0.9410 - val_loss: 2.5472 - val_acc: 0.5280
Epoch 25/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.2530 - acc: 0.9530 - val_loss: 2.5587 - val_acc: 0.5270
Epoch 26/35

1000/1000 [==============================] - 153s 153ms/step - loss: 0.2355 - acc: 0.9590 - val_loss: 2.5762 - val_acc: 0.4970
Epoch 27/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.2228 - acc: 0.9750 - val_loss: 2.6027 - val_acc: 0.5250
Epoch 28/35

1000/1000 [==============================] - 162s 162ms/step - loss: 0.2098 - acc: 0.9770 - val_loss: 2.6305 - val_acc: 0.5250
Epoch 29/35

1000/1000 [==============================] - 156s 156ms/step - loss: 0.1983 - acc: 0.9630 - val_loss: 2.6465 - val_acc: 0.5260
Epoch 30/35

1000/1000 [==============================] - 154s 154ms/step - loss: 0.1865 - acc: 0.9650 - val_loss: 2.6624 - val_acc: 0.4960
Epoch 31/35

1000/1000 [==============================] - 162s 162ms/step - loss: 0.1761 - acc: 0.9790 - val_loss: 2.6892 - val_acc: 0.5120
Epoch 32/35

1000/1000 [==============================] - 162s 162ms/step - loss: 0.1666 - acc: 0.9830 - val_loss: 2.7158 - val_acc: 0.5310
Epoch 33/35

1000/1000 [==============================] - 161s 161ms/step - loss: 0.1565 - acc: 0.9810 - val_loss: 2.7362 - val_acc: 0.5270
Epoch 34/35

1000/1000 [==============================] - 161s 161ms/step - loss: 0.1489 - acc: 0.9810 - val_loss: 2.7408 - val_acc: 0.5360
Epoch 35/35

1000/1000 [==============================] - 151s 151ms/step - loss: 0.1397 - acc: 0.9850 - val_loss: 2.7578 - val_acc: 0.5310
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[4.90327924e-02 8.12514313e-03 1.32644027e-01 4.12037849e-01
  3.98160160e-01]
 [3.61583568e-02 1.51259881e-02 1.57758638e-01 2.90031880e-01
  5.00925183e-01]
 [5.10894470e-02 1.08031416e-02 1.12781651e-01 2.75634497e-01
  5.49691200e-01]
 ...
 [1.00000000e+00 4.35044402e-26 2.43551483e-14 3.33584040e-20
  3.97752701e-24]
 [5.92474942e-04 1.22442186e-01 8.76965106e-01 1.93558321e-07
  5.84185633e-09]
 [4.61778417e-02 8.37517437e-03 1.04174182e-01 4.35270369e-01
  4.06002402e-01]]
[3 4 4 2 3 0 4 2 4 2 4 3 0 0 4 2 2 4 2 4 1 4 2 4 2 3 3 2 3 3 3 3 4 4 3 2 2
 4 2 2 2 0 0 4 3 3 2 2 4 2 1 2 2 2 2 4 2 3 3 0 2 0 3 2 1 3 4 3 3 2 3 1 4 0
 3 2 2 3 0 3 2 3 4 4 0 1 4 3 4 4 4 2 3 0 3 4 4 3 3 4 4 3 1 3 3 1 4 2 4 3 4
 2 4 3 3 2 2 3 4 2 0 2 3 3 2 2 3 1 2 1 0 2 3 2 2 3 4 2 3 4 4 3 2 2 0 2 4 4
 2 0 4 3 4 2 3 2 4 3 0 4 0 1 3 4 3 3 3 3 3 3 1 4 3 3 2 0 2 4 2 3 3 1 4 4 4
 2 4 2 0 2 3 2 2 4 2 4 4 2 2 3 4 4 4 3 2 4 4 0 4 0 4 0 2 3 4 3 1 4 1 1 1 3
 2 4 3 4 1 4 2 4 2 4 3 3 2 3 3 1 0 3 0 4 1 1 4 4 4 1 4 3 4 0 4 4 2 3 1 2 2
 3 2 4 4 1 3 3 4 2 4 0 4 4 1 1 3 1 4 3 0 3 4 2 1 4 4 2 3 3 3 2 4 4 4 4 0 3
 2 4 2 2 2 3 2 2 2 4 3 0 4 2 0 3 2 2 4 3 4 2 3 3 4 0 4 3 0 2 4 3 4 2 2 4 4
 3 3 0 3 2 1 2 0 3 4 3 4 3 4 4 3 4 4 4 2 3 3 2 4 4 1 0 1 3 3 4 4 4 3 4 4 4
 1 2 2 4 2 0 1 4 2 4 4 3 0 4 2 3 4 4 4 2 3 4 1 1 1 0 3 4 3 0 3 2 4 0 3 2 0
 2 2 3 3 0 2 4 3 0 4 1 0 4 3 4 3 2 4 4 2 3 4 2 2 2 3 3 1 3 2 3 3 2 0 0 4 4
 4 4 3 4 3 4 3 1 2 0 4 0 1 3 3 3 3 1 4 4 2 3 3 1 4 0 1 2 3 3 3 4 4 4 4 4 3
 4 4 2 3 1 2 0 4 3 1 3 2 3 2 3 3 4 0 2 1 2 4 3 3 3 0 3 0 4 4 4 1 4 4 2 4 0
 4 0 0 4 2 0 0 3 2 3 1 2 2 4 1 4 2 0 3 1 4 2 0 2 1 1 4 3 1 3 4 4 2 1 3 3 3
 4 3 0 4 2 2 3 4 0 3 3 2 3 2 4 3 1 3 0 0 4 3 4 4 3 4 4 3 4 4 4 2 3 3 3 0 2
 2 4 2 2 1 4 4 2 1 3 1 1 2 3 4 4 4 3 4 3 3 4 0 2 4 3 3 4 4 2 2 1 3 2 4 4 4
 1 3 3 2 2 0 3 4 2 4 3 1 4 4 4 4 1 4 4 0 4 2 4 3 2 1 0 3 2 3 2 2 0 4 3 0 4
 4 2 3 3 0 2 3 2 0 4 3 3 3 3 2 3 3 2 4 3 4 4 4 1 2 3 0 4 0 3 4 3 4 4 2 1 2
 0 2 4 2 2 2 4 4 3 3 3 4 4 3 2 2 2 0 1 1 3 1 1 3 0 3 4 3 2 2 4 4 2 4 1 4 2
 1 4 2 0 0 2 3 2 0 3 4 0 2 4 1 1 2 0 1 2 2 1 1 4 4 4 3 4 3 3 0 4 3 3 2 3 4
 3 3 3 4 0 4 2 4 1 4 0 2 1 3 4 4 4 4 1 1 2 2 3 4 3 1 2 3 3 1 0 4 3 1 2 0 2
 3 3 1 4 1 4 2 3 4 4 0 2 4 3 1 3 3 2 0 3 2 2 3 2 1 4 0 1 2 3 4 4 3 0 4 3 3
 1 4 3 4 4 3 4 3 4 2 0 4 4 3 2 4 3 3 4 4 0 0 4 2 3 3 2 3 4 3 3 3 2 4 0 3 3
 2 4 1 2 1 0 4 1 2 4 4 2 3 1 1 2 1 0 0 3 2 2 4 4 4 4 1 2 1 4 2 4 3 4 4 2 4
 2 0 2 4 4 1 2 2 4 2 3 4 2 3 3 3 4 3 2 2 3 3 3 4 4 4 4 3 4 1 3 3 4 2 4 1 2
 3 2 1 0 4 3 4 4 3 3 3 2 4 3 2 3 4 0 0 1 3 4 3 4 4 3 4 3 3 2 4 2 1 4 3 0 2
 3]

  32/1000 [..............................] - ETA: 43s
  64/1000 [>.............................] - ETA: 41s
  96/1000 [=>............................] - ETA: 40s
 128/1000 [==>...........................] - ETA: 39s
 160/1000 [===>..........................] - ETA: 37s
 192/1000 [====>.........................] - ETA: 36s
 224/1000 [=====>........................] - ETA: 34s
 256/1000 [======>.......................] - ETA: 33s
 288/1000 [=======>......................] - ETA: 32s
 320/1000 [========>.....................] - ETA: 30s
 352/1000 [=========>....................] - ETA: 29s
 384/1000 [==========>...................] - ETA: 27s
 416/1000 [===========>..................] - ETA: 26s
 448/1000 [============>.................] - ETA: 24s
 480/1000 [=============>................] - ETA: 23s
 512/1000 [==============>...............] - ETA: 22s
 544/1000 [===============>..............] - ETA: 20s
 576/1000 [================>.............] - ETA: 19s
 608/1000 [=================>............] - ETA: 17s
 640/1000 [==================>...........] - ETA: 16s
 672/1000 [===================>..........] - ETA: 14s
 704/1000 [====================>.........] - ETA: 13s
 736/1000 [=====================>........] - ETA: 11s
 768/1000 [======================>.......] - ETA: 10s
 800/1000 [=======================>......] - ETA: 8s 
 832/1000 [=======================>......] - ETA: 7s
 864/1000 [========================>.....] - ETA: 6s
 896/1000 [=========================>....] - ETA: 4s
 928/1000 [==========================>...] - ETA: 3s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 45s 45ms/step
Test loss: 2.3155872898101806
Test accuracy: 0.443
[[ 62  48  44  14  32]
 [ 17   4  55   0 124]
 [ 17  51 118  10   4]
 [  8   0   2 154  36]
 [  0   0   3  92 105]]
