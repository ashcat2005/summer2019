Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-06 22:12:12.555835: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-10-06 22:12:12.696581: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-10-06 22:12:12.696861: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55edbdf09130 executing computations on platform Host. Devices:
2019-10-06 22:12:12.696917: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-10-06 22:12:21.347521: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
2019-10-06 22:13:16.267657: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
2019-10-06 22:14:37.124067: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
0
286
57
1
16
3
2
76
15
3
18
3
4
9
3
Train on 1000 samples, validate on 1000 samples
Epoch 1/40

1000/1000 [==============================] - 184s 184ms/step - loss: 1.6102 - acc: 0.2080 - val_loss: 1.5559 - val_acc: 0.2580
2019-10-06 22:15:18.955192: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
2019-10-06 22:16:09.365106: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
Epoch 2/40

1000/1000 [==============================] - 166s 166ms/step - loss: 1.5036 - acc: 0.4890 - val_loss: 1.4892 - val_acc: 0.2880
Epoch 3/40

1000/1000 [==============================] - 165s 165ms/step - loss: 1.3587 - acc: 0.5380 - val_loss: 1.4400 - val_acc: 0.2980
Epoch 4/40

1000/1000 [==============================] - 167s 167ms/step - loss: 1.2299 - acc: 0.6390 - val_loss: 1.4216 - val_acc: 0.3910
Epoch 5/40

1000/1000 [==============================] - 165s 165ms/step - loss: 1.1217 - acc: 0.6380 - val_loss: 1.4106 - val_acc: 0.4450
Epoch 6/40

1000/1000 [==============================] - 165s 165ms/step - loss: 1.0327 - acc: 0.7640 - val_loss: 1.4410 - val_acc: 0.3790
Epoch 7/40

1000/1000 [==============================] - 163s 163ms/step - loss: 0.9674 - acc: 0.6240 - val_loss: 1.4430 - val_acc: 0.2960
Epoch 8/40

1000/1000 [==============================] - 165s 165ms/step - loss: 0.9307 - acc: 0.6500 - val_loss: 1.4161 - val_acc: 0.4200
Epoch 9/40

1000/1000 [==============================] - 161s 161ms/step - loss: 0.8183 - acc: 0.7380 - val_loss: 1.5221 - val_acc: 0.3700
Epoch 10/40

1000/1000 [==============================] - 163s 163ms/step - loss: 0.8163 - acc: 0.6640 - val_loss: 1.4213 - val_acc: 0.4430
Epoch 11/40

1000/1000 [==============================] - 162s 162ms/step - loss: 0.7333 - acc: 0.8130 - val_loss: 1.4484 - val_acc: 0.5280
Epoch 12/40

1000/1000 [==============================] - 163s 163ms/step - loss: 0.7029 - acc: 0.8870 - val_loss: 1.4785 - val_acc: 0.4400
Epoch 13/40

1000/1000 [==============================] - 162s 162ms/step - loss: 0.6476 - acc: 0.7790 - val_loss: 1.5184 - val_acc: 0.4300
Epoch 14/40

1000/1000 [==============================] - 161s 161ms/step - loss: 0.6160 - acc: 0.7600 - val_loss: 1.4874 - val_acc: 0.4420
Epoch 15/40

1000/1000 [==============================] - 161s 161ms/step - loss: 0.5788 - acc: 0.7990 - val_loss: 1.4824 - val_acc: 0.4720
Epoch 16/40

1000/1000 [==============================] - 164s 164ms/step - loss: 0.5458 - acc: 0.8430 - val_loss: 1.5147 - val_acc: 0.4780
Epoch 17/40

1000/1000 [==============================] - 160s 160ms/step - loss: 0.5098 - acc: 0.8350 - val_loss: 1.5476 - val_acc: 0.4760
Epoch 18/40

1000/1000 [==============================] - 163s 163ms/step - loss: 0.4945 - acc: 0.8430 - val_loss: 1.5285 - val_acc: 0.5030
Epoch 19/40

1000/1000 [==============================] - 163s 163ms/step - loss: 0.4616 - acc: 0.8690 - val_loss: 1.5277 - val_acc: 0.5150
Epoch 20/40

1000/1000 [==============================] - 162s 162ms/step - loss: 0.4413 - acc: 0.8820 - val_loss: 1.5694 - val_acc: 0.4950
Epoch 21/40

1000/1000 [==============================] - 162s 162ms/step - loss: 0.4156 - acc: 0.8640 - val_loss: 1.6229 - val_acc: 0.4860
Restoring model weights from the end of the best epoch
Epoch 00021: early stopping
[[1.13512196e-01 1.33071557e-01 1.82261378e-01 2.75193900e-01
  2.95960963e-01]
 [1.40118212e-01 1.40492767e-01 2.07747236e-01 2.90679783e-01
  2.20962048e-01]
 [1.02984905e-01 1.42624497e-01 1.77594423e-01 2.71579236e-01
  3.05216998e-01]
 ...
 [2.63488619e-04 2.19690404e-03 5.75149083e-04 9.96819258e-01
  1.45196303e-04]
 [7.38241002e-02 4.36429739e-01 4.45208609e-01 1.80065222e-02
  2.65310891e-02]
 [9.93573129e-01 3.51693504e-03 2.84008565e-03 6.67160857e-05
  3.14509020e-06]]
[4 3 4 1 1 2 3 1 3 1 3 3 3 1 3 3 1 3 3 2 1 1 4 3 2 1 4 3 4 3 0 3 1 3 3 0 4
 0 0 1 3 2 4 4 3 4 2 1 3 1 1 0 4 3 1 3 4 4 4 3 3 4 4 2 3 0 0 3 3 3 3 3 3 4
 3 2 0 4 1 1 3 4 3 3 2 3 0 3 1 2 3 3 1 0 3 4 3 3 0 3 4 3 4 4 3 3 4 2 4 1 3
 1 3 3 3 3 4 1 4 3 1 4 4 1 1 3 4 4 1 4 3 4 1 4 3 3 4 2 1 3 2 1 4 4 1 4 1 4
 1 4 3 4 3 3 3 3 4 3 4 4 4 3 3 1 4 0 1 1 3 2 4 4 2 3 0 3 3 4 4 3 3 2 2 4 4
 4 3 2 3 4 1 2 4 2 2 0 0 2 4 4 4 3 3 0 1 0 0 4 0 1 1 1 1 3 1 1 2 4 4 4 4 3
 1 4 4 3 3 0 3 0 3 4 3 3 4 3 2 3 3 4 3 3 4 1 3 3 1 4 4 3 3 3 4 3 3 2 0 4 3
 3 4 0 3 1 3 4 4 4 3 0 3 3 0 3 4 0 2 4 1 3 1 3 3 2 4 2 2 3 3 4 3 4 2 1 2 3
 2 3 4 3 0 2 4 0 3 1 4 3 3 3 3 3 4 0 3 3 3 2 3 4 0 1 2 0 4 4 3 3 4 4 3 1 1
 0 3 3 2 2 3 4 2 1 4 4 2 2 1 3 4 3 1 3 4 1 3 3 0 2 3 1 2 1 1 3 3 4 2 2 3 2
 1 4 3 3 4 3 3 0 3 1 3 4 4 3 3 3 4 3 2 4 3 1 3 1 2 2 2 3 3 4 3 2 3 4 3 3 3
 4 3 4 4 1 3 1 4 1 4 3 2 3 3 1 3 2 4 1 0 4 4 3 3 4 2 1 2 4 2 3 3 2 4 4 1 2
 3 1 1 3 1 3 3 3 4 2 2 4 1 1 3 4 4 3 4 2 3 0 0 3 1 3 4 1 3 4 4 3 2 3 4 3 0
 1 3 3 3 1 4 4 1 4 2 4 3 0 3 3 1 3 4 3 1 3 1 0 3 1 3 2 3 3 3 3 3 4 4 3 1 3
 2 0 1 3 1 0 3 4 3 1 3 1 1 0 4 3 4 3 2 3 1 0 3 1 0 3 3 4 3 1 1 2 1 0 3 3 3
 1 1 3 3 4 3 1 4 3 0 4 3 1 3 0 2 3 2 4 3 3 1 2 1 3 3 3 2 1 3 1 1 4 4 1 3 3
 3 3 3 3 3 2 4 4 4 2 3 1 3 1 4 2 4 2 3 1 1 0 3 3 1 4 4 3 3 3 2 4 0 4 1 0 3
 3 1 4 3 3 3 4 2 4 4 3 2 1 3 4 4 2 3 0 3 4 3 3 2 4 4 3 1 3 2 3 3 0 3 1 1 3
 3 4 1 2 3 3 1 2 4 1 1 1 1 2 3 3 3 3 4 1 4 4 4 2 3 1 4 3 2 1 3 3 3 3 3 4 4
 3 4 2 2 4 2 4 1 3 3 1 2 3 3 1 4 4 2 3 3 3 2 2 3 1 2 3 2 2 1 4 0 1 2 3 0 1
 2 2 0 1 4 3 3 3 3 3 3 3 1 1 3 4 3 0 4 0 3 3 3 3 1 2 0 1 3 4 1 3 1 3 4 4 0
 4 1 4 4 1 3 1 1 2 1 4 4 1 4 3 0 3 0 4 3 4 3 2 2 1 1 3 4 1 1 3 3 3 3 2 3 4
 3 3 4 3 3 0 1 1 3 4 3 4 3 3 1 3 3 1 1 3 2 3 4 1 4 3 4 3 3 2 3 4 3 3 3 1 1
 0 2 3 4 4 3 3 4 1 3 3 3 2 1 3 3 2 3 4 2 4 0 2 2 3 4 1 3 1 3 3 3 4 4 2 1 3
 3 3 4 1 2 1 2 3 1 1 3 3 3 4 4 3 1 2 1 4 3 2 2 3 3 3 3 4 2 3 2 1 3 4 3 4 4
 3 3 4 3 2 1 4 3 4 3 4 4 3 3 3 1 1 4 0 4 2 3 0 3 1 3 4 4 4 4 0 4 4 4 4 2 3
 4 1 2 3 2 1 4 2 0 4 3 1 2 1 0 3 4 3 3 3 4 3 3 4 0 4 0 2 3 3 2 3 4 1 4 3 2
 0]

  32/1000 [..............................] - ETA: 43s
  64/1000 [>.............................] - ETA: 42s
  96/1000 [=>............................] - ETA: 52s
 128/1000 [==>...........................] - ETA: 50s
 160/1000 [===>..........................] - ETA: 46s
 192/1000 [====>.........................] - ETA: 44s
 224/1000 [=====>........................] - ETA: 42s
 256/1000 [======>.......................] - ETA: 40s
 288/1000 [=======>......................] - ETA: 37s
 320/1000 [========>.....................] - ETA: 37s
 352/1000 [=========>....................] - ETA: 34s
 384/1000 [==========>...................] - ETA: 32s
 416/1000 [===========>..................] - ETA: 32s
 448/1000 [============>.................] - ETA: 30s
 480/1000 [=============>................] - ETA: 30s
 512/1000 [==============>...............] - ETA: 28s
 544/1000 [===============>..............] - ETA: 26s
 576/1000 [================>.............] - ETA: 24s
 608/1000 [=================>............] - ETA: 21s
 640/1000 [==================>...........] - ETA: 19s
 672/1000 [===================>..........] - ETA: 18s
 704/1000 [====================>.........] - ETA: 16s
 736/1000 [=====================>........] - ETA: 14s
 768/1000 [======================>.......] - ETA: 12s
 800/1000 [=======================>......] - ETA: 10s
 832/1000 [=======================>......] - ETA: 8s 
 864/1000 [========================>.....] - ETA: 7s
 896/1000 [=========================>....] - ETA: 5s
 928/1000 [==========================>...] - ETA: 3s
 960/1000 [===========================>..] - ETA: 2s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 52s 52ms/step
Test loss: 1.6379711418151854
Test accuracy: 0.484
[[ 48  48  49  39  16]
 [  0  42  25 133   0]
 [ 17  90  41  52   0]
 [  8   0  13 155  24]
 [  0   0   0   2 198]]
