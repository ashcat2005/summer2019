Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:340: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-03 22:37:53.667243: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-03 22:37:54.158748: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-03 22:37:54.159027: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x56189c1abd80 executing computations on platform Host. Devices:
2019-11-03 22:37:54.159080: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
loaded
Train on 1000 samples, validate on 1000 samples
Epoch 1/35

1000/1000 [==============================] - 133s 133ms/step - loss: 1.6141 - acc: 0.2110 - val_loss: 1.5992 - val_acc: 0.3280
Epoch 2/35

1000/1000 [==============================] - 110s 110ms/step - loss: 1.5840 - acc: 0.3440 - val_loss: 1.5870 - val_acc: 0.3160
Epoch 3/35

1000/1000 [==============================] - 108s 108ms/step - loss: 1.5513 - acc: 0.4110 - val_loss: 1.5751 - val_acc: 0.3310
Epoch 4/35

1000/1000 [==============================] - 108s 108ms/step - loss: 1.5186 - acc: 0.4360 - val_loss: 1.5635 - val_acc: 0.3530
Epoch 5/35

1000/1000 [==============================] - 110s 110ms/step - loss: 1.4867 - acc: 0.4370 - val_loss: 1.5528 - val_acc: 0.3750
Epoch 6/35

1000/1000 [==============================] - 110s 110ms/step - loss: 1.4560 - acc: 0.4460 - val_loss: 1.5427 - val_acc: 0.3670
Epoch 7/35

1000/1000 [==============================] - 108s 108ms/step - loss: 1.4263 - acc: 0.4490 - val_loss: 1.5337 - val_acc: 0.3490
Epoch 8/35

1000/1000 [==============================] - 111s 111ms/step - loss: 1.3977 - acc: 0.4510 - val_loss: 1.5258 - val_acc: 0.3330
Epoch 9/35

1000/1000 [==============================] - 107s 107ms/step - loss: 1.3702 - acc: 0.4620 - val_loss: 1.5192 - val_acc: 0.3350
Epoch 10/35

1000/1000 [==============================] - 110s 110ms/step - loss: 1.3438 - acc: 0.4730 - val_loss: 1.5137 - val_acc: 0.3610
Epoch 11/35

1000/1000 [==============================] - 109s 109ms/step - loss: 1.3181 - acc: 0.4860 - val_loss: 1.5095 - val_acc: 0.3830
Epoch 12/35

1000/1000 [==============================] - 111s 111ms/step - loss: 1.2930 - acc: 0.5120 - val_loss: 1.5063 - val_acc: 0.4040
Epoch 13/35

1000/1000 [==============================] - 110s 110ms/step - loss: 1.2684 - acc: 0.5360 - val_loss: 1.5042 - val_acc: 0.4150
Epoch 14/35

1000/1000 [==============================] - 109s 109ms/step - loss: 1.2443 - acc: 0.5500 - val_loss: 1.5033 - val_acc: 0.4230
Epoch 15/35

1000/1000 [==============================] - 107s 107ms/step - loss: 1.2206 - acc: 0.5810 - val_loss: 1.5036 - val_acc: 0.4230
Epoch 16/35

1000/1000 [==============================] - 108s 108ms/step - loss: 1.1972 - acc: 0.5900 - val_loss: 1.5051 - val_acc: 0.4220
Epoch 17/35

1000/1000 [==============================] - 111s 111ms/step - loss: 1.1742 - acc: 0.5920 - val_loss: 1.5083 - val_acc: 0.4230
Epoch 18/35

1000/1000 [==============================] - 107s 107ms/step - loss: 1.1518 - acc: 0.6070 - val_loss: 1.5132 - val_acc: 0.4150
Epoch 19/35

1000/1000 [==============================] - 111s 111ms/step - loss: 1.1300 - acc: 0.6000 - val_loss: 1.5200 - val_acc: 0.4130
Epoch 20/35

1000/1000 [==============================] - 110s 110ms/step - loss: 1.1089 - acc: 0.6000 - val_loss: 1.5286 - val_acc: 0.4160
Epoch 21/35

1000/1000 [==============================] - 112s 112ms/step - loss: 1.0886 - acc: 0.6000 - val_loss: 1.5389 - val_acc: 0.4120
Epoch 22/35

1000/1000 [==============================] - 110s 110ms/step - loss: 1.0689 - acc: 0.5980 - val_loss: 1.5505 - val_acc: 0.4120
Epoch 23/35

1000/1000 [==============================] - 112s 112ms/step - loss: 1.0499 - acc: 0.6010 - val_loss: 1.5630 - val_acc: 0.4110
Epoch 24/35

1000/1000 [==============================] - 111s 111ms/step - loss: 1.0314 - acc: 0.6080 - val_loss: 1.5763 - val_acc: 0.4140
Epoch 25/35

1000/1000 [==============================] - 110s 110ms/step - loss: 1.0132 - acc: 0.6150 - val_loss: 1.5902 - val_acc: 0.4140
Epoch 26/35

1000/1000 [==============================] - 110s 110ms/step - loss: 0.9954 - acc: 0.6190 - val_loss: 1.6048 - val_acc: 0.4160
Epoch 27/35

1000/1000 [==============================] - 115s 115ms/step - loss: 0.9780 - acc: 0.6250 - val_loss: 1.6202 - val_acc: 0.4220
Epoch 28/35

1000/1000 [==============================] - 110s 110ms/step - loss: 0.9611 - acc: 0.6320 - val_loss: 1.6364 - val_acc: 0.4220
Epoch 29/35

1000/1000 [==============================] - 112s 112ms/step - loss: 0.9445 - acc: 0.6340 - val_loss: 1.6533 - val_acc: 0.4190
Epoch 30/35

1000/1000 [==============================] - 114s 114ms/step - loss: 0.9282 - acc: 0.6380 - val_loss: 1.6711 - val_acc: 0.4190
Epoch 31/35

1000/1000 [==============================] - 113s 113ms/step - loss: 0.9123 - acc: 0.6430 - val_loss: 1.6888 - val_acc: 0.4180
Epoch 32/35

1000/1000 [==============================] - 110s 110ms/step - loss: 0.8970 - acc: 0.6440 - val_loss: 1.7054 - val_acc: 0.4180
Epoch 33/35

1000/1000 [==============================] - 113s 113ms/step - loss: 0.8822 - acc: 0.6500 - val_loss: 1.7201 - val_acc: 0.4240
Epoch 34/35

1000/1000 [==============================] - 114s 114ms/step - loss: 0.8678 - acc: 0.6550 - val_loss: 1.7337 - val_acc: 0.4240
Epoch 35/35

1000/1000 [==============================] - 112s 112ms/step - loss: 0.8538 - acc: 0.6570 - val_loss: 1.7470 - val_acc: 0.4240
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[1.7698073e-01 5.8614165e-02 1.5866603e-01 1.8276516e-01 4.2297390e-01]
 [1.5028690e-01 6.3665785e-02 1.5460472e-01 2.0915639e-01 4.2228618e-01]
 [1.6539381e-01 6.8955928e-02 1.5228713e-01 1.9500342e-01 4.1835964e-01]
 ...
 [9.9997532e-01 5.3815019e-09 1.4123093e-08 1.0028178e-05 1.4661995e-05]
 [7.6853395e-02 3.5132697e-01 4.5750087e-01 4.9886413e-02 6.4432234e-02]
 [1.3436908e-01 6.8180360e-02 1.6701452e-01 2.0749120e-01 4.2294487e-01]]
[4 4 4 1 4 4 4 2 3 2 4 4 0 0 4 2 1 4 2 4 2 4 1 4 0 4 4 2 4 4 4 4 4 4 4 2 1
 4 2 1 2 4 2 4 4 4 0 2 4 2 2 1 1 2 2 4 1 4 4 4 2 0 4 2 2 4 4 4 4 0 4 1 4 4
 4 2 1 4 1 4 2 4 4 4 0 1 4 4 4 4 4 2 4 0 4 4 4 4 4 4 4 4 1 4 4 1 4 2 4 4 4
 2 4 4 4 2 2 3 4 2 0 2 4 4 1 2 4 1 1 2 0 2 4 1 1 4 4 1 4 4 4 4 2 2 1 2 0 4
 2 4 4 4 4 2 4 2 4 4 0 4 4 1 4 4 4 4 4 4 4 4 2 4 4 4 2 4 2 4 2 4 4 2 4 4 4
 2 4 2 2 2 4 2 0 4 4 4 4 1 1 4 4 4 4 4 2 4 4 4 4 4 4 0 2 4 4 4 1 4 1 1 1 4
 2 4 4 4 2 4 4 4 2 4 4 4 4 4 4 0 1 4 2 4 1 1 4 4 4 1 4 4 4 0 0 4 4 4 1 2 1
 4 2 4 4 2 4 4 4 1 4 0 4 4 1 1 4 1 4 4 0 4 4 2 1 1 4 0 4 4 4 2 4 3 4 4 2 4
 2 4 2 2 0 4 1 2 1 4 4 0 4 2 0 4 1 2 4 4 4 4 4 4 4 0 4 4 4 1 4 4 4 1 2 4 0
 4 4 4 4 1 1 2 4 4 4 4 4 4 4 4 3 4 4 4 0 4 4 2 4 4 1 4 3 4 4 4 4 4 4 4 4 4
 1 1 3 4 2 0 1 4 4 4 4 4 4 4 0 4 4 4 4 2 4 4 1 2 2 0 4 4 4 3 4 2 4 4 4 2 0
 2 2 4 4 0 2 4 4 2 4 2 0 4 4 4 4 2 4 4 0 4 4 1 4 1 4 4 2 4 2 4 4 1 0 0 4 4
 4 4 4 4 2 4 4 1 2 0 4 1 2 4 4 4 4 2 4 4 2 4 4 1 4 2 2 4 4 4 4 4 4 4 4 4 4
 4 4 4 4 1 2 4 4 4 1 4 2 4 2 4 4 4 4 2 1 2 4 4 4 4 2 4 2 4 4 4 1 4 4 1 1 0
 4 0 4 4 1 2 4 4 2 4 1 2 2 4 1 4 2 2 4 1 4 1 4 1 1 2 4 4 0 4 0 4 2 1 4 4 1
 4 4 4 4 2 1 4 4 0 4 4 4 4 1 4 4 1 4 0 0 4 4 4 4 4 4 4 4 4 4 4 1 4 4 4 4 3
 2 4 2 2 1 4 4 2 1 4 1 2 4 4 4 4 4 4 4 4 4 4 0 2 4 4 4 4 4 1 2 2 4 2 4 4 4
 2 4 4 2 1 2 4 4 2 4 4 1 4 4 4 4 0 4 4 0 4 2 4 0 2 2 4 4 2 4 1 2 4 4 4 1 4
 4 2 4 4 1 1 4 3 3 4 4 4 4 4 1 4 4 0 4 4 4 4 4 1 2 4 4 4 0 4 4 4 4 4 2 2 2
 0 2 4 2 2 1 4 4 4 4 4 4 4 4 2 2 2 0 2 1 4 1 2 4 4 4 4 4 0 1 4 4 2 4 2 4 1
 1 4 2 0 0 4 4 1 0 4 4 0 4 4 1 1 2 4 2 2 2 1 1 4 4 4 4 2 4 4 4 4 4 4 1 4 4
 4 3 4 4 2 4 2 4 2 4 4 2 1 4 4 4 4 4 1 2 2 2 4 4 4 2 1 4 4 2 2 4 4 2 2 0 2
 4 4 1 4 2 4 0 4 4 4 4 2 4 4 2 4 4 2 0 4 2 1 4 2 1 4 1 2 4 4 4 4 4 0 4 4 4
 2 4 3 4 4 4 4 4 4 2 0 4 4 3 1 4 2 4 4 4 2 3 4 2 4 4 2 4 4 4 4 4 1 4 4 4 4
 2 4 1 2 1 0 4 1 0 4 4 1 4 1 1 1 2 0 4 4 2 2 4 4 4 4 1 2 2 4 2 4 4 4 4 2 4
 4 2 4 4 4 2 4 2 4 1 4 4 2 4 4 4 4 4 2 1 4 4 4 4 3 4 1 4 4 2 4 4 4 2 4 2 1
 4 2 2 4 4 4 4 4 4 4 4 1 4 4 2 4 4 2 2 1 4 4 4 4 3 4 4 4 4 2 4 2 1 4 4 0 2
 4]

  32/1000 [..............................] - ETA: 28s
  64/1000 [>.............................] - ETA: 27s
  96/1000 [=>............................] - ETA: 26s
 128/1000 [==>...........................] - ETA: 25s
 160/1000 [===>..........................] - ETA: 24s
 192/1000 [====>.........................] - ETA: 23s
 224/1000 [=====>........................] - ETA: 22s
 256/1000 [======>.......................] - ETA: 21s
 288/1000 [=======>......................] - ETA: 21s
 320/1000 [========>.....................] - ETA: 20s
 352/1000 [=========>....................] - ETA: 19s
 384/1000 [==========>...................] - ETA: 18s
 416/1000 [===========>..................] - ETA: 17s
 448/1000 [============>.................] - ETA: 16s
 480/1000 [=============>................] - ETA: 15s
 512/1000 [==============>...............] - ETA: 14s
 544/1000 [===============>..............] - ETA: 13s
 576/1000 [================>.............] - ETA: 12s
 608/1000 [=================>............] - ETA: 11s
 640/1000 [==================>...........] - ETA: 10s
 672/1000 [===================>..........] - ETA: 9s 
 704/1000 [====================>.........] - ETA: 8s
 736/1000 [=====================>........] - ETA: 7s
 768/1000 [======================>.......] - ETA: 6s
 800/1000 [=======================>......] - ETA: 5s
 832/1000 [=======================>......] - ETA: 4s
 864/1000 [========================>.....] - ETA: 4s
 896/1000 [=========================>....] - ETA: 3s
 928/1000 [==========================>...] - ETA: 2s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 30s 30ms/step
Test loss: 1.7357682256698608
Test accuracy: 0.342
[[ 44  57  29  15  55]
 [  0   0  67   0 133]
 [ 21  68  98   1  12]
 [  0   0   0   0 200]
 [  0   0   0   0 200]]
