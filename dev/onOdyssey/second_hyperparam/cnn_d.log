Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:340: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-03 22:36:39.102331: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-03 22:36:39.106261: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-03 22:36:39.106373: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5605c882de40 executing computations on platform Host. Devices:
2019-11-03 22:36:39.106393: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
loaded
Train on 1000 samples, validate on 1000 samples
Epoch 1/35

1000/1000 [==============================] - 167s 167ms/step - loss: 1.6109 - acc: 0.1950 - val_loss: 1.5956 - val_acc: 0.2610
Epoch 2/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.5431 - acc: 0.4070 - val_loss: 1.5748 - val_acc: 0.2810
Epoch 3/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.4510 - acc: 0.4880 - val_loss: 1.5469 - val_acc: 0.4100
Epoch 4/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.3363 - acc: 0.5920 - val_loss: 1.5479 - val_acc: 0.3450
Epoch 5/35

1000/1000 [==============================] - 159s 159ms/step - loss: 1.2399 - acc: 0.4920 - val_loss: 1.6260 - val_acc: 0.2520
Epoch 6/35

1000/1000 [==============================] - 159s 159ms/step - loss: 1.2536 - acc: 0.4490 - val_loss: 1.6366 - val_acc: 0.3340
Epoch 7/35

1000/1000 [==============================] - 159s 159ms/step - loss: 1.1777 - acc: 0.4980 - val_loss: 1.6567 - val_acc: 0.3320
Epoch 8/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.1026 - acc: 0.5240 - val_loss: 1.7859 - val_acc: 0.3100
Epoch 9/35

1000/1000 [==============================] - 159s 159ms/step - loss: 1.2298 - acc: 0.5480 - val_loss: 1.6704 - val_acc: 0.2890
Epoch 10/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.0703 - acc: 0.4870 - val_loss: 2.2885 - val_acc: 0.3240
Epoch 11/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.4040 - acc: 0.4820 - val_loss: 2.1483 - val_acc: 0.2580
Epoch 12/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.2720 - acc: 0.4800 - val_loss: 2.0347 - val_acc: 0.2510
Epoch 13/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.2569 - acc: 0.4960 - val_loss: 2.0309 - val_acc: 0.2820
Epoch 14/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.2414 - acc: 0.4120 - val_loss: 2.1083 - val_acc: 0.3480
Epoch 15/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.0934 - acc: 0.5420 - val_loss: 2.1618 - val_acc: 0.4190
Epoch 16/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.0420 - acc: 0.6350 - val_loss: 2.3191 - val_acc: 0.3130
Epoch 17/35

1000/1000 [==============================] - 159s 159ms/step - loss: 1.1821 - acc: 0.5110 - val_loss: 2.0995 - val_acc: 0.3000
Epoch 18/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.0004 - acc: 0.5630 - val_loss: 1.9557 - val_acc: 0.4150
Epoch 19/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.8419 - acc: 0.6420 - val_loss: 2.2294 - val_acc: 0.3500
Epoch 20/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.0753 - acc: 0.5390 - val_loss: 2.0466 - val_acc: 0.3840
Epoch 21/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.8411 - acc: 0.6230 - val_loss: 2.0598 - val_acc: 0.4380
Epoch 22/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.8118 - acc: 0.7430 - val_loss: 2.2303 - val_acc: 0.3090
Epoch 23/35

1000/1000 [==============================] - 159s 159ms/step - loss: 0.9191 - acc: 0.6330 - val_loss: 2.1678 - val_acc: 0.4410
Epoch 24/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.8116 - acc: 0.7580 - val_loss: 2.1507 - val_acc: 0.4010
Epoch 25/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.7492 - acc: 0.6710 - val_loss: 2.1712 - val_acc: 0.3850
Epoch 26/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.7526 - acc: 0.6560 - val_loss: 2.1997 - val_acc: 0.3850
Epoch 27/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.7729 - acc: 0.6400 - val_loss: 2.1363 - val_acc: 0.4130
Epoch 28/35

1000/1000 [==============================] - 161s 161ms/step - loss: 0.6808 - acc: 0.7410 - val_loss: 2.1983 - val_acc: 0.4390
Epoch 29/35

1000/1000 [==============================] - 161s 161ms/step - loss: 0.6764 - acc: 0.7510 - val_loss: 2.2903 - val_acc: 0.4390
Epoch 30/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.6886 - acc: 0.7550 - val_loss: 2.3263 - val_acc: 0.4290
Epoch 31/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.6721 - acc: 0.7470 - val_loss: 2.2739 - val_acc: 0.4290
Epoch 32/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.6136 - acc: 0.7510 - val_loss: 2.2463 - val_acc: 0.4200
Epoch 33/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.5962 - acc: 0.7840 - val_loss: 2.2742 - val_acc: 0.4740
Epoch 34/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.6109 - acc: 0.7640 - val_loss: 2.2931 - val_acc: 0.4030
Epoch 35/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.5865 - acc: 0.7700 - val_loss: 2.3172 - val_acc: 0.4250
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[1.4966802e-01 1.5303505e-02 9.7095676e-02 2.0570901e-01 5.3222376e-01]
 [1.2540880e-01 1.9301858e-02 9.0428852e-02 2.4892884e-01 5.1593161e-01]
 [1.4691202e-01 1.6727343e-02 7.9757109e-02 2.4406040e-01 5.1254314e-01]
 ...
 [9.9996996e-01 2.4015503e-11 1.6580714e-05 7.1069703e-06 6.3275720e-06]
 [9.1053601e-03 1.2081694e-01 8.6894524e-01 7.2210969e-04 4.1029725e-04]
 [1.4160874e-01 1.5338327e-02 8.6902507e-02 2.2901790e-01 5.2713251e-01]]
[4 4 4 1 4 0 4 2 3 2 4 4 0 0 4 2 2 4 2 4 4 4 1 4 2 4 4 2 4 4 4 4 4 4 4 2 2
 4 3 2 2 0 2 4 4 4 2 2 4 2 2 1 1 2 2 4 2 4 4 4 2 0 4 2 1 4 4 4 4 1 4 1 2 4
 4 2 2 4 1 4 2 4 4 4 0 2 4 4 4 4 4 2 4 0 4 4 4 4 4 4 4 4 2 4 4 1 4 2 4 4 4
 2 4 4 4 2 2 3 4 2 0 2 4 4 1 2 4 1 1 2 0 2 4 2 2 4 4 1 4 4 4 4 2 2 1 2 0 4
 2 4 4 4 4 2 4 2 4 4 0 4 4 2 4 4 4 4 4 4 4 4 0 4 4 4 2 4 2 4 2 4 4 1 4 4 4
 2 4 2 2 2 4 2 3 4 4 4 4 2 2 4 4 4 4 4 2 4 4 4 4 0 4 0 2 4 4 4 1 4 1 2 1 4
 2 4 4 4 2 4 4 4 2 4 4 4 4 4 4 0 0 4 2 4 1 1 4 4 4 2 4 4 4 0 4 4 4 4 1 2 2
 4 2 4 4 2 4 4 4 1 4 0 4 4 1 2 4 1 4 4 0 3 4 2 1 4 4 2 4 4 4 2 4 3 4 4 2 4
 2 4 2 2 2 4 2 2 1 4 3 0 4 2 0 4 1 2 4 4 4 4 4 4 4 0 4 4 4 2 4 4 4 2 2 4 2
 4 4 4 4 2 4 2 4 4 4 4 4 4 4 4 4 4 4 4 1 4 4 2 4 4 1 4 1 4 4 4 4 4 4 4 4 4
 1 2 3 4 2 0 1 4 4 4 4 4 4 4 0 4 4 4 4 2 4 4 1 1 2 0 4 4 4 0 4 0 4 4 4 2 0
 2 2 4 4 0 2 4 4 2 4 2 0 4 4 4 4 2 4 4 2 4 4 2 4 1 4 4 2 4 2 4 4 4 1 0 4 4
 4 4 4 4 3 4 4 1 4 0 4 0 2 4 4 4 4 2 4 4 2 4 4 1 4 2 1 4 4 4 4 4 4 4 4 4 4
 4 4 2 4 1 2 4 4 4 1 4 2 4 2 4 4 4 4 2 1 2 4 4 4 4 1 4 2 4 4 4 1 4 4 2 2 0
 4 0 4 4 1 0 4 4 2 4 2 3 2 4 2 4 2 1 4 1 4 1 4 1 1 2 4 4 4 4 0 4 2 1 4 4 3
 4 4 4 4 2 1 4 4 0 4 4 4 4 2 4 4 1 4 0 0 4 4 4 4 4 4 3 4 4 4 4 2 4 4 4 4 4
 2 4 2 2 1 4 4 2 1 4 1 1 4 4 4 4 4 4 4 4 4 4 0 2 4 4 4 4 4 2 2 1 4 2 4 4 4
 1 4 4 2 1 2 4 4 2 4 4 2 4 4 4 4 4 4 4 0 4 2 4 3 2 2 4 4 2 4 2 2 4 4 4 1 4
 4 2 4 4 0 2 4 3 3 4 4 4 4 4 2 4 4 4 4 4 4 4 4 1 2 4 4 4 0 4 4 4 4 4 2 1 2
 0 2 4 2 2 2 4 4 4 4 4 4 4 4 2 2 2 0 1 1 4 1 2 4 0 4 4 4 0 2 4 4 2 4 2 4 2
 1 4 2 3 0 4 4 1 0 4 4 0 4 4 1 1 2 4 2 2 2 1 2 4 4 4 4 4 4 4 4 4 4 4 1 4 4
 4 3 4 4 3 4 2 4 2 4 4 2 1 4 4 4 4 4 1 2 2 2 4 4 4 2 1 4 4 1 2 4 4 2 2 0 2
 4 4 1 4 1 4 2 4 4 4 4 2 4 4 2 4 4 2 0 4 2 2 4 2 1 4 1 1 4 4 4 4 4 0 4 4 4
 2 4 3 4 4 4 4 4 4 2 2 4 4 3 1 4 3 4 4 4 1 0 4 2 4 4 2 4 4 4 4 4 1 4 4 4 4
 2 4 1 2 1 0 4 1 3 4 4 2 4 1 1 2 2 0 4 4 2 2 4 4 4 4 1 2 1 4 2 4 4 4 4 2 4
 4 2 0 4 4 2 4 0 4 0 4 4 2 4 4 4 4 4 2 2 4 4 4 4 4 4 4 4 4 2 4 4 4 2 4 2 2
 4 2 2 4 4 4 4 4 4 4 4 2 4 3 2 4 4 2 0 1 4 4 4 4 4 4 4 4 4 2 4 2 1 4 4 0 2
 4]

  32/1000 [..............................] - ETA: 40s
  64/1000 [>.............................] - ETA: 38s
  96/1000 [=>............................] - ETA: 37s
 128/1000 [==>...........................] - ETA: 35s
 160/1000 [===>..........................] - ETA: 34s
 192/1000 [====>.........................] - ETA: 33s
 224/1000 [=====>........................] - ETA: 31s
 256/1000 [======>.......................] - ETA: 30s
 288/1000 [=======>......................] - ETA: 29s
 320/1000 [========>.....................] - ETA: 27s
 352/1000 [=========>....................] - ETA: 26s
 384/1000 [==========>...................] - ETA: 25s
 416/1000 [===========>..................] - ETA: 23s
 448/1000 [============>.................] - ETA: 22s
 480/1000 [=============>................] - ETA: 21s
 512/1000 [==============>...............] - ETA: 20s
 544/1000 [===============>..............] - ETA: 18s
 576/1000 [================>.............] - ETA: 17s
 608/1000 [=================>............] - ETA: 16s
 640/1000 [==================>...........] - ETA: 14s
 672/1000 [===================>..........] - ETA: 13s
 704/1000 [====================>.........] - ETA: 12s
 736/1000 [=====================>........] - ETA: 10s
 768/1000 [======================>.......] - ETA: 9s 
 800/1000 [=======================>......] - ETA: 8s
 832/1000 [=======================>......] - ETA: 6s
 864/1000 [========================>.....] - ETA: 5s
 896/1000 [=========================>....] - ETA: 4s
 928/1000 [==========================>...] - ETA: 2s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 41s 41ms/step
Test loss: 2.1410522270202637
Test accuracy: 0.358
[[ 46  42  39  18  55]
 [  0   0  67   0 133]
 [ 16  51 112   5  16]
 [  0   0   0   0 200]
 [  0   0   0   0 200]]
