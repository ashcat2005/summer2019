Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:340: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-03 22:38:24.590616: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-03 22:38:24.756760: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-03 22:38:24.756989: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55c07345a000 executing computations on platform Host. Devices:
2019-11-03 22:38:24.757040: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-11-03 22:38:28.146200: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
2019-11-03 22:39:21.941147: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
2019-11-03 22:40:32.978539: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
loaded
Train on 1000 samples, validate on 1000 samples
Epoch 1/35

1000/1000 [==============================] - 165s 165ms/step - loss: 1.6066 - acc: 0.2490 - val_loss: 1.6008 - val_acc: 0.2910
2019-11-03 22:41:10.071958: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
2019-11-03 22:42:00.481731: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
Epoch 2/35

1000/1000 [==============================] - 158s 158ms/step - loss: 1.5874 - acc: 0.3470 - val_loss: 1.5916 - val_acc: 0.2990
Epoch 3/35

1000/1000 [==============================] - 156s 156ms/step - loss: 1.5637 - acc: 0.3920 - val_loss: 1.5812 - val_acc: 0.3090
Epoch 4/35

1000/1000 [==============================] - 156s 156ms/step - loss: 1.5372 - acc: 0.4250 - val_loss: 1.5700 - val_acc: 0.3130
Epoch 5/35

1000/1000 [==============================] - 156s 156ms/step - loss: 1.5083 - acc: 0.4370 - val_loss: 1.5578 - val_acc: 0.3010
Epoch 6/35

1000/1000 [==============================] - 156s 156ms/step - loss: 1.4770 - acc: 0.4490 - val_loss: 1.5450 - val_acc: 0.2980
Epoch 7/35

1000/1000 [==============================] - 155s 155ms/step - loss: 1.4438 - acc: 0.4590 - val_loss: 1.5320 - val_acc: 0.3180
Epoch 8/35

1000/1000 [==============================] - 156s 156ms/step - loss: 1.4091 - acc: 0.4730 - val_loss: 1.5192 - val_acc: 0.3550
Epoch 9/35

1000/1000 [==============================] - 156s 156ms/step - loss: 1.3734 - acc: 0.5050 - val_loss: 1.5076 - val_acc: 0.3720
Epoch 10/35

1000/1000 [==============================] - 156s 156ms/step - loss: 1.3370 - acc: 0.5360 - val_loss: 1.4979 - val_acc: 0.4060
Epoch 11/35

1000/1000 [==============================] - 156s 156ms/step - loss: 1.3007 - acc: 0.5730 - val_loss: 1.4911 - val_acc: 0.4150
Epoch 12/35

1000/1000 [==============================] - 157s 157ms/step - loss: 1.2649 - acc: 0.5780 - val_loss: 1.4881 - val_acc: 0.4160
Epoch 13/35

1000/1000 [==============================] - 157s 157ms/step - loss: 1.2300 - acc: 0.5650 - val_loss: 1.4899 - val_acc: 0.4140
Epoch 14/35

1000/1000 [==============================] - 158s 158ms/step - loss: 1.1965 - acc: 0.5680 - val_loss: 1.4968 - val_acc: 0.4120
Epoch 15/35

1000/1000 [==============================] - 158s 158ms/step - loss: 1.1650 - acc: 0.5670 - val_loss: 1.5077 - val_acc: 0.4080
Epoch 16/35

1000/1000 [==============================] - 158s 158ms/step - loss: 1.1350 - acc: 0.5690 - val_loss: 1.5210 - val_acc: 0.4110
Epoch 17/35

1000/1000 [==============================] - 158s 158ms/step - loss: 1.1055 - acc: 0.5710 - val_loss: 1.5361 - val_acc: 0.4090
Epoch 18/35

1000/1000 [==============================] - 158s 158ms/step - loss: 1.0761 - acc: 0.5800 - val_loss: 1.5535 - val_acc: 0.4080
Epoch 19/35

1000/1000 [==============================] - 158s 158ms/step - loss: 1.0470 - acc: 0.5890 - val_loss: 1.5752 - val_acc: 0.4110
Epoch 20/35

1000/1000 [==============================] - 159s 159ms/step - loss: 1.0183 - acc: 0.6070 - val_loss: 1.6018 - val_acc: 0.4160
Epoch 21/35

1000/1000 [==============================] - 158s 158ms/step - loss: 0.9894 - acc: 0.6100 - val_loss: 1.6326 - val_acc: 0.4170
Epoch 22/35

1000/1000 [==============================] - 158s 158ms/step - loss: 0.9607 - acc: 0.6170 - val_loss: 1.6681 - val_acc: 0.4210
Epoch 23/35

1000/1000 [==============================] - 158s 158ms/step - loss: 0.9330 - acc: 0.6190 - val_loss: 1.7044 - val_acc: 0.4220
Epoch 24/35

1000/1000 [==============================] - 158s 158ms/step - loss: 0.9060 - acc: 0.6270 - val_loss: 1.7422 - val_acc: 0.4260
Epoch 25/35

1000/1000 [==============================] - 158s 158ms/step - loss: 0.8797 - acc: 0.6320 - val_loss: 1.7760 - val_acc: 0.4270
Epoch 26/35

1000/1000 [==============================] - 158s 158ms/step - loss: 0.8545 - acc: 0.6360 - val_loss: 1.8095 - val_acc: 0.4270
Epoch 27/35

1000/1000 [==============================] - 158s 158ms/step - loss: 0.8301 - acc: 0.6430 - val_loss: 1.8408 - val_acc: 0.4270
Epoch 28/35

1000/1000 [==============================] - 158s 158ms/step - loss: 0.8067 - acc: 0.6470 - val_loss: 1.8795 - val_acc: 0.4230
Epoch 29/35

1000/1000 [==============================] - 159s 159ms/step - loss: 0.7853 - acc: 0.6540 - val_loss: 1.8997 - val_acc: 0.4320
Epoch 30/35

1000/1000 [==============================] - 160s 160ms/step - loss: 0.7688 - acc: 0.6760 - val_loss: 1.9372 - val_acc: 0.4220
Epoch 31/35

1000/1000 [==============================] - 158s 158ms/step - loss: 0.7461 - acc: 0.6690 - val_loss: 1.9586 - val_acc: 0.4210
Epoch 32/35

1000/1000 [==============================] - 159s 159ms/step - loss: 0.7273 - acc: 0.6860 - val_loss: 1.9690 - val_acc: 0.4280
Epoch 33/35

1000/1000 [==============================] - 158s 158ms/step - loss: 0.7116 - acc: 0.7100 - val_loss: 1.9953 - val_acc: 0.4200
Epoch 34/35

1000/1000 [==============================] - 159s 159ms/step - loss: 0.6923 - acc: 0.7110 - val_loss: 2.0301 - val_acc: 0.4190
Epoch 35/35

1000/1000 [==============================] - 159s 159ms/step - loss: 0.6791 - acc: 0.7140 - val_loss: 2.0365 - val_acc: 0.4230
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[1.4218616e-01 1.6493935e-02 8.6497083e-02 2.2231761e-01 5.3250515e-01]
 [9.8359205e-02 1.9531390e-02 7.8335509e-02 2.9827651e-01 5.0549740e-01]
 [1.3712038e-01 2.3506373e-02 7.6499850e-02 2.5837448e-01 5.0449896e-01]
 ...
 [1.0000000e+00 1.1420527e-16 3.4182111e-17 2.0094419e-11 6.4055516e-10]
 [3.0274441e-02 3.4666085e-01 6.1886770e-01 3.3073626e-03 8.8963623e-04]
 [7.6456502e-02 2.2801735e-02 1.0105824e-01 3.0393940e-01 4.9574417e-01]]
[4 4 4 1 4 0 4 2 3 2 4 4 0 0 4 2 2 4 1 4 2 4 1 4 1 4 4 2 4 4 4 4 4 4 4 2 1
 4 2 1 2 0 2 4 4 4 0 1 4 2 2 1 1 2 2 4 1 4 4 4 2 0 4 2 1 4 4 4 4 0 4 1 3 4
 4 2 1 4 2 3 2 4 4 4 0 1 4 4 4 4 4 2 4 0 4 4 4 4 4 4 4 4 2 4 4 1 4 2 4 4 4
 2 4 4 4 2 2 3 4 2 0 2 4 4 1 2 4 1 1 1 0 2 4 1 1 4 4 1 4 4 4 4 0 2 2 2 0 4
 2 4 4 4 4 2 4 2 4 4 0 4 4 2 4 4 4 4 4 4 4 4 2 4 4 4 0 4 2 4 2 4 4 1 4 4 4
 2 4 2 2 2 4 2 0 4 4 4 4 2 1 4 0 4 4 4 2 4 4 4 4 4 4 0 2 4 4 4 1 4 1 1 1 4
 2 4 4 4 1 4 4 4 2 4 4 4 4 4 4 0 1 4 2 4 1 1 4 4 4 1 4 4 4 0 0 4 4 4 1 2 1
 4 2 4 4 1 4 4 4 1 4 0 4 4 1 2 4 1 4 4 0 4 4 2 1 1 4 0 4 4 4 2 4 3 4 4 2 4
 2 4 2 2 0 4 2 2 1 4 3 0 4 2 0 4 1 2 4 4 4 4 4 4 4 0 4 4 4 2 4 4 4 2 2 4 2
 4 4 4 4 1 1 2 4 4 4 4 4 4 4 4 3 4 4 4 0 4 4 1 4 4 1 4 3 4 4 4 4 4 4 4 4 4
 1 2 3 4 2 0 1 4 4 4 4 4 4 4 0 4 4 4 4 2 4 4 1 1 1 0 3 4 4 0 4 2 4 4 4 2 0
 2 2 4 4 0 2 0 4 2 4 2 0 4 4 4 4 2 4 4 0 4 4 2 4 1 4 4 2 4 2 4 4 1 0 0 4 4
 4 4 4 4 0 4 4 1 0 0 4 1 2 4 4 4 4 2 4 4 2 4 4 1 4 2 1 4 4 4 4 4 4 4 4 4 4
 4 4 2 4 1 1 4 4 4 2 4 2 4 2 4 4 4 4 2 2 2 4 4 4 4 0 3 2 4 4 4 1 4 4 1 1 0
 4 0 4 4 1 2 4 4 2 4 1 2 2 4 1 3 2 2 4 1 4 1 4 1 1 1 4 4 0 4 0 4 2 1 4 4 1
 4 4 4 4 2 1 4 4 0 4 4 4 4 1 4 4 1 4 0 0 4 4 4 4 4 4 3 4 4 4 4 2 4 4 4 4 3
 2 4 2 2 1 4 4 2 1 4 1 2 4 4 0 4 4 4 4 4 4 4 0 2 4 4 4 4 4 2 2 1 4 2 4 4 4
 1 4 4 2 1 2 4 4 2 4 4 1 4 4 4 4 0 4 4 0 4 2 4 0 2 2 4 4 2 4 1 2 4 4 4 2 4
 4 2 4 4 1 1 4 3 3 4 4 4 4 4 1 4 4 0 4 4 0 4 4 1 2 4 4 4 0 4 4 4 4 3 2 2 1
 0 2 4 2 2 1 4 4 4 4 4 4 4 4 2 2 2 0 1 1 4 1 1 4 0 4 4 4 0 1 4 4 2 4 1 4 1
 1 4 2 0 0 4 4 1 0 4 4 0 4 4 1 1 2 4 2 2 2 2 1 4 4 4 4 2 4 4 4 4 4 4 2 4 4
 4 3 4 4 2 4 2 4 2 4 4 2 1 4 4 3 4 4 1 2 2 2 4 4 4 2 1 4 4 2 2 4 4 1 2 0 2
 4 4 1 4 2 4 0 4 4 4 4 2 4 4 1 4 4 2 0 4 2 1 4 2 1 4 2 1 4 4 4 4 4 0 4 4 4
 2 4 3 4 4 4 4 4 4 1 0 4 4 3 1 4 2 4 4 4 2 0 4 2 4 4 2 4 4 4 4 4 1 4 4 4 4
 1 4 1 2 1 0 4 2 3 4 4 1 4 1 1 1 2 0 4 4 2 2 4 4 4 4 1 2 1 4 1 4 4 2 4 1 4
 4 2 0 4 4 2 4 2 4 1 4 4 2 4 4 4 4 4 2 1 4 4 4 4 3 4 4 4 4 2 4 4 4 2 4 2 2
 4 2 1 4 4 4 4 4 4 4 4 1 4 4 2 4 4 2 2 1 4 4 4 4 4 4 4 4 4 2 4 2 1 4 3 0 2
 4]

  32/1000 [..............................] - ETA: 35s
  64/1000 [>.............................] - ETA: 34s
  96/1000 [=>............................] - ETA: 33s
 128/1000 [==>...........................] - ETA: 32s
 160/1000 [===>..........................] - ETA: 31s
 192/1000 [====>.........................] - ETA: 29s
 224/1000 [=====>........................] - ETA: 28s
 256/1000 [======>.......................] - ETA: 27s
 288/1000 [=======>......................] - ETA: 26s
 320/1000 [========>.....................] - ETA: 25s
 352/1000 [=========>....................] - ETA: 23s
 384/1000 [==========>...................] - ETA: 22s
 416/1000 [===========>..................] - ETA: 21s
 448/1000 [============>.................] - ETA: 20s
 480/1000 [=============>................] - ETA: 19s
 512/1000 [==============>...............] - ETA: 18s
 544/1000 [===============>..............] - ETA: 16s
 576/1000 [================>.............] - ETA: 15s
 608/1000 [=================>............] - ETA: 14s
 640/1000 [==================>...........] - ETA: 13s
 672/1000 [===================>..........] - ETA: 12s
 704/1000 [====================>.........] - ETA: 10s
 736/1000 [=====================>........] - ETA: 9s 
 768/1000 [======================>.......] - ETA: 8s
 800/1000 [=======================>......] - ETA: 7s
 832/1000 [=======================>......] - ETA: 6s
 864/1000 [========================>.....] - ETA: 5s
 896/1000 [=========================>....] - ETA: 3s
 928/1000 [==========================>...] - ETA: 2s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 37s 37ms/step
Test loss: 2.019154842376709
Test accuracy: 0.337
[[ 52  46  42  16  44]
 [  0   4  63   0 133]
 [ 25  81  81   8   5]
 [  0   0   0   0 200]
 [  0   0   0   0 200]]
