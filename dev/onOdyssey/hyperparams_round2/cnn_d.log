Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:326: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-01 06:41:02.532278: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-01 06:41:02.536243: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-01 06:41:02.536369: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x564a2ee03040 executing computations on platform Host. Devices:
2019-11-01 06:41:02.536388: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Train on 1000 samples, validate on 1000 samples
Epoch 1/35

1000/1000 [==============================] - 167s 167ms/step - loss: 1.6097 - acc: 0.1850 - val_loss: 1.5978 - val_acc: 0.2480
Epoch 2/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.5759 - acc: 0.3500 - val_loss: 1.5800 - val_acc: 0.2380
Epoch 3/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.5266 - acc: 0.3940 - val_loss: 1.5556 - val_acc: 0.3470
Epoch 4/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.4576 - acc: 0.5280 - val_loss: 1.5374 - val_acc: 0.2540
Epoch 5/35

1000/1000 [==============================] - 159s 159ms/step - loss: 1.3901 - acc: 0.4750 - val_loss: 1.5771 - val_acc: 0.2960
Epoch 6/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.3816 - acc: 0.4150 - val_loss: 1.6225 - val_acc: 0.2380
Epoch 7/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.3890 - acc: 0.3580 - val_loss: 1.5418 - val_acc: 0.2510
Epoch 8/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.3212 - acc: 0.3590 - val_loss: 1.7198 - val_acc: 0.3330
Epoch 9/35

1000/1000 [==============================] - 161s 161ms/step - loss: 1.4002 - acc: 0.4070 - val_loss: 1.8442 - val_acc: 0.2310
Epoch 10/35

1000/1000 [==============================] - 161s 161ms/step - loss: 1.4802 - acc: 0.3520 - val_loss: 1.5165 - val_acc: 0.2500
Epoch 11/35

1000/1000 [==============================] - 161s 161ms/step - loss: 1.2224 - acc: 0.4570 - val_loss: 1.7246 - val_acc: 0.3290
Epoch 12/35

1000/1000 [==============================] - 160s 160ms/step - loss: 1.3817 - acc: 0.4410 - val_loss: 1.5046 - val_acc: 0.3610
Epoch 13/35

1000/1000 [==============================] - 162s 162ms/step - loss: 1.1549 - acc: 0.5330 - val_loss: 1.6496 - val_acc: 0.2330
Epoch 14/35

1000/1000 [==============================] - 162s 162ms/step - loss: 1.2372 - acc: 0.4720 - val_loss: 1.6616 - val_acc: 0.2400
Epoch 15/35

1000/1000 [==============================] - 162s 162ms/step - loss: 1.2033 - acc: 0.4030 - val_loss: 1.5372 - val_acc: 0.3320
Epoch 16/35

1000/1000 [==============================] - 162s 162ms/step - loss: 1.0979 - acc: 0.5110 - val_loss: 1.6090 - val_acc: 0.3570
Epoch 17/35

1000/1000 [==============================] - 162s 162ms/step - loss: 1.1842 - acc: 0.5450 - val_loss: 1.4931 - val_acc: 0.4670
Epoch 18/35

1000/1000 [==============================] - 162s 162ms/step - loss: 1.0450 - acc: 0.6710 - val_loss: 1.5600 - val_acc: 0.3840
Epoch 19/35

1000/1000 [==============================] - 162s 162ms/step - loss: 1.0056 - acc: 0.6750 - val_loss: 1.6527 - val_acc: 0.3800
Epoch 20/35

1000/1000 [==============================] - 162s 162ms/step - loss: 1.0305 - acc: 0.6460 - val_loss: 1.5306 - val_acc: 0.4040
Epoch 21/35

1000/1000 [==============================] - 162s 162ms/step - loss: 0.9271 - acc: 0.6440 - val_loss: 1.5215 - val_acc: 0.3970
Epoch 22/35

1000/1000 [==============================] - 163s 163ms/step - loss: 0.9471 - acc: 0.6630 - val_loss: 1.5515 - val_acc: 0.4010
Epoch 23/35

1000/1000 [==============================] - 163s 163ms/step - loss: 0.9264 - acc: 0.6600 - val_loss: 1.5248 - val_acc: 0.3850
Epoch 24/35

1000/1000 [==============================] - 163s 163ms/step - loss: 0.8298 - acc: 0.6880 - val_loss: 1.6060 - val_acc: 0.4040
Epoch 25/35

1000/1000 [==============================] - 163s 163ms/step - loss: 0.8615 - acc: 0.7130 - val_loss: 1.6001 - val_acc: 0.3870
Epoch 26/35

1000/1000 [==============================] - 163s 163ms/step - loss: 0.8243 - acc: 0.7150 - val_loss: 1.5512 - val_acc: 0.3980
Epoch 27/35

1000/1000 [==============================] - 164s 164ms/step - loss: 0.7592 - acc: 0.7150 - val_loss: 1.5540 - val_acc: 0.3890
Epoch 28/35

1000/1000 [==============================] - 163s 163ms/step - loss: 0.7694 - acc: 0.7210 - val_loss: 1.5541 - val_acc: 0.4010
Epoch 29/35

1000/1000 [==============================] - 164s 164ms/step - loss: 0.7422 - acc: 0.7240 - val_loss: 1.5832 - val_acc: 0.3980
Epoch 30/35

1000/1000 [==============================] - 163s 163ms/step - loss: 0.6952 - acc: 0.7110 - val_loss: 1.5945 - val_acc: 0.4010
Epoch 31/35

1000/1000 [==============================] - 164s 164ms/step - loss: 0.6798 - acc: 0.7580 - val_loss: 1.6129 - val_acc: 0.4100
Epoch 32/35

1000/1000 [==============================] - 163s 163ms/step - loss: 0.6733 - acc: 0.7550 - val_loss: 1.6015 - val_acc: 0.4050
Epoch 33/35

1000/1000 [==============================] - 164s 164ms/step - loss: 0.6273 - acc: 0.7720 - val_loss: 1.5997 - val_acc: 0.4140
Epoch 34/35

1000/1000 [==============================] - 164s 164ms/step - loss: 0.6083 - acc: 0.7460 - val_loss: 1.6208 - val_acc: 0.4020
Epoch 35/35

1000/1000 [==============================] - 163s 163ms/step - loss: 0.6030 - acc: 0.7490 - val_loss: 1.6339 - val_acc: 0.4120
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[1.9454934e-08 1.1321376e-11 1.8548738e-08 1.0000000e+00 2.0022313e-10]
 [8.5907519e-02 3.1956915e-02 6.0592033e-02 2.0071477e-01 6.2082875e-01]
 [7.4432917e-02 3.3835717e-02 5.8803000e-02 2.2169824e-01 6.1123013e-01]
 ...
 [5.6275439e-02 2.8335523e-02 5.1882774e-02 3.1884882e-01 5.4465747e-01]
 [7.7420145e-02 3.4655817e-02 6.0511108e-02 2.3907818e-01 5.8833474e-01]
 [2.6753469e-04 4.6502977e-05 9.9952412e-01 1.6181552e-04 6.8957406e-10]]
[3 4 4 4 3 4 1 0 1 2 4 4 4 4 4 1 3 4 4 0 0 4 4 1 2 4 4 3 3 4 4 4 4 4 3 4 4
 2 0 1 4 4 4 2 0 2 4 4 4 4 0 4 4 0 4 4 4 3 1 4 4 1 1 4 4 4 2 4 4 4 0 4 4 4
 4 0 4 3 4 4 0 0 1 4 4 1 4 3 2 4 4 3 4 2 3 0 3 3 1 4 4 4 4 0 3 4 4 3 4 0 4
 4 0 2 4 4 4 4 3 4 1 2 4 0 4 1 4 1 3 2 4 3 4 0 1 2 1 0 2 4 4 4 4 4 0 4 4 2
 0 2 4 0 4 4 3 4 4 3 0 4 4 4 2 2 4 3 1 4 4 4 4 4 1 3 4 3 4 4 0 3 2 4 1 4 4
 1 4 4 1 0 2 4 0 4 4 4 4 1 0 4 0 4 0 4 4 4 4 3 0 0 4 2 4 4 4 3 4 4 3 4 3 4
 3 4 3 0 4 3 2 0 4 4 1 4 4 4 4 4 4 2 4 4 3 2 4 0 3 4 4 0 4 1 1 4 4 0 4 2 0
 3 3 4 0 1 4 4 4 4 1 4 4 2 1 4 1 2 3 4 4 1 2 2 4 2 0 4 2 4 4 0 2 4 1 3 4 3
 2 4 2 1 3 4 4 4 2 2 3 2 2 4 4 4 1 3 4 4 3 3 4 3 2 1 4 3 3 4 2 3 2 3 4 4 4
 4 4 3 2 0 3 4 4 3 2 4 2 1 1 4 0 4 4 4 4 4 0 4 4 4 4 4 4 1 4 4 3 0 2 4 2 2
 4 3 4 4 4 4 3 4 2 3 0 3 4 1 3 3 3 0 1 0 4 3 4 0 4 3 3 1 1 1 4 4 4 4 4 4 4
 2 4 4 4 1 2 4 4 3 4 0 1 2 4 4 1 4 0 4 4 3 4 4 1 0 4 4 4 4 4 1 4 4 0 0 1 4
 0 4 4 4 4 1 4 3 4 2 3 4 4 3 4 1 4 2 0 2 3 4 4 2 4 3 2 4 4 4 4 4 0 2 0 2 4
 2 0 4 4 4 4 4 4 3 2 4 1 3 2 0 4 4 4 4 0 4 4 4 4 4 0 4 4 4 2 4 0 4 1 2 4 3
 4 4 4 0 1 2 1 4 3 1 4 4 4 4 4 4 4 4 1 1 4 4 3 3 4 4 4 3 1 0 4 3 2 4 4 3 2
 1 4 3 2 2 3 4 2 2 1 3 3 4 2 4 4 4 2 4 4 1 4 0 4 2 4 3 4 4 4 4 3 4 3 4 1 4
 4 4 4 1 4 4 4 4 3 4 4 2 3 4 2 3 3 4 4 4 0 1 4 2 4 3 4 0 4 4 2 3 4 4 4 0 0
 1 2 0 4 3 4 4 1 4 2 1 4 4 4 4 2 4 2 3 2 4 2 4 4 3 2 4 4 4 4 0 4 4 2 4 1 0
 4 3 4 4 3 4 4 4 4 4 4 4 4 3 3 2 0 4 4 1 4 4 3 4 4 3 4 4 3 1 0 2 1 4 3 4 3
 4 4 3 4 4 4 4 1 3 4 4 3 3 4 4 3 4 4 0 3 0 1 3 4 4 4 3 4 4 4 1 4 1 4 4 1 4
 1 4 4 3 4 0 4 4 2 3 4 1 4 2 2 2 1 4 1 0 2 4 4 3 4 0 4 2 4 3 4 3 4 1 4 3 0
 4 1 2 4 3 4 1 4 4 2 4 1 3 1 0 2 0 3 3 2 4 4 0 3 1 3 0 3 1 4 2 4 2 4 3 3 0
 4 4 3 0 2 1 4 2 3 4 4 4 3 3 4 4 2 4 4 4 4 4 2 2 4 2 4 4 4 4 1 4 2 4 4 3 0
 2 4 4 4 4 4 0 4 3 4 4 0 0 4 2 2 4 1 4 2 3 0 4 4 2 0 4 4 1 2 4 1 3 1 3 3 4
 3 2 4 1 2 4 3 3 0 4 4 4 4 4 3 4 4 4 4 0 4 4 4 1 0 4 2 3 4 2 2 4 4 2 1 0 0
 2 1 4 2 4 0 4 3 4 4 3 1 1 2 1 4 4 3 2 4 2 4 1 4 4 4 2 0 2 4 0 4 4 4 4 4 4
 3 1 4 0 4 3 2 4 4 4 1 1 4 4 4 4 4 0 3 4 4 0 4 0 4 4 4 4 3 4 4 1 4 4 0 4 4
 2]

  32/1000 [..............................] - ETA: 39s
  64/1000 [>.............................] - ETA: 38s
  96/1000 [=>............................] - ETA: 37s
 128/1000 [==>...........................] - ETA: 35s
 160/1000 [===>..........................] - ETA: 34s
 192/1000 [====>.........................] - ETA: 33s
 224/1000 [=====>........................] - ETA: 31s
 256/1000 [======>.......................] - ETA: 30s
 288/1000 [=======>......................] - ETA: 29s
 320/1000 [========>.....................] - ETA: 27s
 352/1000 [=========>....................] - ETA: 26s
 384/1000 [==========>...................] - ETA: 25s
 416/1000 [===========>..................] - ETA: 24s
 448/1000 [============>.................] - ETA: 22s
 480/1000 [=============>................] - ETA: 21s
 512/1000 [==============>...............] - ETA: 20s
 544/1000 [===============>..............] - ETA: 18s
 576/1000 [================>.............] - ETA: 17s
 608/1000 [=================>............] - ETA: 16s
 640/1000 [==================>...........] - ETA: 14s
 672/1000 [===================>..........] - ETA: 13s
 704/1000 [====================>.........] - ETA: 12s
 736/1000 [=====================>........] - ETA: 10s
 768/1000 [======================>.......] - ETA: 9s 
 800/1000 [=======================>......] - ETA: 8s
 832/1000 [=======================>......] - ETA: 6s
 864/1000 [========================>.....] - ETA: 5s
 896/1000 [=========================>....] - ETA: 4s
 928/1000 [==========================>...] - ETA: 2s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 41s 41ms/step
Test loss: 1.9891705932617187
Test accuracy: 0.382
[[ 53  30  34  41  42]
 [ 18  22  27   0 133]
 [ 29  53  55  55   8]
 [  4   0  10  52 134]
 [  0   0   0   0 200]]
