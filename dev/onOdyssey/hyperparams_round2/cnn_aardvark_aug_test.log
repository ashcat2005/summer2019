Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:177: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("de...)`
  model = Model(input=[input1, input2], output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-18 11:15:58.726871: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-10-18 11:15:58.829503: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-10-18 11:15:58.829780: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x562bec5e2b20 executing computations on platform Host. Devices:
2019-10-18 11:15:58.829837: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Train on 1000 samples, validate on 1000 samples
Epoch 1/25

1000/1000 [==============================] - 172s 172ms/step - loss: 1.6102 - acc: 0.2120 - val_loss: 1.5661 - val_acc: 0.2580
Epoch 2/25

1000/1000 [==============================] - 154s 154ms/step - loss: 1.5180 - acc: 0.4520 - val_loss: 1.5054 - val_acc: 0.2910
Epoch 3/25

1000/1000 [==============================] - 156s 156ms/step - loss: 1.3850 - acc: 0.5040 - val_loss: 1.4605 - val_acc: 0.4150
Epoch 4/25

1000/1000 [==============================] - 157s 157ms/step - loss: 1.2643 - acc: 0.6260 - val_loss: 1.4368 - val_acc: 0.3940
Epoch 5/25

1000/1000 [==============================] - 157s 157ms/step - loss: 1.1593 - acc: 0.6550 - val_loss: 1.4201 - val_acc: 0.3880
Epoch 6/25

1000/1000 [==============================] - 158s 158ms/step - loss: 1.0734 - acc: 0.6460 - val_loss: 1.4170 - val_acc: 0.4210
Epoch 7/25

1000/1000 [==============================] - 157s 157ms/step - loss: 1.0135 - acc: 0.7450 - val_loss: 1.5603 - val_acc: 0.3240
Epoch 8/25

1000/1000 [==============================] - 157s 157ms/step - loss: 1.0307 - acc: 0.5130 - val_loss: 1.5754 - val_acc: 0.2620
Epoch 9/25

1000/1000 [==============================] - 158s 158ms/step - loss: 1.0764 - acc: 0.4980 - val_loss: 1.5310 - val_acc: 0.3850
Epoch 10/25

1000/1000 [==============================] - 157s 157ms/step - loss: 0.9848 - acc: 0.6280 - val_loss: 1.4688 - val_acc: 0.4130
Epoch 11/25

1000/1000 [==============================] - 157s 157ms/step - loss: 0.8447 - acc: 0.7150 - val_loss: 1.6082 - val_acc: 0.3630
Epoch 12/25

1000/1000 [==============================] - 158s 158ms/step - loss: 0.8794 - acc: 0.6200 - val_loss: 1.4995 - val_acc: 0.3730
Epoch 13/25

1000/1000 [==============================] - 156s 156ms/step - loss: 0.7790 - acc: 0.6910 - val_loss: 1.4316 - val_acc: 0.4590
Epoch 14/25

1000/1000 [==============================] - 157s 157ms/step - loss: 0.7416 - acc: 0.7580 - val_loss: 1.4496 - val_acc: 0.3100
Epoch 15/25

1000/1000 [==============================] - 157s 157ms/step - loss: 0.7483 - acc: 0.7450 - val_loss: 1.4315 - val_acc: 0.5050
Epoch 16/25

1000/1000 [==============================] - 156s 156ms/step - loss: 0.6934 - acc: 0.8940 - val_loss: 1.4441 - val_acc: 0.4410
Epoch 17/25

1000/1000 [==============================] - 156s 156ms/step - loss: 0.6466 - acc: 0.8160 - val_loss: 1.4992 - val_acc: 0.4160
Epoch 18/25

1000/1000 [==============================] - 161s 161ms/step - loss: 0.6399 - acc: 0.7420 - val_loss: 1.5306 - val_acc: 0.4140
Epoch 19/25

1000/1000 [==============================] - 159s 159ms/step - loss: 0.6295 - acc: 0.7460 - val_loss: 1.5064 - val_acc: 0.4380
Epoch 20/25

1000/1000 [==============================] - 157s 157ms/step - loss: 0.5930 - acc: 0.7680 - val_loss: 1.4731 - val_acc: 0.4790
Epoch 21/25

1000/1000 [==============================] - 156s 156ms/step - loss: 0.5590 - acc: 0.8180 - val_loss: 1.4701 - val_acc: 0.5040
Epoch 22/25

1000/1000 [==============================] - 160s 160ms/step - loss: 0.5454 - acc: 0.8460 - val_loss: 1.4822 - val_acc: 0.5190
Epoch 23/25

1000/1000 [==============================] - 161s 161ms/step - loss: 0.5300 - acc: 0.8630 - val_loss: 1.4976 - val_acc: 0.5170
Epoch 24/25

1000/1000 [==============================] - 161s 161ms/step - loss: 0.5050 - acc: 0.8760 - val_loss: 1.5219 - val_acc: 0.5030
Epoch 25/25

1000/1000 [==============================] - 164s 164ms/step - loss: 0.4809 - acc: 0.8570 - val_loss: 1.5503 - val_acc: 0.4910
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug10.h5 
[[3.1041294e-01 2.4452771e-01 2.2647505e-01 1.8535471e-01 3.3229504e-02]
 [1.9481882e-02 6.9230855e-01 2.8820932e-01 6.5213271e-08 1.8727148e-07]
 [7.0739776e-02 8.2401216e-02 9.8410070e-02 2.3948400e-01 5.0896490e-01]
 ...
 [3.7780741e-01 2.8807956e-01 3.1271094e-01 4.0327655e-03 1.7369296e-02]
 [1.1570517e-01 6.9055758e-02 1.0894671e-01 2.3428488e-01 4.7200751e-01]
 [6.5829852e-05 1.1690880e-08 1.2685934e-03 9.9866474e-01 8.4305327e-07]]
[0 1 4 4 4 4 2 4 4 2 3 4 4 2 0 1 4 4 1 4 4 4 0 4 0 4 4 4 4 4 4 2 2 4 2 4 4
 1 1 4 1 3 1 4 4 1 0 4 4 2 4 0 4 4 3 4 4 0 4 0 4 3 3 4 4 1 4 4 4 2 4 3 4 4
 0 4 4 3 3 3 4 4 4 4 4 0 2 0 4 4 4 2 2 1 0 4 3 4 1 1 0 4 0 4 2 3 4 4 1 1 3
 4 4 3 3 4 4 4 4 4 4 4 0 4 2 4 1 1 4 4 3 4 0 0 1 0 4 3 4 1 2 2 1 4 2 4 4 4
 2 2 2 3 4 4 4 4 4 4 4 3 4 3 4 4 2 0 4 2 4 2 4 2 4 4 0 3 2 3 4 2 3 4 4 4 1
 3 4 4 4 4 4 0 0 1 2 4 4 4 4 0 4 0 2 2 4 4 4 4 3 0 4 2 4 4 4 4 4 1 4 2 4 0
 4 4 4 4 4 1 4 4 0 4 2 4 1 2 4 1 4 2 2 4 1 4 3 4 1 1 2 4 2 0 4 2 3 4 2 4 2
 4 4 4 1 4 2 4 0 4 2 4 0 4 4 4 4 4 4 3 4 0 4 4 4 3 2 4 4 4 4 0 1 3 2 2 2 4
 3 3 0 2 1 2 4 4 1 3 4 1 4 4 4 4 4 1 4 4 2 4 4 3 4 2 3 4 1 0 2 2 4 3 2 4 4
 0 4 4 2 4 1 4 4 3 0 1 4 4 4 4 4 4 2 2 4 4 4 1 4 4 1 4 0 1 4 4 4 2 4 4 3 2
 2 3 3 1 1 4 4 3 1 4 4 1 2 1 4 4 4 1 2 3 1 4 3 3 4 1 1 4 4 2 2 1 1 3 1 2 4
 4 0 0 2 0 4 4 3 0 3 4 1 1 4 4 4 4 4 1 3 2 0 4 1 3 4 4 4 4 3 4 1 4 4 4 4 4
 4 1 4 3 4 4 4 4 4 4 4 0 4 4 1 2 4 4 4 4 3 4 4 4 3 4 0 3 4 1 4 4 4 4 4 4 4
 4 4 0 4 2 4 0 2 4 4 4 0 4 4 4 4 4 0 1 4 4 3 3 3 0 4 1 2 4 2 3 4 4 4 4 4 4
 4 4 2 4 2 4 4 4 1 2 4 1 2 2 4 1 3 4 2 1 4 4 4 4 2 4 4 4 4 3 4 4 1 4 1 1 4
 3 4 1 4 4 2 3 4 4 4 3 3 4 3 3 3 0 3 4 4 4 3 4 4 3 4 4 3 1 2 0 2 4 2 4 4 4
 4 4 4 4 2 4 2 4 4 0 2 4 4 1 2 4 3 0 4 1 4 4 2 4 4 0 1 4 4 4 0 4 4 3 4 4 0
 0 1 4 3 4 4 4 4 4 4 4 4 4 4 2 4 2 4 4 4 1 4 1 0 0 4 0 4 1 0 0 3 4 4 1 4 1
 1 1 2 4 1 0 1 4 4 1 4 0 4 3 1 4 4 4 0 4 1 4 4 2 4 4 1 4 3 4 1 4 0 0 2 2 0
 4 2 4 4 1 4 1 4 2 4 4 1 4 4 1 4 4 1 4 4 1 3 2 4 4 2 4 4 4 4 0 4 1 4 3 2 0
 3 3 4 4 0 1 4 4 4 2 4 4 0 4 3 4 4 4 4 2 4 4 2 1 4 1 3 4 4 4 4 2 1 4 2 0 2
 3 1 0 1 4 2 4 4 0 4 4 4 4 2 0 4 4 1 3 2 1 1 3 0 1 4 4 4 3 1 4 1 2 4 4 4 2
 3 4 3 4 3 1 1 2 2 0 4 1 4 1 3 2 1 4 1 1 4 4 4 0 4 4 1 3 2 3 1 4 4 4 4 1 4
 4 4 3 4 4 4 4 4 4 2 3 3 4 3 1 4 4 3 1 2 2 4 3 2 4 4 2 4 4 3 4 4 1 0 2 2 1
 4 2 4 0 1 4 4 4 4 1 1 2 4 0 4 4 4 0 4 1 4 4 4 4 4 4 3 1 4 4 4 4 4 4 1 4 4
 0 4 3 4 4 1 2 4 0 4 2 4 2 1 4 0 4 4 4 4 4 0 4 0 2 4 4 0 4 4 4 4 3 1 3 1 1
 4 1 3 0 4 4 4 4 4 4 4 4 2 4 4 4 4 3 1 3 4 4 2 0 2 0 4 1 4 4 4 3 4 4 4 0 4
 3]

  32/1000 [..............................] - ETA: 44s
  64/1000 [>.............................] - ETA: 43s
  96/1000 [=>............................] - ETA: 41s
 128/1000 [==>...........................] - ETA: 40s
 160/1000 [===>..........................] - ETA: 38s
 192/1000 [====>.........................] - ETA: 37s
 224/1000 [=====>........................] - ETA: 35s
 256/1000 [======>.......................] - ETA: 34s
 288/1000 [=======>......................] - ETA: 33s
 320/1000 [========>.....................] - ETA: 31s
 352/1000 [=========>....................] - ETA: 30s
 384/1000 [==========>...................] - ETA: 28s
 416/1000 [===========>..................] - ETA: 27s
 448/1000 [============>.................] - ETA: 25s
 480/1000 [=============>................] - ETA: 24s
 512/1000 [==============>...............] - ETA: 22s
 544/1000 [===============>..............] - ETA: 21s
 576/1000 [================>.............] - ETA: 19s
 608/1000 [=================>............] - ETA: 18s
 640/1000 [==================>...........] - ETA: 16s
 672/1000 [===================>..........] - ETA: 15s
 704/1000 [====================>.........] - ETA: 13s
 736/1000 [=====================>........] - ETA: 12s
 768/1000 [======================>.......] - ETA: 10s
 800/1000 [=======================>......] - ETA: 9s 
 832/1000 [=======================>......] - ETA: 7s
 864/1000 [========================>.....] - ETA: 6s
 896/1000 [=========================>....] - ETA: 4s
 928/1000 [==========================>...] - ETA: 3s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 47s 47ms/step
Test loss: 1.7768893623352051
Test accuracy: 0.435
[[ 55  35  37  24  49]
 [  1  60   6   0 133]
 [ 28  41  74  38  19]
 [  9   0  11  46 134]
 [  0   0   0   0 200]]
