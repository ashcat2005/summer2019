Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:326: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-01 06:37:11.980321: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-01 06:37:11.995936: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-01 06:37:11.996109: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x560006671350 executing computations on platform Host. Devices:
2019-11-01 06:37:11.996135: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2019-11-01 06:37:25.179340: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
2019-11-01 06:38:23.005067: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
2019-11-01 06:39:54.361751: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
Train on 1000 samples, validate on 1000 samples
Epoch 1/35

1000/1000 [==============================] - 209s 209ms/step - loss: 1.6104 - acc: 0.1840 - val_loss: 1.5612 - val_acc: 0.2740
2019-11-01 06:40:43.683145: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
2019-11-01 06:41:42.238837: W tensorflow/core/framework/allocator.cc:124] Allocation of 7372800000 exceeds 10% of system memory.
Epoch 2/35

1000/1000 [==============================] - 197s 197ms/step - loss: 1.5139 - acc: 0.4320 - val_loss: 1.5031 - val_acc: 0.2850
Epoch 3/35

1000/1000 [==============================] - 198s 198ms/step - loss: 1.3820 - acc: 0.5340 - val_loss: 1.4685 - val_acc: 0.2920
Epoch 4/35

1000/1000 [==============================] - 199s 199ms/step - loss: 1.2718 - acc: 0.4950 - val_loss: 1.4363 - val_acc: 0.4000
Epoch 5/35

1000/1000 [==============================] - 198s 198ms/step - loss: 1.1732 - acc: 0.6450 - val_loss: 1.4245 - val_acc: 0.4050
Epoch 6/35

1000/1000 [==============================] - 199s 199ms/step - loss: 1.0769 - acc: 0.6630 - val_loss: 1.4085 - val_acc: 0.4330
Epoch 7/35

1000/1000 [==============================] - 197s 197ms/step - loss: 0.9962 - acc: 0.7390 - val_loss: 1.4257 - val_acc: 0.3820
Epoch 8/35

1000/1000 [==============================] - 199s 199ms/step - loss: 0.9317 - acc: 0.6730 - val_loss: 1.4620 - val_acc: 0.2760
Epoch 9/35

1000/1000 [==============================] - 200s 200ms/step - loss: 0.9098 - acc: 0.6550 - val_loss: 1.4949 - val_acc: 0.3790
Epoch 10/35

1000/1000 [==============================] - 198s 198ms/step - loss: 0.8325 - acc: 0.6660 - val_loss: 1.4289 - val_acc: 0.4400
Epoch 11/35

1000/1000 [==============================] - 199s 199ms/step - loss: 0.7636 - acc: 0.7750 - val_loss: 1.4357 - val_acc: 0.4440
Epoch 12/35

1000/1000 [==============================] - 198s 198ms/step - loss: 0.7212 - acc: 0.8070 - val_loss: 1.5087 - val_acc: 0.4280
Epoch 13/35

1000/1000 [==============================] - 199s 199ms/step - loss: 0.6803 - acc: 0.7450 - val_loss: 1.5016 - val_acc: 0.4300
Epoch 14/35

1000/1000 [==============================] - 199s 199ms/step - loss: 0.6333 - acc: 0.7670 - val_loss: 1.4741 - val_acc: 0.4510
Epoch 15/35

1000/1000 [==============================] - 199s 199ms/step - loss: 0.6052 - acc: 0.8420 - val_loss: 1.5023 - val_acc: 0.4580
Epoch 16/35

1000/1000 [==============================] - 199s 199ms/step - loss: 0.5631 - acc: 0.8070 - val_loss: 1.5473 - val_acc: 0.4530
Epoch 17/35

1000/1000 [==============================] - 197s 197ms/step - loss: 0.5377 - acc: 0.7970 - val_loss: 1.5222 - val_acc: 0.4820
Epoch 18/35

1000/1000 [==============================] - 198s 198ms/step - loss: 0.5058 - acc: 0.8590 - val_loss: 1.5430 - val_acc: 0.4850
Epoch 19/35

1000/1000 [==============================] - 197s 197ms/step - loss: 0.4777 - acc: 0.8630 - val_loss: 1.5998 - val_acc: 0.4840
Epoch 20/35

1000/1000 [==============================] - 199s 199ms/step - loss: 0.4582 - acc: 0.8420 - val_loss: 1.5623 - val_acc: 0.5020
Epoch 21/35

1000/1000 [==============================] - 187s 187ms/step - loss: 0.4283 - acc: 0.8640 - val_loss: 1.5658 - val_acc: 0.5080
Epoch 22/35

1000/1000 [==============================] - 183s 183ms/step - loss: 0.4114 - acc: 0.8830 - val_loss: 1.6388 - val_acc: 0.4930
Epoch 23/35

1000/1000 [==============================] - 173s 173ms/step - loss: 0.3916 - acc: 0.8690 - val_loss: 1.6152 - val_acc: 0.5010
Epoch 24/35

1000/1000 [==============================] - 169s 169ms/step - loss: 0.3662 - acc: 0.8860 - val_loss: 1.6033 - val_acc: 0.5150
Epoch 25/35

1000/1000 [==============================] - 169s 169ms/step - loss: 0.3551 - acc: 0.9040 - val_loss: 1.6789 - val_acc: 0.5040
Epoch 26/35

1000/1000 [==============================] - 169s 169ms/step - loss: 0.3371 - acc: 0.8900 - val_loss: 1.6471 - val_acc: 0.5210
Epoch 27/35

1000/1000 [==============================] - 169s 169ms/step - loss: 0.3148 - acc: 0.9020 - val_loss: 1.6269 - val_acc: 0.5320
Epoch 28/35

1000/1000 [==============================] - 170s 170ms/step - loss: 0.3067 - acc: 0.9350 - val_loss: 1.7209 - val_acc: 0.5070
Epoch 29/35

1000/1000 [==============================] - 170s 170ms/step - loss: 0.2922 - acc: 0.8940 - val_loss: 1.6743 - val_acc: 0.5250
Epoch 30/35

1000/1000 [==============================] - 171s 171ms/step - loss: 0.2709 - acc: 0.9160 - val_loss: 1.6553 - val_acc: 0.5680
Epoch 31/35

1000/1000 [==============================] - 171s 171ms/step - loss: 0.2654 - acc: 0.9610 - val_loss: 1.7494 - val_acc: 0.5160
Epoch 32/35

1000/1000 [==============================] - 171s 171ms/step - loss: 0.2519 - acc: 0.9110 - val_loss: 1.7122 - val_acc: 0.5290
Epoch 33/35

1000/1000 [==============================] - 171s 171ms/step - loss: 0.2336 - acc: 0.9420 - val_loss: 1.6858 - val_acc: 0.6230
Epoch 34/35

1000/1000 [==============================] - 174s 174ms/step - loss: 0.2304 - acc: 0.9730 - val_loss: 1.7754 - val_acc: 0.5220
Epoch 35/35

1000/1000 [==============================] - 170s 170ms/step - loss: 0.2173 - acc: 0.9240 - val_loss: 1.7467 - val_acc: 0.5260
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[1.37255997e-14 5.73235001e-20 1.55876876e-17 1.00000000e+00
  1.42574517e-22]
 [2.86996886e-02 2.18290593e-02 4.94680256e-02 9.63199288e-02
  8.03683281e-01]
 [2.03701966e-02 3.53916399e-02 4.83909361e-02 1.64201468e-01
  7.31645703e-01]
 ...
 [1.32853165e-02 2.78980341e-02 3.22825573e-02 2.85096496e-01
  6.41437590e-01]
 [2.52058115e-02 2.97562648e-02 5.30600771e-02 1.79517239e-01
  7.12460577e-01]
 [1.52315006e-01 1.30320152e-13 7.80611396e-01 6.70735613e-02
  1.95092712e-20]]
[3 4 4 0 3 4 1 3 2 3 4 4 3 4 4 1 2 4 4 0 0 4 4 2 2 4 3 0 3 0 4 3 4 4 3 4 4
 0 2 1 4 4 4 0 0 0 4 4 4 4 0 3 4 1 4 4 4 3 3 4 3 1 2 4 4 4 1 4 4 4 0 4 3 4
 4 2 4 2 4 4 1 2 1 4 4 1 2 3 2 4 4 0 4 0 3 0 3 1 2 4 4 4 4 0 3 4 4 2 4 0 4
 4 0 2 3 4 4 4 3 4 2 2 4 0 4 1 4 2 3 1 4 3 4 1 2 2 1 3 1 4 4 4 0 4 0 4 4 2
 2 2 4 0 0 0 3 4 4 3 0 4 4 4 2 1 4 1 0 3 4 4 4 3 2 3 3 3 4 4 0 3 2 4 2 4 0
 1 4 4 2 1 2 4 0 4 4 3 4 2 0 4 0 4 1 4 0 4 4 3 3 2 4 1 4 4 3 3 4 4 2 4 3 4
 3 4 3 0 4 0 2 0 4 4 1 4 4 4 4 4 4 2 3 4 3 2 4 0 3 4 4 1 0 3 1 4 4 0 4 2 0
 3 0 4 2 2 4 4 4 4 2 4 4 2 2 4 1 2 0 4 4 1 0 0 4 2 0 4 1 4 4 0 1 4 1 3 4 3
 2 3 2 2 3 4 4 4 2 2 3 0 1 4 4 4 1 3 4 4 3 3 4 3 2 2 4 3 3 4 2 3 1 2 4 4 4
 4 4 2 1 2 3 4 0 3 1 4 2 1 3 4 0 4 4 4 4 4 0 4 4 4 4 4 0 1 3 4 3 3 2 4 2 1
 4 3 4 4 4 4 1 4 2 0 1 3 4 1 3 3 2 2 1 0 4 0 4 2 4 3 2 1 1 2 4 4 4 4 3 3 4
 1 1 4 4 0 0 2 4 3 3 0 1 0 4 4 1 4 0 3 4 3 4 4 1 0 4 0 3 4 4 2 4 3 0 0 1 4
 0 4 4 4 4 1 4 3 4 0 3 4 4 3 4 2 4 0 0 1 3 4 4 0 3 3 2 4 4 4 4 4 0 0 3 1 4
 1 0 4 0 4 4 4 4 2 1 4 1 0 1 0 4 3 4 4 0 3 2 3 4 4 1 4 3 4 1 4 0 4 1 2 4 3
 4 4 4 0 2 1 1 4 3 1 4 0 4 4 4 4 4 4 2 2 4 4 3 3 4 4 4 2 1 2 4 3 2 4 4 2 2
 1 4 3 2 2 3 4 2 1 1 0 3 4 0 4 4 4 2 4 4 1 4 1 3 0 4 3 4 4 4 4 3 4 3 4 1 4
 4 4 4 1 4 4 4 3 3 4 4 1 0 4 2 3 3 3 4 4 0 2 4 2 4 2 4 0 4 4 1 3 4 4 4 1 2
 2 0 0 4 3 3 4 0 4 2 1 4 4 4 3 2 4 2 3 2 4 0 4 4 3 2 4 4 4 4 1 4 4 2 4 2 1
 3 3 4 2 3 3 4 4 4 1 4 4 3 3 3 2 0 4 3 1 4 4 3 4 4 3 4 4 3 1 2 0 1 4 0 4 3
 4 4 0 4 4 4 4 2 4 4 1 3 3 4 4 3 4 4 0 3 0 1 3 4 4 4 3 4 4 4 2 3 1 4 4 1 4
 1 0 4 0 4 0 4 4 1 3 4 1 4 1 2 1 2 4 1 0 1 4 4 3 4 1 4 2 4 3 4 3 4 1 4 3 0
 0 1 2 0 3 2 2 4 4 2 4 1 2 2 0 2 0 3 3 2 0 4 0 3 3 3 0 3 1 4 2 4 0 4 3 0 0
 3 4 3 0 3 1 4 2 3 4 3 4 3 3 4 4 2 3 4 4 4 4 1 0 4 2 4 4 4 4 1 4 2 4 4 3 2
 2 3 4 3 4 3 3 4 2 4 4 0 1 4 1 2 0 1 4 0 3 0 4 4 2 0 4 4 1 2 4 1 3 2 3 3 1
 3 1 4 2 0 4 3 3 0 4 2 4 4 4 3 4 4 4 4 1 4 4 2 1 0 4 2 3 1 2 2 4 4 2 2 1 0
 2 1 3 2 4 2 4 3 4 4 3 1 1 3 2 4 4 3 1 4 1 4 2 4 4 4 0 0 0 4 0 4 4 4 4 4 4
 2 2 4 1 4 3 1 4 4 4 1 1 4 4 4 4 4 0 3 4 4 0 4 0 4 4 4 3 3 4 4 1 4 3 1 4 4
 2]

  32/1000 [..............................] - ETA: 44s
  64/1000 [>.............................] - ETA: 43s
  96/1000 [=>............................] - ETA: 42s
 128/1000 [==>...........................] - ETA: 41s
 160/1000 [===>..........................] - ETA: 39s
 192/1000 [====>.........................] - ETA: 38s
 224/1000 [=====>........................] - ETA: 36s
 256/1000 [======>.......................] - ETA: 35s
 288/1000 [=======>......................] - ETA: 33s
 320/1000 [========>.....................] - ETA: 31s
 352/1000 [=========>....................] - ETA: 30s
 384/1000 [==========>...................] - ETA: 28s
 416/1000 [===========>..................] - ETA: 27s
 448/1000 [============>.................] - ETA: 25s
 480/1000 [=============>................] - ETA: 24s
 512/1000 [==============>...............] - ETA: 22s
 544/1000 [===============>..............] - ETA: 21s
 576/1000 [================>.............] - ETA: 19s
 608/1000 [=================>............] - ETA: 18s
 640/1000 [==================>...........] - ETA: 16s
 672/1000 [===================>..........] - ETA: 15s
 704/1000 [====================>.........] - ETA: 13s
 736/1000 [=====================>........] - ETA: 12s
 768/1000 [======================>.......] - ETA: 10s
 800/1000 [=======================>......] - ETA: 9s 
 832/1000 [=======================>......] - ETA: 7s
 864/1000 [========================>.....] - ETA: 6s
 896/1000 [=========================>....] - ETA: 4s
 928/1000 [==========================>...] - ETA: 3s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 47s 47ms/step
Test loss: 2.014688020706177
Test accuracy: 0.496
[[ 73  35  36  35  21]
 [  7  63   2  18 110]
 [ 34  23  91  51   1]
 [ 11   0   9  69 111]
 [  0   0   0   0 200]]
