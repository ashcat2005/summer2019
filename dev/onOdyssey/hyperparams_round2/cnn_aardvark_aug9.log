Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat2.py:177: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=[<tf.Tenso..., outputs=Tensor("de...)`
  model = Model(input=[input1, input2], output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-10-07 15:26:49.945137: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-10-07 15:26:49.949181: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-10-07 15:26:49.949315: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x5619687c0ce0 executing computations on platform Host. Devices:
2019-10-07 15:26:49.949334: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Train on 1000 samples, validate on 1000 samples
Epoch 1/25

1000/1000 [==============================] - 146s 146ms/step - loss: 1.6103 - acc: 0.1910 - val_loss: 1.5755 - val_acc: 0.2470
Epoch 2/25

1000/1000 [==============================] - 139s 139ms/step - loss: 1.5270 - acc: 0.3550 - val_loss: 1.5274 - val_acc: 0.2900
Epoch 3/25

1000/1000 [==============================] - 139s 139ms/step - loss: 1.4085 - acc: 0.5000 - val_loss: 1.4869 - val_acc: 0.2760
Epoch 4/25

1000/1000 [==============================] - 138s 138ms/step - loss: 1.2998 - acc: 0.4590 - val_loss: 1.4731 - val_acc: 0.3410
Epoch 5/25

1000/1000 [==============================] - 138s 138ms/step - loss: 1.2149 - acc: 0.5280 - val_loss: 1.4491 - val_acc: 0.4010
Epoch 6/25

1000/1000 [==============================] - 138s 138ms/step - loss: 1.1312 - acc: 0.6620 - val_loss: 1.4284 - val_acc: 0.4070
Epoch 7/25

1000/1000 [==============================] - 138s 138ms/step - loss: 1.0688 - acc: 0.7300 - val_loss: 1.4300 - val_acc: 0.3820
Epoch 8/25

1000/1000 [==============================] - 138s 138ms/step - loss: 1.0009 - acc: 0.6630 - val_loss: 1.4369 - val_acc: 0.4280
Epoch 9/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.9442 - acc: 0.7130 - val_loss: 1.4362 - val_acc: 0.3910
Epoch 10/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.8857 - acc: 0.7010 - val_loss: 1.4190 - val_acc: 0.4320
Epoch 11/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.8338 - acc: 0.7650 - val_loss: 1.4440 - val_acc: 0.4050
Epoch 12/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.7897 - acc: 0.7280 - val_loss: 1.4319 - val_acc: 0.4380
Epoch 13/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.7451 - acc: 0.7830 - val_loss: 1.4679 - val_acc: 0.4130
Epoch 14/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.7028 - acc: 0.7430 - val_loss: 1.4440 - val_acc: 0.4420
Epoch 15/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.6598 - acc: 0.8110 - val_loss: 1.4641 - val_acc: 0.4430
Epoch 16/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.6231 - acc: 0.7910 - val_loss: 1.4688 - val_acc: 0.4310
Epoch 17/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.5868 - acc: 0.7910 - val_loss: 1.4706 - val_acc: 0.4560
Epoch 18/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.5575 - acc: 0.8280 - val_loss: 1.5464 - val_acc: 0.4370
Epoch 19/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.5370 - acc: 0.7890 - val_loss: 1.4905 - val_acc: 0.5090
Epoch 20/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.5213 - acc: 0.9090 - val_loss: 1.5496 - val_acc: 0.4770
Epoch 21/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.4810 - acc: 0.8250 - val_loss: 1.5498 - val_acc: 0.4840
Epoch 22/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.4540 - acc: 0.8350 - val_loss: 1.5197 - val_acc: 0.4890
Epoch 23/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.4523 - acc: 0.8810 - val_loss: 1.6205 - val_acc: 0.4830
Epoch 24/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.4238 - acc: 0.8560 - val_loss: 1.6078 - val_acc: 0.5020
Epoch 25/25

1000/1000 [==============================] - 138s 138ms/step - loss: 0.3979 - acc: 0.8780 - val_loss: 1.5535 - val_acc: 0.5140
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug9.h5 
[[1.00000000e+00 8.09777094e-19 3.69301156e-15 4.13009162e-17
  7.45114618e-18]
 [8.17361549e-02 9.86143500e-02 1.59467831e-01 3.24776351e-01
  3.35405320e-01]
 [9.70568359e-02 6.93769082e-02 1.22920781e-01 2.37321675e-01
  4.73323762e-01]
 ...
 [1.04405135e-01 3.84923629e-02 2.92298466e-01 5.06812513e-01
  5.79915084e-02]
 [1.51001588e-01 9.52027813e-02 1.55062154e-01 2.71321595e-01
  3.27411890e-01]
 [1.30604550e-01 6.61501437e-02 1.84220955e-01 2.51764268e-01
  3.67260039e-01]]
[0 4 4 3 4 3 2 2 3 4 3 4 4 2 4 2 2 3 4 2 2 4 4 3 4 4 4 3 2 4 0 0 3 4 2 0 3
 1 4 1 2 3 4 4 4 2 4 4 4 4 0 0 3 4 1 4 4 2 0 0 1 2 4 4 2 4 1 3 4 0 4 3 3 2
 1 3 3 4 2 2 1 3 2 3 4 1 4 0 0 2 3 3 4 1 3 3 2 2 2 2 4 4 0 0 1 0 2 4 0 4 3
 4 1 0 2 3 4 3 3 1 2 2 2 0 1 0 0 2 0 4 3 4 4 3 3 2 4 3 4 3 2 0 3 3 4 0 4 1
 4 4 3 2 2 4 1 2 2 3 2 2 4 4 4 4 0 4 4 2 2 3 1 0 0 2 3 3 4 3 0 4 2 4 4 0 4
 3 4 1 3 2 1 0 0 4 4 4 3 4 4 3 3 2 4 2 0 4 3 3 4 2 4 0 4 4 0 0 0 2 2 4 4 4
 0 2 4 0 2 3 0 3 2 1 4 0 2 4 2 0 2 4 3 0 2 2 4 2 3 0 0 0 2 3 1 0 3 4 4 4 1
 0 2 2 3 2 2 3 1 4 3 3 4 2 4 2 3 4 3 2 0 3 4 4 2 4 0 2 1 4 4 4 3 3 1 3 4 4
 3 4 4 2 4 3 4 4 0 4 0 1 4 0 3 0 0 4 2 4 3 0 0 2 4 4 3 3 4 3 4 0 2 4 0 4 3
 3 2 4 0 1 2 4 4 0 4 4 4 3 3 0 4 1 0 1 2 3 2 0 3 0 3 3 2 2 3 4 4 4 2 0 0 0
 0 3 4 4 0 2 4 3 3 0 1 4 3 4 3 3 0 4 0 3 2 1 4 4 0 4 2 2 2 0 4 2 4 2 3 3 2
 1 4 3 3 2 1 0 4 4 1 4 2 3 2 3 0 0 1 0 0 2 0 2 4 2 1 1 4 3 3 1 4 1 4 4 3 2
 4 4 1 4 2 4 4 0 3 0 0 2 0 4 0 4 2 4 3 4 4 3 2 0 0 0 1 0 3 4 0 3 4 2 4 4 3
 1 2 3 4 2 4 0 2 2 4 0 2 0 2 0 4 1 0 4 3 3 4 3 4 3 2 0 4 4 1 3 3 4 0 2 4 4
 4 4 0 4 3 4 4 2 3 2 4 4 4 3 3 3 1 1 4 2 2 0 2 3 3 2 3 2 3 4 2 4 2 3 0 4 2
 1 1 1 4 4 4 4 3 0 0 4 1 4 4 4 3 3 1 2 4 0 4 4 3 2 4 0 4 4 2 4 4 3 2 2 0 4
 2 2 3 4 4 4 4 3 0 2 4 4 4 3 3 3 3 1 4 3 0 2 1 4 4 4 1 2 4 4 4 4 2 4 3 3 2
 0 2 3 4 3 0 0 3 2 3 3 4 0 4 4 3 0 4 4 3 0 4 3 4 4 4 3 2 3 3 0 0 1 1 2 3 3
 3 3 0 3 0 3 4 3 0 0 2 0 4 1 3 4 3 2 4 4 2 2 1 0 0 3 3 4 3 4 2 4 2 3 4 3 3
 2 1 3 3 4 3 4 0 1 2 4 4 4 4 1 4 3 2 4 0 4 3 3 3 4 2 2 3 0 0 2 2 4 0 0 4 0
 3 2 4 2 3 4 4 0 4 0 4 4 2 2 4 0 3 4 3 4 4 4 3 3 4 0 0 2 2 4 4 3 4 4 3 4 2
 3 2 1 2 2 1 4 4 3 3 4 4 4 0 4 4 1 3 4 1 0 4 3 0 2 0 3 4 0 1 0 0 2 4 4 0 4
 4 4 3 4 4 4 4 2 4 4 3 2 2 4 1 4 3 4 4 4 4 4 2 3 3 4 3 1 4 3 0 2 3 0 2 0 1
 1 2 3 3 3 4 4 0 3 4 2 2 4 3 2 2 1 4 0 4 4 2 0 1 4 3 3 2 4 3 2 4 4 3 2 2 4
 3 2 3 0 4 3 2 0 2 3 4 4 4 3 0 4 1 2 4 2 0 4 1 3 4 4 4 2 2 2 3 4 1 2 0 0 1
 4 4 0 1 2 4 2 3 2 4 0 2 0 1 4 2 4 4 2 4 0 4 2 0 2 1 0 4 2 4 2 4 1 4 2 4 0
 2 1 2 4 4 0 4 4 4 2 0 4 4 4 2 4 2 2 4 4 4 2 0 4 2 4 4 4 0 4 2 3 2 0 4 3 4
 4]

  32/1000 [..............................] - ETA: 39s
  64/1000 [>.............................] - ETA: 38s
  96/1000 [=>............................] - ETA: 37s
 128/1000 [==>...........................] - ETA: 36s
 160/1000 [===>..........................] - ETA: 34s
 192/1000 [====>.........................] - ETA: 33s
 224/1000 [=====>........................] - ETA: 31s
 256/1000 [======>.......................] - ETA: 30s
 288/1000 [=======>......................] - ETA: 29s
 320/1000 [========>.....................] - ETA: 27s
 352/1000 [=========>....................] - ETA: 26s
 384/1000 [==========>...................] - ETA: 25s
 416/1000 [===========>..................] - ETA: 23s
 448/1000 [============>.................] - ETA: 22s
 480/1000 [=============>................] - ETA: 21s
 512/1000 [==============>...............] - ETA: 20s
 544/1000 [===============>..............] - ETA: 18s
 576/1000 [================>.............] - ETA: 17s
 608/1000 [=================>............] - ETA: 16s
 640/1000 [==================>...........] - ETA: 14s
 672/1000 [===================>..........] - ETA: 13s
 704/1000 [====================>.........] - ETA: 12s
 736/1000 [=====================>........] - ETA: 10s
 768/1000 [======================>.......] - ETA: 9s 
 800/1000 [=======================>......] - ETA: 8s
 832/1000 [=======================>......] - ETA: 6s
 864/1000 [========================>.....] - ETA: 5s
 896/1000 [=========================>....] - ETA: 4s
 928/1000 [==========================>...] - ETA: 2s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 41s 41ms/step
Test loss: 1.8051740036010742
Test accuracy: 0.504
[[ 74  21  60  30  15]
 [ 35  48  13  76  28]
 [ 39  11 116  34   0]
 [ 16   0  13  66 105]
 [  0   0   0   0 200]]
