Using TensorFlow backend.
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
cnn_aardvark_aug_concat.py:326: UserWarning: Update your `Model` call to the Keras 2 API: `Model(inputs=Tensor("in..., outputs=Tensor("de...)`
  model = Model(input=ins, output=dense2)
WARNING:tensorflow:From /n/home00/nchou/.conda/envs/envi/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-11-01 06:41:49.727201: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-11-01 06:41:49.803033: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2900000000 Hz
2019-11-01 06:41:49.803318: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x563ddbd3d7e0 executing computations on platform Host. Devices:
2019-11-01 06:41:49.803372: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Train on 1000 samples, validate on 1000 samples
Epoch 1/35

1000/1000 [==============================] - 175s 175ms/step - loss: 1.6096 - acc: 0.2250 - val_loss: 1.6021 - val_acc: 0.2410
Epoch 2/35

1000/1000 [==============================] - 170s 170ms/step - loss: 1.5964 - acc: 0.3560 - val_loss: 1.5961 - val_acc: 0.2330
Epoch 3/35

1000/1000 [==============================] - 169s 169ms/step - loss: 1.5797 - acc: 0.4130 - val_loss: 1.5893 - val_acc: 0.2100
Epoch 4/35

1000/1000 [==============================] - 170s 170ms/step - loss: 1.5605 - acc: 0.4040 - val_loss: 1.5818 - val_acc: 0.2210
Epoch 5/35

1000/1000 [==============================] - 168s 168ms/step - loss: 1.5390 - acc: 0.4150 - val_loss: 1.5735 - val_acc: 0.2970
Epoch 6/35

1000/1000 [==============================] - 171s 171ms/step - loss: 1.5152 - acc: 0.4360 - val_loss: 1.5646 - val_acc: 0.3560
Epoch 7/35

1000/1000 [==============================] - 170s 170ms/step - loss: 1.4893 - acc: 0.4610 - val_loss: 1.5556 - val_acc: 0.3550
Epoch 8/35

1000/1000 [==============================] - 168s 168ms/step - loss: 1.4615 - acc: 0.4980 - val_loss: 1.5468 - val_acc: 0.2390
Epoch 9/35

1000/1000 [==============================] - 170s 170ms/step - loss: 1.4319 - acc: 0.5240 - val_loss: 1.5386 - val_acc: 0.3450
Epoch 10/35

1000/1000 [==============================] - 174s 174ms/step - loss: 1.4010 - acc: 0.6220 - val_loss: 1.5317 - val_acc: 0.3930
Epoch 11/35

1000/1000 [==============================] - 174s 174ms/step - loss: 1.3692 - acc: 0.6350 - val_loss: 1.5266 - val_acc: 0.3980
Epoch 12/35

1000/1000 [==============================] - 174s 174ms/step - loss: 1.3366 - acc: 0.6340 - val_loss: 1.5235 - val_acc: 0.3970
Epoch 13/35

1000/1000 [==============================] - 174s 174ms/step - loss: 1.3036 - acc: 0.6450 - val_loss: 1.5228 - val_acc: 0.3920
Epoch 14/35

1000/1000 [==============================] - 174s 174ms/step - loss: 1.2704 - acc: 0.6430 - val_loss: 1.5246 - val_acc: 0.3910
Epoch 15/35

1000/1000 [==============================] - 173s 173ms/step - loss: 1.2371 - acc: 0.6390 - val_loss: 1.5289 - val_acc: 0.3880
Epoch 16/35

1000/1000 [==============================] - 171s 171ms/step - loss: 1.2037 - acc: 0.6370 - val_loss: 1.5357 - val_acc: 0.3850
Epoch 17/35

1000/1000 [==============================] - 170s 170ms/step - loss: 1.1703 - acc: 0.6150 - val_loss: 1.5451 - val_acc: 0.3780
Epoch 18/35

1000/1000 [==============================] - 169s 169ms/step - loss: 1.1370 - acc: 0.5970 - val_loss: 1.5575 - val_acc: 0.3630
Epoch 19/35

1000/1000 [==============================] - 171s 171ms/step - loss: 1.1041 - acc: 0.5990 - val_loss: 1.5715 - val_acc: 0.3690
Epoch 20/35

1000/1000 [==============================] - 170s 170ms/step - loss: 1.0711 - acc: 0.6060 - val_loss: 1.5890 - val_acc: 0.3700
Epoch 21/35

1000/1000 [==============================] - 171s 171ms/step - loss: 1.0382 - acc: 0.6160 - val_loss: 1.6051 - val_acc: 0.3760
Epoch 22/35

1000/1000 [==============================] - 169s 169ms/step - loss: 1.0058 - acc: 0.6350 - val_loss: 1.6225 - val_acc: 0.3780
Epoch 23/35

1000/1000 [==============================] - 169s 169ms/step - loss: 0.9742 - acc: 0.6390 - val_loss: 1.6389 - val_acc: 0.3820
Epoch 24/35

1000/1000 [==============================] - 167s 167ms/step - loss: 0.9434 - acc: 0.6520 - val_loss: 1.6527 - val_acc: 0.3900
Epoch 25/35

1000/1000 [==============================] - 167s 167ms/step - loss: 0.9135 - acc: 0.6640 - val_loss: 1.6674 - val_acc: 0.3940
Epoch 26/35

1000/1000 [==============================] - 167s 167ms/step - loss: 0.8845 - acc: 0.6690 - val_loss: 1.6758 - val_acc: 0.4070
Epoch 27/35

1000/1000 [==============================] - 168s 168ms/step - loss: 0.8570 - acc: 0.6760 - val_loss: 1.7036 - val_acc: 0.4000
Epoch 28/35

1000/1000 [==============================] - 167s 167ms/step - loss: 0.8336 - acc: 0.6790 - val_loss: 1.6882 - val_acc: 0.4120
Epoch 29/35

1000/1000 [==============================] - 167s 167ms/step - loss: 0.8096 - acc: 0.6980 - val_loss: 1.7007 - val_acc: 0.4170
Epoch 30/35

1000/1000 [==============================] - 167s 167ms/step - loss: 0.7813 - acc: 0.7050 - val_loss: 1.7334 - val_acc: 0.4150
Epoch 31/35

1000/1000 [==============================] - 167s 167ms/step - loss: 0.7622 - acc: 0.7090 - val_loss: 1.7212 - val_acc: 0.4330
Epoch 32/35

1000/1000 [==============================] - 169s 169ms/step - loss: 0.7359 - acc: 0.7200 - val_loss: 1.7148 - val_acc: 0.4310
Epoch 33/35

1000/1000 [==============================] - 170s 170ms/step - loss: 0.7196 - acc: 0.7220 - val_loss: 1.7340 - val_acc: 0.4460
Epoch 34/35

1000/1000 [==============================] - 169s 169ms/step - loss: 0.6950 - acc: 0.7420 - val_loss: 1.7610 - val_acc: 0.4550
Epoch 35/35

1000/1000 [==============================] - 168s 168ms/step - loss: 0.6795 - acc: 0.7530 - val_loss: 1.7473 - val_acc: 0.4540
Saved trained model at /n/holylfs03/LABS/berger_lab/nchou/saved_models/aardvark_aug11.h5 
[[6.7184935e-10 1.4604643e-21 1.6280486e-09 1.0000000e+00 1.2071898e-19]
 [9.9600665e-02 2.1313515e-02 8.6247422e-02 1.8780716e-01 6.0503125e-01]
 [1.4442120e-01 3.8201235e-02 1.2254177e-01 1.6627911e-01 5.2855664e-01]
 ...
 [5.2528162e-02 2.2254666e-02 9.8914213e-02 2.8332219e-01 5.4298073e-01]
 [6.7812309e-02 2.6237771e-02 9.3695253e-02 2.8389701e-01 5.2835768e-01]
 [5.0099625e-04 9.9857414e-01 9.2486222e-04 2.8759926e-12 3.2046262e-13]]
[3 4 4 3 3 4 1 0 1 2 4 4 4 4 4 1 3 4 4 0 0 4 3 1 2 4 4 0 3 4 4 4 4 2 3 4 4
 2 1 1 4 4 4 1 3 1 4 4 4 4 0 4 4 1 4 4 4 3 1 4 4 1 1 4 4 4 1 4 4 4 1 4 2 4
 4 0 4 3 4 4 2 1 1 4 4 1 0 3 1 4 4 3 4 1 3 0 3 3 1 4 4 4 4 2 3 4 4 3 4 1 4
 4 0 2 4 4 4 4 3 4 1 2 4 0 4 1 4 1 3 1 4 3 4 0 1 1 1 3 1 4 4 4 4 4 2 4 4 1
 1 1 4 0 4 4 3 4 4 3 0 4 4 4 2 2 4 3 1 4 4 4 4 4 1 3 4 3 4 4 0 3 1 4 1 4 4
 1 4 4 1 1 3 4 0 4 4 4 4 1 0 4 0 4 2 2 0 4 4 3 0 2 4 1 4 4 4 3 4 4 3 4 3 4
 3 4 3 0 4 3 1 0 4 4 1 4 4 4 4 4 4 1 4 4 2 1 4 0 3 4 4 1 4 1 1 4 4 0 4 1 0
 2 3 4 0 1 4 4 4 4 1 4 4 1 1 4 1 1 3 4 4 1 1 1 4 2 0 4 1 4 4 0 1 4 1 3 4 3
 3 4 2 1 3 4 4 4 1 2 3 1 1 4 4 4 0 3 4 4 3 3 4 2 2 1 3 3 3 4 2 3 1 3 4 4 4
 4 4 3 2 0 3 4 4 3 1 4 2 1 0 4 3 4 4 4 4 4 0 4 4 4 4 4 3 1 4 4 3 0 1 4 2 1
 4 3 4 4 4 4 2 4 2 1 1 3 0 1 1 3 2 1 1 0 4 3 4 1 4 3 3 0 1 1 4 4 4 4 4 4 4
 1 4 4 4 2 3 3 4 3 4 2 1 1 4 4 1 4 0 4 4 3 4 4 3 1 3 4 4 3 4 1 4 4 0 1 1 4
 0 4 4 4 4 1 4 3 4 3 3 4 4 3 4 1 4 3 0 2 3 4 4 1 4 3 1 4 4 4 4 4 0 2 0 1 4
 1 0 2 4 4 4 4 4 3 1 4 1 3 1 0 4 4 4 4 0 4 3 4 4 4 0 4 4 4 1 4 0 4 1 2 4 3
 4 4 4 1 1 1 1 4 3 1 4 4 4 4 4 4 4 4 1 1 4 4 0 3 4 4 4 1 1 0 4 0 2 4 4 3 1
 1 4 3 1 2 0 4 1 1 3 3 3 4 2 4 4 4 1 4 4 1 4 1 4 3 4 3 4 4 4 4 3 4 0 4 1 4
 4 4 4 1 4 4 4 4 2 4 4 1 3 4 3 3 3 4 4 4 0 1 4 1 4 3 4 0 4 4 1 3 4 4 4 1 1
 1 1 0 4 3 4 4 1 4 1 1 4 4 4 4 1 4 2 3 2 4 1 4 4 3 2 4 3 4 4 0 4 4 1 4 1 0
 4 3 4 0 3 4 4 4 4 2 4 4 4 3 3 2 0 4 4 1 4 4 3 4 4 2 4 4 3 1 0 3 1 4 3 4 3
 4 4 2 4 0 4 4 0 3 4 4 3 3 4 4 0 4 4 2 3 0 1 3 4 4 4 3 4 4 4 1 4 1 4 4 1 4
 1 3 4 3 4 2 4 4 1 3 4 0 4 1 2 1 1 4 1 0 1 4 4 3 4 1 4 1 4 3 4 3 4 1 4 3 3
 0 1 3 4 3 3 1 4 4 1 4 1 3 1 0 0 0 3 3 2 4 4 0 3 1 3 0 3 1 4 1 4 1 4 3 3 3
 3 4 2 3 1 1 4 1 3 4 4 4 3 0 4 4 1 4 4 4 4 4 2 0 4 2 4 4 4 4 1 4 3 4 4 3 0
 0 4 4 3 4 4 0 4 3 4 4 0 1 4 1 1 4 1 4 3 3 0 4 4 1 0 4 4 1 1 3 1 3 1 3 3 4
 3 1 4 1 3 4 2 3 1 4 3 4 4 4 3 4 4 4 4 1 4 4 2 1 0 4 1 0 4 1 2 4 3 2 1 0 3
 2 1 4 2 4 0 4 3 4 4 3 1 1 2 1 4 4 0 1 4 1 4 1 4 4 4 1 0 0 4 1 4 4 4 4 4 4
 3 1 4 1 4 3 1 4 4 4 1 1 4 4 4 4 4 0 3 4 4 1 4 3 4 4 4 0 3 4 4 3 4 4 0 4 4
 1]

  32/1000 [..............................] - ETA: 36s
  64/1000 [>.............................] - ETA: 35s
  96/1000 [=>............................] - ETA: 34s
 128/1000 [==>...........................] - ETA: 33s
 160/1000 [===>..........................] - ETA: 31s
 192/1000 [====>.........................] - ETA: 30s
 224/1000 [=====>........................] - ETA: 29s
 256/1000 [======>.......................] - ETA: 28s
 288/1000 [=======>......................] - ETA: 27s
 320/1000 [========>.....................] - ETA: 25s
 352/1000 [=========>....................] - ETA: 24s
 384/1000 [==========>...................] - ETA: 23s
 416/1000 [===========>..................] - ETA: 22s
 448/1000 [============>.................] - ETA: 20s
 480/1000 [=============>................] - ETA: 19s
 512/1000 [==============>...............] - ETA: 18s
 544/1000 [===============>..............] - ETA: 17s
 576/1000 [================>.............] - ETA: 16s
 608/1000 [=================>............] - ETA: 14s
 640/1000 [==================>...........] - ETA: 13s
 672/1000 [===================>..........] - ETA: 12s
 704/1000 [====================>.........] - ETA: 11s
 736/1000 [=====================>........] - ETA: 10s
 768/1000 [======================>.......] - ETA: 8s 
 800/1000 [=======================>......] - ETA: 7s
 832/1000 [=======================>......] - ETA: 6s
 864/1000 [========================>.....] - ETA: 5s
 896/1000 [=========================>....] - ETA: 3s
 928/1000 [==========================>...] - ETA: 2s
 960/1000 [===========================>..] - ETA: 1s
 992/1000 [============================>.] - ETA: 0s
1000/1000 [==============================] - 38s 38ms/step
Test loss: 2.1074320602416994
Test accuracy: 0.4
[[ 58  47  23  46  26]
 [  7  54   6   0 133]
 [ 20  97  26  57   0]
 [  4   0   5  62 129]
 [  0   0   0   0 200]]
